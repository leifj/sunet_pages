<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" data-mc-search-type="Stem" data-mc-help-system-file-name="index.xml" data-mc-path-to-help-system="../../../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-medium="non-print" data-mc-toc-path="Product Overview|Security Features">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>About MofN</title>
        <link href="../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../Resources/TableStyles/Page.css" rel="stylesheet" />
        <link href="../../Resources/TableStyles/Breadcrumbs.css" rel="stylesheet" />
        <link href="../../Resources/Stylesheets/Gemalto_Template_Enterprise.css" rel="stylesheet" />
        <script src="../../../Resources/Scripts/custom.modernizr.js">
        </script>
        <script src="../../../Resources/Scripts/jquery.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.config.js">
        </script>
        <script src="../../../Resources/Scripts/foundation.min.js">
        </script>
        <script src="../../../Resources/Scripts/plugins.min.js">
        </script>
        <script src="../../../Resources/Scripts/MadCapAll.js">
        </script>
    </head>
    <body>
        <table style="width: 100%;border-spacing: 0px 0px;mc-table-style: url('../../Resources/TableStyles/Breadcrumbs.css');border-left-style: none;border-left-width: 1px;border-left-color: #000000;border-right-style: none;border-right-width: 1px;border-right-color: #000000;border-top-style: none;border-top-width: 0px;border-top-color: #000000;border-bottom-style: solid;border-bottom-width: 2px;border-bottom-color: #e6e6e6;" class="TableStyle-Breadcrumbs" cellspacing="0">
            <col style="width: 41px;" class="TableStyle-Breadcrumbs-Column-Column1" />
            <col class="TableStyle-Breadcrumbs-Column-Column1" />
            <tbody>
                <tr class="TableStyle-Breadcrumbs-Body-Body1">
                    <th class="TableStyle-Breadcrumbs-BodyB-Column1-Body1">
                        <p class="home" style="font-weight: normal;"><a href="../../Home_sa.htm">Home</a> &gt;
                        </p>
                    </th>
                    <th class="TableStyle-Breadcrumbs-BodyA-Column1-Body1">
                        <div class="MCBreadcrumbsBox_0"><span class="MCBreadcrumbsPrefix"> </span><span class="MCBreadcrumbsSelf">Product Overview</span><span class="MCBreadcrumbsDivider"> &gt; </span><a class="MCBreadcrumbsLink" href="security_features.htm">Security Features</a><span class="MCBreadcrumbsDivider"> &gt; </span><span class="MCBreadcrumbs">About M of N</span>
                        </div>
                    </th>
                </tr>
            </tbody>
        </table>
        <h2><a name="kanchor8"></a>About MofN</h2>
        <p><a name="kanchor9"></a><a name="kanchor10"></a>The MofN feature provides a means by which organizations employing 
 cryptographic modules for sensitive operations can enforce multi-person 
 control over access to the cryptographic module, or selected aspects of it. &#160;The 
 feature is available in all SafeNet HSMs configured to use SafeNet PED, the PIN Entry Device (PED), and associated PED Keys for authentication. </p>
        <p><a name="kanchor11"></a><a name="kanchor12"></a>MofN involves a splitting of an authentication secret into multiple parts or splits. The shared secret is distributed 
 (or “split”) among several PED Keys (“split-knowledge access control”). Every type of PED-administered HSM authentication secret can be split when it is created: </p>
        <p class="ul1" data-mc-autonum="&lt;b&gt;•&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>•</b></span></span>blue SO PED Key,  </p>
        <p class="ul1" data-mc-autonum="&lt;b&gt;•&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>•</b></span></span>red Cloning Domain PED Key, </p>
        <p class="ul1" data-mc-autonum="&lt;b&gt;•&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>•</b></span></span>blue Partition SO PED Key,</p>
        <p class="ul1" data-mc-autonum="&lt;b&gt;•&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>•</b></span></span> black Crypto Officer PED Key, </p>
        <p class="ul1" data-mc-autonum="&lt;b&gt;•&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>•</b></span></span>gray Crypto User PED&#160;Key, </p>
        <p class="ul1" data-mc-autonum="&lt;b&gt;•&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>•</b></span></span>orange Remote PED Vector Key, </p>
        <p class="ul1" data-mc-autonum="&lt;b&gt;•&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>•</b></span></span>purple Secure Recover Key, </p>
        <p class="ul1" data-mc-autonum="&lt;b&gt;•&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>•</b></span></span>white Audit PED Key.</p>
        <h3>How MofN works &#160;</h3>
        <p>For a non-PED-authenticated (that is, for Password authenticated) HSM, you could simulate a weak form of MofN by giving two persons (or more) each a portion of the text string to authenticate to a role or a function on the HSM. Then you would need a third person to oversee each authentication to ensure that the holders of the partial password strings entered them in the correct order and did not view each other's portions. </p>
        <p>For PED-authenticated HSMs, real MofN is a much more robust, self-enforcing feature.</p>
        <p>Without MofN, you can initialize an HSM such that you must produce 
 just a single blue HSM Admin/SO PED Key in order to login and perform HSM management 
 functions, and you must produce a single black Crypto Officer PED Key 
 in order to activate a Partition to receive Client connections and allow 
 Client applications to perform operations within the Partition, and similarly for any of the other roles and authentication secrets listed above. And that 
 can be the extent of your security and oversight. If that is sufficient, 
 you can stop reading this topic.</p>
        <p>With MofN, the authentication secret contained on one blue SO PED Key or one black Crypto Officer PED Key (or red Domain key or gray Crypto User key or orange Remote PED key or purple Secure Recovery key or white Auditor key) is still necessary, but is no longer sufficient for authentication. 
 Access now requires additional authentication by an overseer, or several 
 overseers or cooperating co-key-holders. That additional oversight constitutes "M" holders of separate portions of the role secret, which is now the MofN "split knowledge 
 shared secret". What that means is that the SO secret, or partition Crypto Officer secret, or cloning Domain (as well as the Remote PED secret and the Secure Recovery secret and the Audit secret and the Crypto User secret, if used) can be 
 split into portions (over several  PED Keys of the current color, rather than just one), and a defined number of those portions must be brought 
 together in order to re-create the complete secret. One person, with one PED Key can no longer authenticate for an HSM role or function that has MofN set.</p>
        <p>At initialization time, 
 or role creation time, you are referred to the PED, where you get to specify into how many splits or shares each authentication secret is 
 divided - this is quantity N (which can be any number from 1 to 16). You 
 also specify how many of those splits or shares must be joined together by SafeNet PED 
 in order to re-create the secret - this is the quantity M. M can be less 
 than or equal to N. Specify those quantities by providing the "Nvalue" and the "Mvalue" when prompted by SafeNet PED. &#160;Those values become associated with the secret, and required, for the life of that secret - until you cause a new secret to be created. That might occur when changing or resetting a "password" (PED Key secret) for a role, or when generating a new Remote PED Vector, or generating a new Secure Recovery Vector. It could also occur if you factory reset, then re-initialized the HSM, but only if you chose not to reuse existing PED keysets (see "Reuse" below). &#160;</p>
        <h4>Creating an Authentication Secret Without MofN vs With MofN &#160;&#160;</h4>
        <p>
            <img src="../../Resources/Images/ped_mofn_groups/mofn_blue_3-of-4_create.png" style="width: 463px;height: 200px;" /> &#160;&#160;&#160;&#160;<img src="../../Resources/Images/ped_hw/lunaped-upright_angled.jpg" />&#160;&#160;&#160;</p>
        <p>In the above illustration, the right-hand side depicts the SO secret (could be HSM Admin/SO, or could be application partition SO in a per-partition SO context) split among four blue PED Keys. This is not four copies of a secret - this is four different pieces, or splits, of a single secret. As indicated, the Mvalue, the quantity of those splits that will be needed in any future authentication, could be set to any value between 1 and Nvalue (in this case 4). </p>
        <p class="ul1" data-mc-autonum="&lt;b&gt;•&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>•</b></span></span>Setting M to 1 would be pointless. You might as well have set Nvalue to 1, also, and just made identical copies of that single complete-secret key for your spares. </p>
        <p class="ul1" data-mc-autonum="&lt;b&gt;•&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>•</b></span></span>Setting Mvalue to 4 is valid, but requires that <b>all</b> holders of blue-key splits must be present whenever authentication is prompted - no blue-key holder can take vacation or sick-leave, or travel for business, without handing control of her/his split to an alternate responsible person, not one of the existing split-holders. </p>
        <p class="ul1" data-mc-autonum="&lt;b&gt;•&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>•</b></span></span>Suitable Mvalue settings, when Nvalue is 4, would be either M=3 or M=2.</p>
        <p>N=4 is just a handy example size. We could have used any nValue up to 16, but larger numbers would make for a more cumbersome example to explain the concept.</p>
        <h4>Authenticating  &#160;&#160;</h4>
        <p>To log in or authenticate with MofN in force, you are first prompted to supply, for example, a blue PED 
 Key (or a black PED Key, or whichever of the colors is appropriate to the task), then you are prompted 
 to supply an additional (different) key of that color, from that set, and to repeat until M splits have been presented - those can be any M of those 
 keys, in any order, as long as all are different. That is, the secret is spread over 
 N keys, but you need only M of them to recreate the complete secret when required (where M is usually less than N). </p>
        <p>As illustrated below, if you set MofN to N=4 and M=3, then any three of the set can be presented, when SafeNet PED prompts for SO login. </p>
        <p>
            <img src="../../Resources/Images/ped_mofn_groups/mofn_blue_3-of-4_1.png" style="width: 347px;height: 245px;" /> &#160;&#160;&#160;<img src="../../Resources/Images/ped_hw/lunaped-upright_angled.jpg" />&#160;&#160;&#160;</p>
        <p>Secret splits 2, 3, and 4 (above) combine to reproduce the complete SO authentication secret. &#160;<br />Secret split 1 is grayed out, to indicate that you do not need it when authenticating, if you present 2, 3, and 4 when prompted by the PED. </p>
        <p>&#160;</p>
        <p>
            <img src="../../Resources/Images/ped_mofn_groups/mofn_blue_3-of-4_2.png" style="width: 346px;height: 244px;" />
        </p>
        <p>Or, secret splits 1, 3, and 4 combine to reproduce the complete SO authentication secret, with 2 not needed.</p>
        <p>&#160;</p>
        <p>
            <img src="../../Resources/Images/ped_mofn_groups/mofn_blue_3-of-4_3.png" style="width: 344px;height: 243px;" />
        </p>
        <p>Or, secret splits 1, 2, and 4 combine to reproduce the complete SO authentication secret, with 3 not needed.</p>
        <p>&#160;</p>
        <p>
            <img src="../../Resources/Images/ped_mofn_groups/mofn_blue_3-of-4_4.png" style="width: 342px;height: 241px;" />
        </p>
        <p>Or, secret splits 1, 2, and 3 combine to reproduce the complete SO authentication secret, with 4 not needed.</p>
        <p>From an MofN = 3of4 set, any of the above 3-PED-Key combinations will get you into that HSM or partition.</p>
        <p>When seeking an MofN divided secret, SafeNet PED does not ask for a specific split. All it wants is a split that is a portion of the requested secret, but different from any previous splits you have offered, during this authentication attempt. When it successfully receives the number of different splits that are indicated in the PED Key header, the authentication attempt is made at the HSM.</p>
        <h3>Where and When to Use MofN</h3>
        <p>Use MofN when you want a selected type of HSM access to require the presence of 
 more than one person. MofN is invoked per authentication secret. That is, it applies 
 to only those secrets where you deliberately choose to invoke MofN as the secret is being created/imprinted. Thus you could have MofN multi-person control imposed for HSM SO and for Cloning Domain, but not for Partition Crypto Officer, nor SRK, nor RPV... or any other combination that made sense in your environment. Please review <a href="../../administration/ped_keys/how_many_ped-keys_do_i_need.htm" class="MCXref xref">How Many PED Keys Do I Need?</a> before you make any decisions about invoking MofN for one-or-more authentication secrets for an HSM.</p>
        <p>During initialization and administration of the HSM, the HSM Administrator or Security Officer [SO] invokes MofN if desired as the procedure reaches the point of creating/imprinting each authentication secret. The HSM SO supervises the imprinting of a blue PED Key or a set of N blue keys. The SO 
 specifies how many shares (also sometimes called “splits”) will make 
 up the shared secret. This total number is N and may be any number up 
 to 16. The SO then specifies how many of that total number of (current color)
 PED Keys are to be required at each login/authentication of the role or secret. This second number, M, can 
 be any number up to N. During initialization, the SO would also be presented with the same choices for the HSM administrative partition's cloning domain. </p>
        <p>From that point on, any future login or invocation of that particular authentication (blue key, or red key)  to the HSM 
 requires that quantity M of that-color share keys be provided. The result is 
 that no single person can operate that aspect of the HSM. 
 </p>
        <p>The same choices then occur as an application partition is created and has roles and secrets created for it. One holder of the Crypto Officer key or the HSM Admin/SO key (for example) must bring together M 
 different share-holders (including himself/herself), each with one of the black or blue keys, as appropriate, before the HSM 
 or partition can be unlocked. </p>
        <p>Again, the same applies to any of the other colors (roles/secrets), RPK, SRK, Auditor,for which MofN was invoked. <br /><br /></p>
        <table style="width: 100%;mc-table-style: url('../../Resources/TableStyles/Page.css');" class="TableStyle-Page" cellspacing="0">
            <col class="TableStyle-Page-Column-Column1" />
            <col class="TableStyle-Page-Column-Column1" style="width: 250px;" />
            <col class="TableStyle-Page-Column-Column1" />
            <thead>
                <tr class="TableStyle-Page-Head-Header1">
                    <th class="TableStyle-Page-HeadE-Column1-Header1" rowspan="2">
                        <p rowspan="2">&#160; </p>
                        <p rowspan="2">HSM Role or Secret &#160;</p>
                    </th>
                    <th class="TableStyle-Page-HeadD-Column1-Header1" colspan="2">Number of splits required per role/secret if one role/secret has MofN invoked</th>
                </tr>
                <tr class="TableStyle-Page-Head-Header1">
                    <th class="TableStyle-Page-HeadE-Column1-Header1">Number of Splits created <br />(N) <br /><span style="font-weight: normal;">[Note&#160;1]</span> &#160;</th>
                    <th class="TableStyle-Page-HeadD-Column1-Header1">Number of splits needed to authenticate (M) <br /><span style="font-weight: normal;">[Note&#160;2]</span> &#160;&#160;</th>
                </tr>
            </thead>
            <tbody>
                <tr class="TableStyle-Page-Body-Body1">
                    <td class="TableStyle-Page-BodyE-Column1-Body1">Blue - HSM Administrator or Security Officer (SO) &#160;</td>
                    <td class="TableStyle-Page-BodyE-Column1-Body1">Any value from 1 to 16</td>
                    <td class="TableStyle-Page-BodyD-Column1-Body1">Any value from 1 to N</td>
                </tr>
                <tr class="TableStyle-Page-Body-Body1">
                    <td class="TableStyle-Page-BodyE-Column1-Body1">Blue - Application Partition Security Officer (SO) </td>
                    <td class="TableStyle-Page-BodyE-Column1-Body1">Any value from 1 to 16</td>
                    <td class="TableStyle-Page-BodyD-Column1-Body1">Any value from 1 to N</td>
                </tr>
                <tr class="TableStyle-Page-Body-Body1">
                    <td class="TableStyle-Page-BodyE-Column1-Body1">Red - Cloning Domain</td>
                    <td class="TableStyle-Page-BodyE-Column1-Body1">Any value from 1 to 16</td>
                    <td class="TableStyle-Page-BodyD-Column1-Body1">Any value from 1 to N</td>
                </tr>
                <tr class="TableStyle-Page-Body-Body1">
                    <td class="TableStyle-Page-BodyE-Column1-Body1">Black - Crypto Officer (sometimes called <br />application partition Owner for "legacy" partitions <br />without Partition SO) &#160;</td>
                    <td class="TableStyle-Page-BodyE-Column1-Body1">Any value from 1 to 16</td>
                    <td class="TableStyle-Page-BodyD-Column1-Body1">Any value from 1 to N</td>
                </tr>
                <tr class="TableStyle-Page-Body-Body1">
                    <td class="TableStyle-Page-BodyE-Column1-Body1">Gray - Crypto User &#160;</td>
                    <td class="TableStyle-Page-BodyE-Column1-Body1">Any value from 1 to 16</td>
                    <td class="TableStyle-Page-BodyD-Column1-Body1">Any value from 1 to N</td>
                </tr>
                <tr class="TableStyle-Page-Body-Body1">
                    <td class="TableStyle-Page-BodyE-Column1-Body1">Orange - Remote PED Vector &#160;</td>
                    <td class="TableStyle-Page-BodyE-Column1-Body1">Any value from 1 to 16</td>
                    <td class="TableStyle-Page-BodyD-Column1-Body1">Any value from 1 to N</td>
                </tr>
                <tr class="TableStyle-Page-Body-Body1">
                    <td class="TableStyle-Page-BodyE-Column1-Body1">White - Auditor &#160;</td>
                    <td class="TableStyle-Page-BodyE-Column1-Body1">Any value from 1 to 16</td>
                    <td class="TableStyle-Page-BodyD-Column1-Body1">Any value from 1 to N</td>
                </tr>
                <tr class="TableStyle-Page-Body-Body1">
                    <td class="TableStyle-Page-BodyE-Column1-Body1">Purple - Secure Recovery Vector &#160;</td>
                    <td class="TableStyle-Page-BodyE-Column1-Body1">Any value from 1 to 16</td>
                    <td class="TableStyle-Page-BodyD-Column1-Body1">Any value from 1 to N</td>
                </tr>
                <tr class="TableStyle-Page-Body-Body1">
                    <td class="TableStyle-Page-BodyD-Column1-Body1" colspan="3">[Note 1 - Selecting an Nvalue of 1, when imprinting a role or secret, means no MofN splitting for that role/secret; a single PED Key unlocks that role or function. <br />Selecting an Nvalue greater than 1, when imprinting a role or secret, means that secret is split across quantity N of that-color PED Keys.] &#160;</td>
                </tr>
                <tr class="TableStyle-Page-Body-Body1">
                    <td class="TableStyle-Page-BodyA-Column1-Body1" colspan="3">[Note 2 - Mvalue is usually not selected as 1 (when N &gt; 1), since that would mostly defeat the purpose of setting MofN. <br />Mvalue is usually not selected as N, since that leaves no scope to authenticate while one or more holders of secret-split PED Key is unavailable due to illness, vacation, business travel, or other reasons. Therefore, 1 &lt; M &lt; N is usually the case.] </td>
                </tr>
            </tbody>
        </table>
        <p>The purpose of the above table is to emphasize explicitly that MofN settings are completely independent, per role or secret, on an HSM. </p>
        <p class="ul1" data-mc-autonum="&lt;b&gt;•&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>•</b></span></span>Setting MofN, or not, for one role or function secret, has no influence on whether or not MofN can be set for any other role or secret. </p>
        <p class="ul1" data-mc-autonum="&lt;b&gt;•&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>•</b></span></span>Setting Mvalue and Nvalue for one role or function secret has no influence on the values you might set for another. &#160;</p>
        <h4>What MofN is not &#160;</h4>
        <p>MofN is not 
 a splitting of the private signing key; it is splitting of the SafeNet HSM's individual authentication/access secrets. That is, MofN is a splitting of the secret that lets you unlock a function of the HSM, but <b>not</b> a split of the working (encrypting, decrypting, signing, verifying) secrets - your keys and certificates - contained inside the HSM.</p>
        <p class="note" data-mc-autonum="&lt;b&gt;Note:&lt;/b&gt; &#160;"><span class="autonumber"><span><b>Note:</b> &#160;</span></span>&#160;In general,  use MofN if you will be giving each split-containing PED Key to a different person. We recommend that you  use MofN only if you have established a definite need for it. The additional security of split-knowledge, shared-secret, multi-person access control imposes additional administrative overhead, and increased possibility of making an administrative or handling error that could leave you unable to access your keys and certificates.</p>
        <h4>Reuse</h4>
        <p>When a PED Key contains an authentication secret from an HSM or partition, and you are imprinting a secret for a new HSM or partition, you are prompted to "Reuse an existing keyset?", or to overwrite any content of the PED&#160;Key (explained in detail at <a href="../../administration/ped_keys/what_is_a_shared_or_group_ped_key.htm" class="MCXref xref">Shared or Group PED Keys</a>). </p>
        <p>If you present a PED Key containing a single split from an MofN set, the PED detects that it is viewing a partial secret, and prompts you for additional splits of that secret, in order to reproduce it and impose the reconstructed secret onto the current HSM (for that role). That is, you cannot use a single split from an MofN group as a complete secret on another HSM or partition. If the other HSM had MofN for that secret or role, and you choose to reuse, you must reuse all of it, and therefore you are choosing MofN for that role on the new HSM, just as it was on the original HSM.</p>
        <h3>Historical Note </h3>
        <p>In previous versions of SafeNet HSM, MofN was a selection made at the command-line (either lunash:&gt; or lunacm:&gt;) via the <span class="code">hsm init</span> command. You could elect to use MofN or not, by means of options to the <span class="code">hsm init</span> command. MofN, was a separate secret, spread across N green keys. If you invoked 
 MofN, then it was always in force for that HSM (until the HSM was re-initialized). If you invoked MofN, it was in force HSM-wide. As explained above, modern MofN behaves very differently, and we recommend taking time to understand the differences and implications if you are migrating from older SafeNet HSMs. </p>
        <p><![CDATA[
 ]]></p>
        <p class="footer"><span class="DefaultProduct">SafeNet Network HSM</span> <span class="DefaultRelease">6.2.2</span> <span class="DefaultProjectTitle">Product Documentation</span> <br /><span class="DefaultPartNumber">007-011136-012</span> <span class="DefaultRevision">Rev. A</span> <span style="color: #5e5e5c;"><![CDATA[  ]]></span> <span class="DefaultDateLong">01 December 2016</span> <span style="color: #5e5e5c;"><![CDATA[  ]]></span> <span class="DefaultCopyright">Copyright 2001-2016</span>&#160;<span class="DefaultCompanyNameLong">Gemalto</span> <span style="color: #5e5e5c;"><![CDATA[  ]]></span>All rights reserved. </p>
    </body>
</html>