<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" data-mc-search-type="Stem" data-mc-help-system-file-name="index.xml" data-mc-path-to-help-system="../../../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-medium="non-print" data-mc-toc-path="Appliance Administration Guide|Appliance Hardware Functions">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>System Behavior with Hardware Tamper Events</title>
        <link href="../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../Resources/TableStyles/Page.css" rel="stylesheet" />
        <link href="../../Resources/TableStyles/Breadcrumbs.css" rel="stylesheet" />
        <link href="../../Resources/Stylesheets/Gemalto_Template_Enterprise.css" rel="stylesheet" />
        <script src="../../../Resources/Scripts/custom.modernizr.js">
        </script>
        <script src="../../../Resources/Scripts/jquery.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.config.js">
        </script>
        <script src="../../../Resources/Scripts/foundation.min.js">
        </script>
        <script src="../../../Resources/Scripts/plugins.min.js">
        </script>
        <script src="../../../Resources/Scripts/MadCapAll.js">
        </script>
    </head>
    <body>
        <table style="width: 100%;border-spacing: 0px 0px;mc-table-style: url('../../Resources/TableStyles/Breadcrumbs.css');border-left-style: none;border-left-width: 1px;border-left-color: #000000;border-right-style: none;border-right-width: 1px;border-right-color: #000000;border-top-style: none;border-top-width: 0px;border-top-color: #000000;border-bottom-style: solid;border-bottom-width: 2px;border-bottom-color: #e6e6e6;" class="TableStyle-Breadcrumbs" cellspacing="0">
            <col style="width: 41px;" class="TableStyle-Breadcrumbs-Column-Column1" />
            <col class="TableStyle-Breadcrumbs-Column-Column1" />
            <tbody>
                <tr class="TableStyle-Breadcrumbs-Body-Body1">
                    <th class="TableStyle-Breadcrumbs-BodyB-Column1-Body1">
                        <p class="home" style="font-weight: normal;"><a href="../../Home_sa.htm">Home</a> &gt;
                        </p>
                    </th>
                    <th class="TableStyle-Breadcrumbs-BodyA-Column1-Body1">
                        <div class="MCBreadcrumbsBox_0"><span class="MCBreadcrumbsPrefix">  <![CDATA[ ]]></span><span class="MCBreadcrumbsSelf">Appliance Administration Guide</span><span class="MCBreadcrumbsDivider"> &gt; </span><a class="MCBreadcrumbsLink" href="appliance_hardware.htm">Appliance Hardware Functions</a><span class="MCBreadcrumbsDivider"> &gt; </span><span class="MCBreadcrumbs">System Behavior with Hardware Tamper Events</span>
                        </div>
                    </th>
                </tr>
            </tbody>
        </table>
        <h2>System Behavior with Hardware Tamper Events</h2>
        <p>The SafeNet appliance uses the Master Tamper Key (a key on the HSM that encrypts everything on the HSM) to deal with both hardware (physical) tamper events and Secure Transport Mode. </p>
        <h3>Tampering with the Appliance</h3>
        <p>Hardware tamper events are detectable events that imply intrusion into the appliance interior.</p>
        <p>One such event is removal of the lid (top cover). The lid is secured by anti-tamper screws, so any event that lifts that lid is likely to be a serious intrusion.</p>
        <p>Another event that is considered tampering is opening of the bay containing the ventilation fans. </p>
        <p>You can use the thumbscrew to access the mesh air filter in front of the fans, without disturbing the system. However, if you open the fan-retaining panel behind that, which requires a Torx #8 screwdriver, then the system registers a tamper. </p>
        <p>Therefore, cleaning of the filter is encouraged, especially if you work in a dusty environment, but fan module removal and replacement are discouraged unless you have good reason to suspect that a fan module is faulty. See <a href="fan_maintenance.htm" class="MCXref xref">Power Supply and Fan Maintenance</a> for more information.</p>
        <h3>Decommission</h3>
        <p>The red "Decommission" button recessed behind the back panel is not a tamper switch. Its purpose is different. See <a href="hsm_decommission_button.htm" class="MCXref xref">HSM Emergency Decommission Button</a> for a description.</p>
        <h3>What Happens When You Tamper - Including Opening the Fan Bay</h3>
        <p>The following sequence illustrates how a tamper event affects the HSM and your use of it. You do not need to perform all these steps. Many are included for illustrative purposes and to emphasize the state of the appliance and of the enclosed HSM at each stage.</p>
        <table class="TableStyle-Page" style="margin-left: 0;margin-right: auto;width: 624px;mc-table-style: url('../../Resources/TableStyles/Page.css');" cellspacing="0">
            <col style="width: 242px;" class="TableStyle-Page-Column-Column1" />
            <col style="width: 465px;" class="TableStyle-Page-Column-Column1" />
            <thead>
                <tr class="TableStyle-Page-Head-Header1">
                    <th class="TableStyle-Page-HeadE-Column1-Header1">Action</th>
                    <th class="TableStyle-Page-HeadD-Column1-Header1">Result/State</th>
                </tr>
            </thead>
            <tbody>
                <tr class="TableStyle-Page-Body-Body1">
                    <td class="TableStyle-Page-BodyD-Column1-Body1" colspan="2">
                        <p colspan="3">&#160;</p>
                        <p colspan="3">First, we place the HSM in its basic operational condition (we reset only to have a clean starting point for this illustration).</p>
                    </td>
                </tr>
                <tr class="TableStyle-Page-Body-Body1">
                    <td class="TableStyle-Page-BodyE-Column1-Body1">hsm factoryReset</td>
                    <td class="TableStyle-Page-BodyD-Column1-Body1">Starting point</td>
                </tr>
                <tr class="TableStyle-Page-Body-Body1">
                    <td class="TableStyle-Page-BodyE-Column1-Body1">hsm initialize</td>
                    <td class="TableStyle-Page-BodyD-Column1-Body1">Basic setup of HSM</td>
                </tr>
                <tr class="TableStyle-Page-Body-Body1">
                    <td class="TableStyle-Page-BodyD-Column1-Body1" colspan="2">
                        <p colspan="3">&#160;</p>
                        <p colspan="3">Next, we illustrate a software "tamper" (destroying the MTK by setting the HSM into Transport Mode)</p>
                    </td>
                </tr>
                <tr class="TableStyle-Page-Body-Body1">
                    <td class="TableStyle-Page-BodyE-Column1-Body1">hsm srk enable</td>
                    <td class="TableStyle-Page-BodyD-Column1-Body1">Move one split of the MTK out of the HSM, and onto a purple PED&#160;Key, so the MTK&#160;cannot be reconstituted until/unless the external split (SRK)&#160;is presented.</td>
                </tr>
                <tr class="TableStyle-Page-Body-Body1">
                    <td class="TableStyle-Page-BodyE-Column1-Body1">hsm srk transportMode enter</td>
                    <td class="TableStyle-Page-BodyD-Column1-Body1">Delete the MTK so HSM contents cannot be decoded or used.</td>
                </tr>
                <tr class="TableStyle-Page-Body-Body1">
                    <td class="TableStyle-Page-BodyE-Column1-Body1">hsm show </td>
                    <td class="TableStyle-Page-BodyD-Column1-Body1">Basic HSM info remains undisturbed. </td>
                </tr>
                <tr class="TableStyle-Page-Body-Body1">
                    <td class="TableStyle-Page-BodyE-Column1-Body1">partition list </td>
                    <td class="TableStyle-Page-BodyD-Column1-Body1">None have been created since initialization, above.</td>
                </tr>
                <tr class="TableStyle-Page-Body-Body1">
                    <td class="TableStyle-Page-BodyE-Column1-Body1">partition create</td>
                    <td class="TableStyle-Page-BodyD-Column1-Body1">Attempt to create a partition - doesn't work; must be logged in as SO.</td>
                </tr>
                <tr class="TableStyle-Page-Body-Body1">
                    <td class="TableStyle-Page-BodyE-Column1-Body1">hsm login</td>
                    <td class="TableStyle-Page-BodyD-Column1-Body1">No, can't do that either: LUNA_RET_MTK_ZEROIZED </td>
                </tr>
                <tr class="TableStyle-Page-Body-Body1">
                    <td class="TableStyle-Page-BodyE-Column1-Body1">hsm srk transportMode recover</td>
                    <td class="TableStyle-Page-BodyD-Column1-Body1">Present the correct purple PED&#160;Key when prompted by the PED; the SRV is read into the HSM, allowing the MTK to be reconstituted, and making the HSM contents available/usable once more. <br />Also, the PED presents the Transport Mode verification string.</td>
                </tr>
                <tr class="TableStyle-Page-Body-Body1">
                    <td class="TableStyle-Page-BodyE-Column1-Body1">hsm login</td>
                    <td class="TableStyle-Page-BodyD-Column1-Body1">This time, it works.</td>
                </tr>
                <tr class="TableStyle-Page-Body-Body1">
                    <td class="TableStyle-Page-BodyE-Column1-Body1">partition create</td>
                    <td class="TableStyle-Page-BodyD-Column1-Body1">
                        <p>Partition is created. </p>
                    </td>
                </tr>
                <tr class="TableStyle-Page-Body-Body1">
                    <td class="TableStyle-Page-BodyE-Column1-Body1">partition list</td>
                    <td class="TableStyle-Page-BodyD-Column1-Body1">Confirm that the created partition is there - you have confirmed that you have successfully set Secure Transport Mode, then recovered from it. The HSM is unusable while in STM, but is fully restored to its previous state when you recover from STM.</td>
                </tr>
                <tr class="TableStyle-Page-Body-Body1">
                    <td class="TableStyle-Page-BodyD-Column1-Body1" colspan="2">
                        <p colspan="3">&#160;</p>
                        <p colspan="3">Now, we illustrate a hardware tamper (by physically interfering with the appliance as an intruder might do)</p>
                    </td>
                </tr>
                <tr class="TableStyle-Page-Body-Body1">
                    <td class="TableStyle-Page-BodyE-Column1-Body1">open the fan bay (with a Torx #8 screwdriver)</td>
                    <td class="TableStyle-Page-BodyD-Column1-Body1">The HSM stops responding as the vkd (HSM&#160;driver) times out [the command-line prompt is still available until you issue a command (like hsm srk show) that attempts to access the HSM, at which point the driver goes into time-out] - the entire system stops responding for approximately ten minutes (you can wait it out, or you can reboot) - the system has detected a tamper event</td>
                </tr>
                <tr class="TableStyle-Page-Body-Body1">
                    <td class="TableStyle-Page-BodyE-Column1-Body1">
                        <p>(system resumes)</p>
                        <p>run "sysconf appliance reboot" or press the restart [Stop/Start] switch on the back panel</p>
                    </td>
                    <td class="TableStyle-Page-BodyD-Column1-Body1">(If you wait until the system becomes responsive on its own, issue "sysconf appliance reboot"; if you simply restart with the switch, that's the same thing, but faster.)</td>
                </tr>
                <tr class="TableStyle-Page-Body-Body1">
                    <td class="TableStyle-Page-BodyE-Column1-Body1">when the system is back up, run <br /><br />hsm srk show</td>
                    <td class="TableStyle-Page-BodyD-Column1-Body1">
                        <p style="font-family: monospace;">[myluna1] lunash:&gt;hsm srk show

   </p>
                        <p style="font-family: monospace;">Secure Recovery State flags:
   ================================<br />External split enabled:...yes&#160;
   <br />SRK resplit required:....       no&#160;
   <br />Hardware tampered:........yes 
   <br />Transport mode:..........             &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;no 


<br /><br />Command Result : 0 (Success)
[myluna1] lunash:&gt;</p>
                    </td>
                </tr>
                <tr class="TableStyle-Page-Body-Body1">
                    <td class="TableStyle-Page-BodyE-Column1-Body1">view the logs</td>
                    <td class="TableStyle-Page-BodyD-Column1-Body1">
                        <p>The <strong>hsm.log</strong> shows events like:</p>
                        <p><span class="code">ERR:    RTC: external tamper latched</span> <br />and <br /><span class="code">TVK was lost due to tamper</span> <br />and<br /><span class="code">RTC: tamper 2 signal</span> <br />and<br /><span class="code">ERR:    MTK: security function was zeroized for unknown reason</span> <br /><br />These are all indications from various modules that a tamper event has occurred. They are visible after the system is restarted - the tamper event itself occurs too quickly to be recorded at the time, so it is noted when the HSM goes through its start-up sequence after system reboot. </p>
                        <p>Many lines of logging occur when the HSM restarts, so it is necessary to specify more than the default 20 lines at the end of the log when you issue:</p>
                        <p><span class="code">syslog tail - logname hsm</span> <![CDATA[ ]]></p>
                        <p>Try searching the last couple of hundred entries with:</p>
                        <p><span class="code">syslog tail -logname hsm -search tamper -e 200</span> &#160;&#160;</p>
                        <p>
                            <br />The <strong>audit log</strong> shows events like:</p><pre xml:space="preserve">lunash:&gt;audit log tail -f hsm_150073_00000001.log

133098,13/01/28 14:39:37,S/N 150073 HSM with S/N 150073 logged the following internal event: LOG: resync(0x0000002e)
133099,13/01/28 14:47:15,S/N 150073 HSM with S/N 150073 logged the following internal event: TVK was corrupted.(0x00000027)
133100,13/01/28 14:47:15,S/N 150073 HSM with S/N 150073 logged the following internal event: Existing Auto-Activation data won't work(0x00000029)
133101,13/01/28 14:47:15,S/N 150073 HSM with S/N 150073 logged the following internal event: Generating new TVK...passed(0x0000002a)
133102,13/01/28 14:47:15,S/N 150073 HSM with S/N 150073 logged the following internal event: RESTART(0x0000002f)
133103,13/01/28 14:47:35,S/N 150073 HSM with S/N 150073 logged the following internal event: LOG: resync(0x0000002e)

Command Result : 0 (Success)

lunash:&gt;</pre>
                    </td>
                </tr>
                <tr class="TableStyle-Page-Body-Body1">
                    <td class="TableStyle-Page-BodyE-Column1-Body1">hsm srk show</td>
                    <td class="TableStyle-Page-BodyD-Column1-Body1">External Split Enabled ......... yes<br />SRK resplit required ..............no<br />Hardware Tampered .............yes<br />Transport Mode ....................no</td>
                </tr>
                <tr class="TableStyle-Page-Body-Body1">
                    <td class="TableStyle-Page-BodyE-Column1-Body1">hsm login</td>
                    <td class="TableStyle-Page-BodyD-Column1-Body1">not permitted: <br />LUNA_RET_MTK_ZEROIZED </td>
                </tr>
                <tr class="TableStyle-Page-Body-Body1">
                    <td class="TableStyle-Page-BodyE-Column1-Body1">hsm srk transportMode recover</td>
                    <td class="TableStyle-Page-BodyD-Column1-Body1">
                        <p>Present the correct purple PED&#160;Key when prompted by the PED. <br />The SRV is read into the HSM, allowing the MTK to be reconstituted, <br />and making the HSM contents available/usable once more. <br />Because this was a physical tamper, and not a deliberate setting of Transport Mode, <br />the PED does NOT present the Transport Mode verification string.</p>
                        <p>THIS&#160;(above) IS&#160;HOW&#160;YOU&#160;RECOVER FROM A PHYSICAL&#160;TAMPER&#160;EVENT.</p>
                    </td>
                </tr>
                <tr class="TableStyle-Page-Body-Body1">
                    <td class="TableStyle-Page-BodyE-Column1-Body1">hsm login</td>
                    <td class="TableStyle-Page-BodyD-Column1-Body1">This time, it works.</td>
                </tr>
                <tr class="TableStyle-Page-Body-Body1">
                    <td class="TableStyle-Page-BodyE-Column1-Body1">partition list</td>
                    <td class="TableStyle-Page-BodyD-Column1-Body1">Confirm that the pre-existing partition is present.</td>
                </tr>
                <tr class="TableStyle-Page-Body-Body1">
                    <td class="TableStyle-Page-BodyE-Column1-Body1">partition showContents</td>
                    <td class="TableStyle-Page-BodyD-Column1-Body1">Confirm that any pre-existing partition contents are there.</td>
                </tr>
                <tr class="TableStyle-Page-Body-Body1">
                    <td class="TableStyle-Page-BodyD-Column1-Body1" colspan="2">
                        <p colspan="3">
                            <br />Next, we illustrate what happens when a physical tamper occurs while the HSM is already in Secure Transport Mode</p>
                    </td>
                </tr>
                <tr class="TableStyle-Page-Body-Body1">
                    <td class="TableStyle-Page-BodyE-Column1-Body1">hsm srk transportMode enter</td>
                    <td class="TableStyle-Page-BodyD-Column1-Body1">Delete the MTK so HSM contents cannot be decoded or used.</td>
                </tr>
                <tr class="TableStyle-Page-Body-Body1">
                    <td class="TableStyle-Page-BodyE-Column1-Body1">hsm srk show</td>
                    <td class="TableStyle-Page-BodyD-Column1-Body1">External Split Enabled ......... Yes<br />SRK resplit required ..............No<br />Hardware Tampered .............No<br />Transport Mode ....................Yes</td>
                </tr>
                <tr class="TableStyle-Page-Body-Body1">
                    <td class="TableStyle-Page-BodyE-Column1-Body1">open the appliance lid, or open the fan bay <br />(opening the lid would damage the chassis and void your warranty, this is for example purposes only)</td>
                    <td class="TableStyle-Page-BodyD-Column1-Body1">The HSM stops responding when you enter an HSM command, <br />or it gives an error message (any of several, depending on what it was doing <br />at the time) and _then_ stops responding.</td>
                </tr>
                <tr class="TableStyle-Page-Body-Body1">
                    <td class="TableStyle-Page-BodyE-Column1-Body1">&#160;</td>
                    <td class="TableStyle-Page-BodyD-Column1-Body1">&#160;</td>
                </tr>
                <tr class="TableStyle-Page-Body-Body1">
                    <td class="TableStyle-Page-BodyD-Column1-Body1" colspan="2">
                        <p colspan="3">
                            <br />What if you have disabled external storage of one of the MTK splits (the SRK), and a tamper occurs?</p>
                    </td>
                </tr>
                <tr class="TableStyle-Page-Body-Body1">
                    <td class="TableStyle-Page-BodyE-Column1-Body1">hsm srk disable</td>
                    <td class="TableStyle-Page-BodyD-Column1-Body1">If you already had the SRK split out to a purple PED&#160;Key, <br />this command brings it back in, so that both splits of the MTK reside inside the HSM.</td>
                </tr>
                <tr class="TableStyle-Page-Body-Body1">
                    <td class="TableStyle-Page-BodyE-Column1-Body1">hsm srk show</td>
                    <td class="TableStyle-Page-BodyD-Column1-Body1">
                        <p>Confirm that SRK is no longer in use.</p>
                        <p>hsm srk show

   <br />Secure Recovery State flags:
   ===============================<br />External split enabled:      .......no
   <br />SRK resplit required:        .........no
   <br />Hardware tampered:           ..........no
   <br />Transport mode: ...............             no
</p>
                        <p>Command Result : 0 (Success)
</p>
                    </td>
                </tr>
                <tr class="TableStyle-Page-Body-Body1">
                    <td class="TableStyle-Page-BodyE-Column1-Body1">open the fan bay to induce a tamper event</td>
                    <td class="TableStyle-Page-BodyD-Column1-Body1">Nothing obvious happens, until the front-panel LCD text gets to <br />the part of the sequence where it can display "HSM&#160;Error".</td>
                </tr>
                <tr class="TableStyle-Page-Body-Body1">
                    <td class="TableStyle-Page-BodyE-Column1-Body1">run an HSM command</td>
                    <td class="TableStyle-Page-BodyD-Column1-Body1">
                        <p><span class="code">[myluna1] lunash:&gt;hsm show</span> <![CDATA[ ]]></p>
                        <p>&#160;<span class="code">&#160;Appliance Details:</span><br style="mc-tag-and-class: ;" /><span class="code"> &#160;==================
   </span><br style="mc-tag-and-class: ;" /><span class="code"> &#160;Software Version:                5.1.0-25   
</span><br style="mc-tag-and-class: ;" /><span class="code">Error:    Unable to communicate with HSM.
          </span><br style="mc-tag-and-class: ;" /><span class="code">Please run 'hsm supportInfo' and contact customer support.


</span><br style="mc-tag-and-class: ;" /><br style="mc-tag-and-class: ;" /><span class="code">Command Result : 65535 (Luna Shell execution)
</span><br style="mc-tag-and-class: ;" /><span class="code">[myluna1] lunash:&gt;</span> <![CDATA[ ]]></p>
                        <p>The HSM is no longer responsive.</p>
                    </td>
                </tr>
                <tr class="TableStyle-Page-Body-Body1">
                    <td class="TableStyle-Page-BodyE-Column1-Body1">reboot by pressing the Stop/Start switch or by "sysconf appliance reboot"</td>
                    <td class="TableStyle-Page-BodyD-Column1-Body1">
                        <p>Appliance stops.</p>
                        <p>Appliance starts.</p>
                    </td>
                </tr>
                <tr class="TableStyle-Page-Body-Body1">
                    <td class="TableStyle-Page-BodyE-Column1-Body1">when appliance is back in operation, look at the hsm.log</td>
                    <td class="TableStyle-Page-BodyD-Column1-Body1">
                        <p style="font-family: monospace;">[myluna1] lunash:&gt;syslog tail -logname hsm -search tamper -e 200

</p>
                        <p style="font-family: monospace;">2010 Nov  9 14:50:34 myluna1  local6 err  oamp[2239]: <br />&#160;&#160;ERR:    RTC: external tamper latched
<br />2010 Nov  9 14:50:34 myluna1  local6 info  oamp[2239]: <br />&#160;&#160;INFO:     RTC: tamper timestamp = 230143 min <br />&#160;&#160;(YYYY:MM:DD:hh:mm:ss = 0000:06:08:19:43:28.00)
<br />2012 Nov  9 14:50:34 myluna1  local6 info  oamp[2239]: <br />&#160;&#160;INFO:     RTC: tamper circuits re-armed
2012 Nov  9 14:50:34 <br />&#160;&#160;myluna1  local6 err  oamp[2239]: ERR:    TVK was lost due to tamper

</p>
                        <p style="font-family: monospace;">Command Result : 0 (Success)<br />[myluna1] lunash:&gt;hsm srk show

   <br />Secure Recovery State flags:
   <br />=================================
<br />  External split enabled: ..     no
   <br />&#160;SRK resplit required: ....       no
   <br />&#160;Hardware tampered:           ........no
   <br />&#160;Transport mode: ..........             no


</p>
                        <p style="font-family: monospace;">Command Result : 0 (Success)
<br />[myluna1] lunash:&gt;
</p>
                        <p style="font-family: monospace;"><span style="font-family: Arial;">The tamper event appears in the log, after the system reboots.</span>
                        </p>
                    </td>
                </tr>
                <tr class="TableStyle-Page-Body-Body1">
                    <td class="TableStyle-Page-BodyE-Column1-Body1">
                        <p>run "hsm show"</p>
                        <p>and </p>
                        <p>"syslog tail " to search the hsm log for recent tamper events</p>
                    </td>
                    <td class="TableStyle-Page-BodyD-Column1-Body1">
                        <p style="font-family: monospace;">lunash:&gt;hsm show


   </p>
                        <p style="font-family: monospace;">Appliance Details:
   <br />==================
   <br />Software Version:                5.1.0-25   
</p>
                        <p style="font-family: monospace;">HSM Details:
   <br />============
   <br />HSM Label:                          myhsm
   <br />Serial #:                           700027
   <br />Firmware:                           6.2.1   
   <br />Hardware Model:                     Luna K6
   <br />Authentication Method:              PED keys
   <br />HSM Admin login status:             Not Logged In
<br />   HSM Admin login attempts left:      3 before HSM zeroization!
<br />   RPV Initialized:                    No
   <br />Manually Zeroized:                  No
</p>
                        <p style="font-family: monospace;">Partitions created on HSM:
   <br />==========================
   <br />Partition: 700027008,     Name: mypar1
</p>
                        <p style="font-family: monospace;">FIPS 140-2 Operation:
<br />   =====================
<br />   The HSM is NOT in FIPS 140-2 approved operation mode.

   </p>
                        <p style="font-family: monospace;">HSM Storage Information:
<br />   ========================
   <br />Maximum HSM Storage Space (Bytes):   2097152
   <br />Space In Use (Bytes):                104857
   <br />Free Space Left (Bytes):             1992295


</p>
                        <p style="font-family: monospace;">Command Result : 0 (Success)
<br />[myluna1] lunash:&gt;       </p>
                        <p>The HSM is back in operation, as it was before the tamper event.</p>
                        <p>Both splits of the MTK were present on the HSM, so recombining them <br />to reconstitute the MTK was automatic when the HSM&#160;was reset.<br /> <b>No action</b> is required to re-instate the HSM from the tamper.</p>
                        <p>You are alerted that an event has happened by the HSM becoming <br />unresponsive, forcing you to restart. </p>
                        <p>You can confirm that the reason for the HSM problem was, in fact, <br />a tamper event, by looking at the log.</p>
                        <p style="font-family: monospace;">[myluna1] lunash:&gt;syslog tail -logname hsm -search tamper -e 200

</p>
                        <p style="font-family: monospace;">2012 Nov  9 14:50:34 myluna1  local6 err  oamp[2239]: ERR:    RTC: external tamper latched
<br />2010 Nov  9 14:50:34 myluna1  local6 info  oamp[2239]: INFO:     RTC: tamper timestamp = 230143 min (YYYY:MM:DD:hh:mm:ss = 0000:06:08:19:43:28.00)
<br />2012 Nov  9 14:50:34 myluna1  local6 info  oamp[2239]: INFO:     RTC: tamper circuits re-armed
2012 Nov  9 14:50:34 myluna1  local6 err  oamp[2239]: ERR:    TVK was lost due to tamper

</p>
                        <p style="font-family: monospace;">Command Result : 0 (Success)<br />[myluna1] lunash:&gt;hsm srk show

   <br />Secure Recovery State flags:
   <br />=================================
<br />  External split enabled: ..     no
   <br />SRK resplit required: ....       no
   <br />Hardware tampered:           ........no
   <br />Transport mode: ..........             no


</p>
                        <p style="font-family: monospace;">Command Result : 0 (Success)
<br />[myluna1] lunash:&gt;
</p>
                        <p style="font-family: monospace;"><span style="font-family: Arial;">The tamper event appears in the log after the system reboots.</span>
                        </p>
                        <p>&#160;</p>
                    </td>
                </tr>
                <tr class="TableStyle-Page-Body-Body1">
                    <td class="TableStyle-Page-BodyB-Column1-Body1">Carry on using the HSM and its partitions.</td>
                    <td class="TableStyle-Page-BodyA-Column1-Body1">&#160;</td>
                </tr>
            </tbody>
        </table>
        <p>&#160;</p>
        <p>Here is an example of hsm.log file entries following a tamper event. We performed several tampers over the space of a few minutes.</p><pre>[myluna1] lunash:&gt;syslog tail -logname hsm -search tamper -e 200</pre><pre>2012 Nov  4 14:21:18 GA1  local6 err  oamp[2240]: ERR:    RTC: external tamper latched</pre><pre>2012 Nov  4 14:21:18 GA1  local6 info  oamp[2240]: INFO:     RTC: tamper timestamp = 222861 min (YYYY:MM:DD:hh:mm:ss = 0000:06:03:18:21:18.00)</pre><pre>2012 Nov  4 14:21:18 GA1  local6 info  oamp[2240]: INFO:     RTC: tamper circuits re-armed</pre><pre>2012 Nov  4 14:21:18 GA1  local6 err  oamp[2240]: ERR:    TVK was lost due to tamper</pre><pre>2012 Nov  4 14:21:18 GA1  local6 err  oamp[2240]: ERR:    MTK: security function was zeroized on previous tamper event and has not been restored yet</pre><pre>2012 Nov  4 14:36:28 GA1  local6 err  oamp[2239]: ERR:    RTC: tamper 2 signal</pre><pre>2012 Nov  4 14:36:28 GA1  local6 info  oamp[2239]: INFO:     RTC: tamper timestamp = 222881 min (YYYY:MM:DD:hh:mm:ss = 0000:06:03:18:41:00.00)</pre><pre>2012 Nov  4 14:36:28 GA1  local6 info  oamp[2239]: INFO:     RTC: tamper circuits re-armed</pre><pre>2012 Nov  4 14:36:28 GA1  local6 err  oamp[2239]: ERR:    TVK was lost due to tamper</pre><pre>2012 Nov  4 14:44:35 GA1  local6 err  oamp[2245]: ERR:    RTC: tamper 2 signal</pre><pre>2012 Nov  4 14:44:35 GA1  local6 info  oamp[2245]: INFO:     RTC: tamper timestamp = 222888 min (YYYY:MM:DD:hh:mm:ss = 0000:06:03:18:48:44.00)</pre><pre>2012 Nov  4 14:44:35 GA1  local6 info  oamp[2245]: INFO:     RTC: tamper circuits re-armed</pre><pre>2012 Nov  4 14:44:35 GA1  local6 err  oamp[2245]: ERR:    TVK was lost due to tamper</pre><pre>Command Result : 0 (Success)</pre><pre xml:space="preserve">[myluna1] lunash:&gt;</pre><pre xml:space="preserve">&#160;</pre>
        <p>&#160;</p>
        <p>As you can see, the search returns with several lines containing the keyword "tamper".</p>
        <p>Note: if you run just 'syslog tail - logname hsm' without specifying a greater number of entries, the default is to show merely the last 20 lines of the file, which is usually insufficient to see if a tamper event has been recorded. Similarly, if you run  'syslog tail - logname hsm -search tamper', the search is run only on the default 'tail' sample. Not enough entries. </p>
        <p>The Audit user is not able to view the hsm.log file.The audit user can view the audit logs which will contain similar event records, with different formatting.</p>
        <p>To view a table that compares and contrasts various "deny access" events or actions that are sometimes confused, see <a href="../../administration/decommission/destroy_scenarios.htm" class="MCXref xref">Comparison of Destruction/Denial Actions</a>in the <i>Administration Guide</i>.</p>
        <h3>Summary of Your Responses to Tamper Events</h3>
        <h4>With No SRK</h4>
        <p>If you have a password-authenticated HSM, or if you have a PED-authenticated HSM that does not have the SRK&#160;stored externally, then both splits of the MTK reside always on the HSM. </p>
        <p>The MTK is destroyed by a tamper event, and the HSM becomes unresponsive. When you react to this by rebooting the appliance, the HSM has both splits available and can immediately reconstitute the MTK and go on operating normally, without further intervention from you. </p>
        <p>You can verify that the problem was actually a tamper by viewing the hsm.log.</p>
        <h4>With SRK on Purple PED Key</h4>
        <p>If you have a  PED-authenticated HSM that <b>does</b> have the SRK&#160;stored externally, then only one split of the MTK resides on the HSM. </p>
        <p>The MTK is destroyed by a tamper event, and the HSM becomes unresponsive. When you react to this by rebooting the appliance, the HSM looks for both splits and must prompt you to supply the missing one from the purple PED&#160;Key, in order to reconstitute the MTK and go on operating normally. That is the additional intervention needed from you. </p>
        <p>You can verify that the problem was actually a tamper by viewing the hsm.log.</p>
        <p class="footer"><span class="DefaultProduct">SafeNet Network HSM</span> <span class="DefaultRelease">6.2.2</span> <span class="DefaultProjectTitle">Product Documentation</span> <br /><span class="DefaultPartNumber">007-011136-012</span> <span class="DefaultRevision">Rev. A</span> <span style="color: #5e5e5c;"><![CDATA[  ]]></span> <span class="DefaultDateLong">01 December 2016</span> <span style="color: #5e5e5c;"><![CDATA[  ]]></span> <span class="DefaultCopyright">Copyright 2001-2016</span>&#160;<span class="DefaultCompanyNameLong">Gemalto</span> <span style="color: #5e5e5c;"><![CDATA[  ]]></span>All rights reserved. </p>
    </body>
</html>