<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" data-mc-search-type="Stem" data-mc-help-system-file-name="index.xml" data-mc-path-to-help-system="../../../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-medium="non-print" data-mc-toc-path="Appliance Administration Guide|Client Connections">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>NTLS Keys in Hardware or in Software</title>
        <link href="../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../Resources/TableStyles/Page.css" rel="stylesheet" />
        <link href="../../Resources/TableStyles/Breadcrumbs.css" rel="stylesheet" />
        <link href="../../Resources/Stylesheets/Gemalto_Template_Enterprise.css" rel="stylesheet" />
        <script src="../../../Resources/Scripts/custom.modernizr.js">
        </script>
        <script src="../../../Resources/Scripts/jquery.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.config.js">
        </script>
        <script src="../../../Resources/Scripts/foundation.min.js">
        </script>
        <script src="../../../Resources/Scripts/plugins.min.js">
        </script>
        <script src="../../../Resources/Scripts/MadCapAll.js">
        </script>
    </head>
    <body>
        <table style="width: 100%;border-spacing: 0px 0px;mc-table-style: url('../../Resources/TableStyles/Breadcrumbs.css');border-left-style: none;border-left-width: 1px;border-left-color: #000000;border-right-style: none;border-right-width: 1px;border-right-color: #000000;border-top-style: none;border-top-width: 0px;border-top-color: #000000;border-bottom-style: solid;border-bottom-width: 2px;border-bottom-color: #e6e6e6;" class="TableStyle-Breadcrumbs" cellspacing="0">
            <col style="width: 41px;" class="TableStyle-Breadcrumbs-Column-Column1" />
            <col class="TableStyle-Breadcrumbs-Column-Column1" />
            <tbody>
                <tr class="TableStyle-Breadcrumbs-Body-Body1">
                    <th class="TableStyle-Breadcrumbs-BodyB-Column1-Body1">
                        <p class="home" style="font-weight: normal;"><a href="../../Home_sa.htm">Home</a> &gt;
                        </p>
                    </th>
                    <th class="TableStyle-Breadcrumbs-BodyA-Column1-Body1">
                        <div class="MCBreadcrumbsBox_0"><span class="MCBreadcrumbsPrefix">  <![CDATA[ ]]></span><span class="MCBreadcrumbsSelf">Appliance Administration Guide</span><span class="MCBreadcrumbsDivider"> &gt; </span><a class="MCBreadcrumbsLink" href="client_connections.htm">Client Connections</a><span class="MCBreadcrumbsDivider"> &gt; </span><span class="MCBreadcrumbs">NTLS Keys in Hardware or in Software</span>
                        </div>
                    </th>
                </tr>
            </tbody>
        </table>
        <h2>NTLS Keys in Hardware or in Software</h2>
        <p>In this context, "in hardware" means inside the HSM, while "in software" means on the appliance's hard disk, within the file system. </p>
        <p>The default for SafeNet HSM appliances prior to SafeNet Network HSM&#160;5 has been to have the securing keys for the NTLS link generated by the lunash command <b>sysconf regenCert</b>, and stored in the file system on the appliance's hard disk. </p>
        <h3>Moving into 'Hardware' (the HSM)</h3>
        <p>In SafeNet Network HSM&#160;5.x and newer, it is also possible to create the ssl keys directly in the HSM and store them there, using the lunash command <b>sysconf hwRegenCert</b>.</p>
        <p>A third option is to preserve software-created-and-stored keys and transfer them onto the HSM, using the lunash command <b>sysconf secureKeys</b>. </p>
        <p>Either of the latter two options requires the creation of a special HSM partition named "Cryptoki User" to store those NTLS keys. This partition must be manually created with lunash command <b>partition create</b>.</p>
        <p>Following creation or migration onto the HSM, the partition containing the NTLS keys must be activated with the lunash command <b>ntls activateKeys</b>. </p>
        <p>You can verify if the system is using keys in hardware with the lunash command <b>ntls show</b>.</p>
        <p>The keys in hardware feature creates a special container "Cryptoki User" to keep the RSA key pair for NTLS. Even though it shows in the partition list, this container is not meant to be managed by customers directly. Once it is created you should never to need touch this partition at all. </p>
        <p>If sets of NTLS&#160;keys exist in both software (on the appliance's file system) and hardware (inside the HSM), only one set is valid and registered with clients.</p>
        <h3>Going Back to 'Software' </h3>
        <p>If you were using hardware secured (stored on the HSM) keys for your NTLS links between clients and appliance, and you decide to go back to using software-stored NTLS keys, you will need to generate new keys and certificates for NTLS, as you cannot move the existing NTLS keys from the "Cryptoki User" partition back to the appliance hard disk.</p>
        <p>First, deactivate the "Cryptoki User" partition with the lunash command <b>ntls deactivateKeys</b>.</p>
        <p>Then, remove the "Cryptoki User" partition with the lunash command <b>partition delete</b>.</p>
        <p>Then, regenerate the NTLS keys and certificates in software with the lunash command <b>sysconf regenCert</b>.</p>
        <p>Finally, restart NTLS with the lunash command <b>service restart ntls</b>.</p>
        <h3>Additional Notes</h3>
        <p>Most customers are expected to choose one option or the other (NTLS keys in HSM&#160;or NTLS&#160;keys on file system) and remain with that. Probably the only situation where you might encounter the above scenarios is in a lab, while trying the options before operational deployment. </p>
        <p>If you deploy using one scheme, then wish to change at a later date by regenerating certificates (whether in hardware or in software), you must re-register all your clients with the new certificates. </p>
        <p>If you migrate an existing set of keys from software (the file system) to hardware (the HSM), using <b>sysconf secureKeys</b>, you can carry on with your current registrations, because the NTLS keys have not changed. However, you do have to activate the NTLS partition and restart the service NTLS after any restart or power failure. &#160;[This is a limitation of having the NTLS private key in hardware. &#160;NTLS  needs to open a session with a known appid that is already created and logged in by admin using <b>ntls activatekey</b> command. &#160; Every time the appliance reboots, the admin must issue the ntls command and restart NTLS before any NTL connections can be established between Clients and their working partitions. ]  </p>
        <table class="TableStyle-Page" style="mc-table-style: url('../../Resources/TableStyles/Page.css');margin-left: 0;margin-right: auto;" cellspacing="0">
            <col style="width: 175px;" class="TableStyle-Page-Column-Column1" />
            <col style="width: 282px;" class="TableStyle-Page-Column-Column1" />
            <col style="width: 282px;" class="TableStyle-Page-Column-Column1" />
            <thead>
                <tr class="TableStyle-Page-Head-Header1">
                    <th class="TableStyle-Page-HeadE-Column1-Header1" rowspan="2">
                        <p rowspan="2">&#160;</p>
                        <p rowspan="2"> Item</p>
                    </th>
                    <th class="TableStyle-Page-HeadD-Column1-Header1" colspan="2">Keys in...</th>
                </tr>
                <tr class="TableStyle-Page-Head-Header1">
                    <th class="TableStyle-Page-HeadE-Column1-Header1">Hardware (HSM)</th>
                    <th class="TableStyle-Page-HeadD-Column1-Header1">Software (hard disk)</th>
                </tr>
            </thead>
            <tbody>
                <tr class="TableStyle-Page-Body-Body1">
                    <td class="TableStyle-Page-BodyE-Column1-Body1">Security of NTLS keys</td>
                    <td class="TableStyle-Page-BodyE-Column1-Body1">
                        <p>More</p>
                    </td>
                    <td class="TableStyle-Page-BodyD-Column1-Body1">
                        <p>Less</p>
                    </td>
                </tr>
                <tr class="TableStyle-Page-Body-Body1">
                    <td class="TableStyle-Page-BodyE-Column1-Body1">Speed of link setup</td>
                    <td class="TableStyle-Page-BodyE-Column1-Body1">Slower (more overhead - but little effect for client applications that set up a link, then perform many operations before link tear-down)</td>
                    <td class="TableStyle-Page-BodyD-Column1-Body1">Faster (advantage to client applications that set up a fresh link for each operation, then tear down after the individual operation concludes - no advantage for long-duration links)</td>
                </tr>
                <tr class="TableStyle-Page-Body-Body1">
                    <td class="TableStyle-Page-BodyE-Column1-Body1">Speed ongoing</td>
                    <td class="TableStyle-Page-BodyE-Column1-Body1">
                        <p>No advantage or disadvantage</p>
                    </td>
                    <td class="TableStyle-Page-BodyD-Column1-Body1">
                        <p>No advantage or disadvantage<br /></p>
                    </td>
                </tr>
                <tr class="TableStyle-Page-Body-Body1">
                    <td class="TableStyle-Page-BodyB-Column1-Body1">Convenience</td>
                    <td class="TableStyle-Page-BodyB-Column1-Body1">
                        <p>Must swap keys with each client (registration) first time only. <br />Afterward, you must activate the Cryptoki User partition and restart the service called NTLS following any system restart. </p>
                        <p>Partition AutoActivation does not include the special Cryptoki User partition.</p>
                    </td>
                    <td class="TableStyle-Page-BodyA-Column1-Body1">Must swap keys with each client (registration) first time only.<br />Once the keys exist, the only task is to swap certificates with each client (registering), then no further link maintenance while the registrations are valid. </td>
                </tr>
            </tbody>
        </table>
        <p class="footer"><span class="DefaultProduct">SafeNet Network HSM</span> <span class="DefaultRelease">6.2.2</span> <span class="DefaultProjectTitle">Product Documentation</span> <br /><span class="DefaultPartNumber">007-011136-012</span> <span class="DefaultRevision">Rev. A</span> <span style="color: #5e5e5c;"><![CDATA[  ]]></span> <span class="DefaultDateLong">01 December 2016</span> <span style="color: #5e5e5c;"><![CDATA[  ]]></span> <span class="DefaultCopyright">Copyright 2001-2016</span>&#160;<span class="DefaultCompanyNameLong">Gemalto</span> <span style="color: #5e5e5c;"><![CDATA[  ]]></span>All rights reserved. </p>
    </body>
</html>