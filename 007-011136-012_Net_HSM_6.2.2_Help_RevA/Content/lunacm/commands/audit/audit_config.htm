<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" data-mc-search-type="Stem" data-mc-help-system-file-name="index.xml" data-mc-path-to-help-system="../../../../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-medium="non-print" data-mc-toc-path="LunaCM Command Reference Guide|LunaCM Commands|audit">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>audit config</title>
        <link href="../../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Resources/TableStyles/Page.css" rel="stylesheet" />
        <link href="../../../Resources/TableStyles/Breadcrumbs.css" rel="stylesheet" />
        <link href="../../../Resources/Stylesheets/Gemalto_Template_Enterprise.css" rel="stylesheet" />
        <script src="../../../../Resources/Scripts/custom.modernizr.js">
        </script>
        <script src="../../../../Resources/Scripts/jquery.min.js">
        </script>
        <script src="../../../../Resources/Scripts/require.min.js">
        </script>
        <script src="../../../../Resources/Scripts/require.config.js">
        </script>
        <script src="../../../../Resources/Scripts/foundation.min.js">
        </script>
        <script src="../../../../Resources/Scripts/plugins.min.js">
        </script>
        <script src="../../../../Resources/Scripts/MadCapAll.js">
        </script>
    </head>
    <body>
        <table style="width: 100%;border-spacing: 0px 0px;mc-table-style: url('../../../Resources/TableStyles/Breadcrumbs.css');border-left-style: none;border-left-width: 1px;border-left-color: #000000;border-right-style: none;border-right-width: 1px;border-right-color: #000000;border-top-style: none;border-top-width: 0px;border-top-color: #000000;border-bottom-style: solid;border-bottom-width: 2px;border-bottom-color: #e6e6e6;" class="TableStyle-Breadcrumbs" cellspacing="0">
            <col style="width: 41px;" class="TableStyle-Breadcrumbs-Column-Column1" />
            <col class="TableStyle-Breadcrumbs-Column-Column1" />
            <tbody>
                <tr class="TableStyle-Breadcrumbs-Body-Body1">
                    <th class="TableStyle-Breadcrumbs-BodyB-Column1-Body1">
                        <p class="home" style="font-weight: normal;"><a href="../../../Home_sa.htm">Home</a> &gt;
                        </p>
                    </th>
                    <th class="TableStyle-Breadcrumbs-BodyA-Column1-Body1">
                        <div class="MCBreadcrumbsBox_0"><span class="MCBreadcrumbsPrefix">  <![CDATA[ ]]></span><span class="MCBreadcrumbsSelf">LunaCM Command Reference Guide</span><span class="MCBreadcrumbsDivider"> &gt; </span><a class="MCBreadcrumbsLink" href="../commands.htm">LunaCM Commands</a><span class="MCBreadcrumbsDivider"> &gt; </span><a class="MCBreadcrumbsLink" href="audit.htm">audit</a><span class="MCBreadcrumbsDivider"> &gt; </span><span class="MCBreadcrumbs">audit config</span>
                        </div>
                    </th>
                </tr>
            </tbody>
        </table>
        <h2 class="pageBreak">audit config</h2>
        <p>Set the audit logging configuration parameters. This command allows you to configure the following:</p>
        <p class="ul1" data-mc-autonum="&lt;b&gt;•&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>•</b></span></span>which events are captured in the log.</p>
        <p class="ul1" data-mc-autonum="&lt;b&gt;•&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>•</b></span></span>the log rotation interval.</p>
        <h3 class="ntoc">Syntax</h3>
        <p><b>audit config -parameter</b> &lt;parameter&gt; <b>-value</b> &lt;value&gt; <b>-serial</b> &lt;serialnum&gt;</p>
        <table style="width: 100%;mc-table-style: url('../../../Resources/TableStyles/Page.css');" class="TableStyle-Page" cellspacing="0">
            <col class="TableStyle-Page-Column-Column1" style="width: 142px;" />
            <col class="TableStyle-Page-Column-Column1" style="width: 99px;" />
            <col class="TableStyle-Page-Column-Column1" />
            <thead>
                <tr class="TableStyle-Page-Head-Header1">
                    <th class="TableStyle-Page-HeadE-Column1-Header1">Parameter</th>
                    <th class="TableStyle-Page-HeadE-Column1-Header1">Shortcut</th>
                    <th class="TableStyle-Page-HeadD-Column1-Header1">Description</th>
                </tr>
            </thead>
            <tbody>
                <tr class="TableStyle-Page-Body-Body1">
                    <td class="TableStyle-Page-BodyE-Column1-Body1">evmask</td>
                    <td class="TableStyle-Page-BodyE-Column1-Body1">e</td>
                    <td class="TableStyle-Page-BodyD-Column1-Body1">
                        <p>The value you want to configure for the specified parameter.</p>
                        <p style="font-weight: bold;">Valid values for the event parameter</p>
                        <p>Enter a comma-separated list of events to log. In addition to specifying an event category, you must also specify the conditions under which those events are to be logged - either 'f' for failures, or 's' for successes, or both. Any or all of the following may be specified:</p>
                        <p class="ul1" data-mc-autonum="&lt;b&gt;•&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>•</b></span></span><b>[f]ailure</b>:    log command failures</p>
                        <p class="ul1" data-mc-autonum="&lt;b&gt;•&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>•</b></span></span><b>[s]uccess</b>:    log command successes</p>
                        <p class="ul1" data-mc-autonum="&lt;b&gt;•&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>•</b></span></span><b>[a]ccess</b>:     log access attempts (logins)</p>
                        <p class="ul1" data-mc-autonum="&lt;b&gt;•&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>•</b></span></span><b>[m]anage</b>:     log HSM management (init/reset/etc)</p>
                        <p class="ul1" data-mc-autonum="&lt;b&gt;•&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>•</b></span></span><b>[k]eymanage</b>:  key management events (key create/delete)</p>
                        <p class="ul1" data-mc-autonum="&lt;b&gt;•&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>•</b></span></span><b>[u]sage</b>:      key usage (enc/dec/sig/ver)</p>
                        <p class="ul1" data-mc-autonum="&lt;b&gt;•&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>•</b></span></span><b>fi[r]st</b>:      first key usage only (enc/dec/sig/ver)</p>
                        <p class="ul1" data-mc-autonum="&lt;b&gt;•&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>•</b></span></span><b>e[x]ternal</b>:   log messages from CA_LogExternal</p>
                        <p class="ul1" data-mc-autonum="&lt;b&gt;•&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>•</b></span></span><b>lo[g]manage</b>:  log events relating to log configuration</p>
                        <p class="ul1" data-mc-autonum="&lt;b&gt;•&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>•</b></span></span><b>a[l]l</b>:        log everything (user will be warned)</p>
                        <p class="ul1" data-mc-autonum="&lt;b&gt;•&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>•</b></span></span><b>[n]one</b>:       turn logging off</p>
                        <p><b>Note:</b> When specifying an event class to log, you must specify whether successful or failed events are to be logged.  For example, to log all key management events you would use the command "audit config e t,s,f".</p>
                    </td>
                </tr>
                <tr class="TableStyle-Page-Body-Body1">
                    <td class="TableStyle-Page-BodyE-Column1-Body1">get</td>
                    <td class="TableStyle-Page-BodyE-Column1-Body1">g</td>
                    <td class="TableStyle-Page-BodyD-Column1-Body1">get (show) the current configuration &#160;&#160;</td>
                </tr>
                <tr class="TableStyle-Page-Body-Body1">
                    <td class="TableStyle-Page-BodyE-Column1-Body1">interval</td>
                    <td class="TableStyle-Page-BodyE-Column1-Body1">i</td>
                    <td class="TableStyle-Page-BodyD-Column1-Body1"><b>Valid values for the rotation interval parameter</b>
                        <p>Enter one of the following options for the log rotation interval:</p>
                        <p class="ul1" style="font-weight: bold;" data-mc-autonum="&lt;b&gt;•&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>•</b></span></span>hourly [@min]</p>
                        <p class="ul1" style="font-weight: bold;" data-mc-autonum="&lt;b&gt;•&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>•</b></span></span>daily [@hour:min] </p>
                        <p class="ul1" style="font-weight: bold;" data-mc-autonum="&lt;b&gt;•&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>•</b></span></span>weekly [@day:hour:min] &#160;</p>
                        <p class="ul1" style="font-weight: bold;" data-mc-autonum="&lt;b&gt;•&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>•</b></span></span>monthly [@date:hour:min] &#160;</p>
                        <p class="ul1" style="font-weight: bold;" data-mc-autonum="&lt;b&gt;•&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>•</b></span></span>never</p>
                    </td>
                </tr>
                <tr class="TableStyle-Page-Body-Body1">
                    <td class="TableStyle-Page-BodyE-Column1-Body1">path</td>
                    <td class="TableStyle-Page-BodyE-Column1-Body1">p</td>
                    <td class="TableStyle-Page-BodyD-Column1-Body1">path on the HOST to which logs will be written</td>
                </tr>
                <tr class="TableStyle-Page-Body-Body1">
                    <td class="TableStyle-Page-BodyB-Column1-Body1">size</td>
                    <td class="TableStyle-Page-BodyB-Column1-Body1">s</td>
                    <td class="TableStyle-Page-BodyA-Column1-Body1">
                        <p>size limit of a log, to trigger rotation</p>
                        <p><b>Valid values for the size parameter</b>
                        </p>
                        <p>Enter one of the following options for the log rotation interval:</p>
                        <p class="ul1" data-mc-autonum="&lt;b&gt;•&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>•</b></span></span><b>s</b>    :   an integer string followed by 'k' for KB (default) or 'm' for MB <br />(so &#160;'s 8192' or 's 8192k' or 's 8m' all specify rotation when log size reaches 8MB)</p>
                        <p class="ul1" data-mc-autonum="&lt;b&gt;•&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>•</b></span></span><b>n</b>:       never rotate based on size &#160;<br /></p>
                    </td>
                </tr>
            </tbody>
        </table>
        <h3 class="ntoc">Example</h3><pre xml:space="preserve">
     audit config e s                 audit all command successes 
     audit config e f                 audit all command failures 
     audit config e u,f,s             audit all key usage requests, 
                                      both success and failure 
     audit config n                   log nothing 


     audit config p /usr/lunapci/log  set path 
     audit config i daily@12:05       rotate logs daily at 12:05 
     audit config s 4096              rotate logs when 4MB is exceeded 
     audit config s n                 never rotate based on size 
</pre><pre xml:space="preserve">&#160;</pre><pre xml:space="preserve">lunacm:&gt; audit config e l,f,s

        You have chosen to log all successful key usage events. This can result in
        an extremely high volume of log messages, which will significantly degrade
        the overall performance of the HSM.
        Are you sure you wish to continue?

        Type 'proceed' to continue, or 'quit' to quit now -&gt; proceed

Command Result : No Error

lunacm:&gt; audit config get

Current Logging Configuration
-----------------------------
event mask        : Log everything
rotation interval : daily@0:00
rotation size (KB): never rotate
path to log       :


Command Result : No Error

lunacm:&gt; </pre>
        <p>&#160;</p>
        <p class="note" data-mc-autonum="&lt;b&gt;Note:&lt;/b&gt; &#160;"><span class="autonumber"><span><b>Note:</b> &#160;</span></span>In the above example of output from 'audit config get', the configuration rotates the logs daily; the "never rotate" merely says "do not rotate due to size". So, from that specified configuration, you get one log each day, regardless of how big it might become.</p>
        <p class="footer"><span class="DefaultProduct">SafeNet Network HSM</span> <span class="DefaultRelease">6.2.2</span> <span class="DefaultProjectTitle">Product Documentation</span> <br /><span class="DefaultPartNumber">007-011136-012</span> <span class="DefaultRevision">Rev. A</span> <span style="color: #5e5e5c;"><![CDATA[  ]]></span> <span class="DefaultDateLong">01 December 2016</span> <span style="color: #5e5e5c;"><![CDATA[  ]]></span> <span class="DefaultCopyright">Copyright 2001-2016</span>&#160;<span class="DefaultCompanyNameLong">Gemalto</span> <span style="color: #5e5e5c;"><![CDATA[  ]]></span>All rights reserved. </p>
    </body>
</html>