<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" data-mc-search-type="Stem" data-mc-help-system-file-name="index.xml" data-mc-path-to-help-system="../../../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-medium="non-print" data-mc-toc-path="Administration Guide|Software Updates and Maintenance">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>Applying SafeNet HSM Capability Upgrades</title>
        <link href="../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../Resources/TableStyles/List1.css" rel="stylesheet" />
        <link href="../../Resources/TableStyles/Breadcrumbs.css" rel="stylesheet" />
        <link href="../../Resources/Stylesheets/Gemalto_Template_Enterprise.css" rel="stylesheet" />
        <script src="../../../Resources/Scripts/custom.modernizr.js">
        </script>
        <script src="../../../Resources/Scripts/jquery.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.config.js">
        </script>
        <script src="../../../Resources/Scripts/foundation.min.js">
        </script>
        <script src="../../../Resources/Scripts/plugins.min.js">
        </script>
        <script src="../../../Resources/Scripts/MadCapAll.js">
        </script>
    </head>
    <body>
        <table style="width: 100%;border-spacing: 0px 0px;mc-table-style: url('../../Resources/TableStyles/Breadcrumbs.css');border-left-style: none;border-left-width: 1px;border-left-color: #000000;border-right-style: none;border-right-width: 1px;border-right-color: #000000;border-top-style: none;border-top-width: 0px;border-top-color: #000000;border-bottom-style: solid;border-bottom-width: 2px;border-bottom-color: #e6e6e6;" class="TableStyle-Breadcrumbs" cellspacing="0">
            <col style="width: 41px;" class="TableStyle-Breadcrumbs-Column-Column1" />
            <col class="TableStyle-Breadcrumbs-Column-Column1" />
            <tbody>
                <tr class="TableStyle-Breadcrumbs-Body-Body1">
                    <th class="TableStyle-Breadcrumbs-BodyB-Column1-Body1">
                        <p class="home" style="font-weight: normal;"><a href="../../Home_sa.htm">Home</a> &gt;
                        </p>
                    </th>
                    <th class="TableStyle-Breadcrumbs-BodyA-Column1-Body1">
                        <div class="MCBreadcrumbsBox_0"><span class="MCBreadcrumbsPrefix"> </span><span class="MCBreadcrumbsSelf">Administration Guide</span><span class="MCBreadcrumbsDivider"> &gt; </span><a class="MCBreadcrumbsLink" href="sw_maint.htm">Software Updates and Maintenance</a><span class="MCBreadcrumbsDivider"> &gt; </span><span class="MCBreadcrumbs">Luna HSM Capability Updates</span>
                        </div>
                    </th>
                </tr>
            </tbody>
        </table>
        <h2><a name="kanchor168"></a><a name="kanchor169"></a><a name="kanchor170"></a>Applying SafeNet HSM Capability <a name="kanchor171"></a>Upgrades</h2>
        <p>SafeNet HSMs are shipped from the factory in specific configurations with specific sets 
 of capabilities, to suit your requirements. It can happen that your requirements 
 change over time. To future-proof your SafeNet HSM investment, you 
 have the option to purchase Secure Capability Updates to enhance the performance 
 or extend the capability of SafeNet systems already in your possession, as described in <a href="advanced_configuration_upgrades.htm" class="MCXref xref">Advanced Configuration Upgrades</a>. The 
 Secure Capability Update accomplishes system upgrades while safeguarding 
 the integrity of your sensitive key material and of the system software.</p>
        <p>A Secure Capability Upgrade is delivered to you as a downloaded 
 file set. The procedure to perform the update is very similar to the procedure 
 for Appliance software updates or firmware updates.</p>
        <h3 data-mc-conditions="Default.SA">Preparing to Upgrade</h3>
        <p data-mc-conditions="Default.SA">To ensure a trouble-free installation, you must prepare for the upgrade.</p>
        <h5 data-mc-conditions="Default.SA">To prepare for the upgrade</h5>
        <p class="ol1Start" data-mc-autonum="1." data-mc-conditions="Default.SA"><span class="autonumber"><span class="ol1Number">1.</span></span>Backup all SafeNet HSM Partitions to SafeNet Backup HSM or Tokens (if you have the backup option).</p>
        <p class="ol1" data-mc-autonum="2." data-mc-conditions="Default.SA"><span class="autonumber"><span class="ol1Number">2.</span></span>On the client computer, acquire the capability update software package. 
 </p>
        <p class="ol2Start" data-mc-autonum="a." data-mc-conditions="Default.SA"><span class="autonumber"><span class="ol2Number">a.</span></span>&#160;&#160;Follow the FTP instructions that are supplied in e-mail from SafeNet 
 Customer Support (support@safenet-inc.com).</p>
        <p class="ol2" data-mc-autonum="b." data-mc-conditions="Default.SA"><span class="autonumber"><span class="ol2Number">b.</span></span>&#160;Go to the temporary “appliance” directory &#160;(that 
 you created for ftp files).</p>
        <p class="ol2" data-mc-autonum="c." data-mc-conditions="Default.SA"><span class="autonumber"><span class="ol2Number">c.</span></span>&#160;&#160;Unzip the files (as directed in the ftp instructions). </p>
        <p class="ol1" data-mc-autonum="3." data-mc-conditions="Default.SA"><span class="autonumber"><span class="ol1Number">3.</span></span>Go to the location of the <b>scp</b> executable: </p>
        <table style="width: 97%;mc-table-style: url('../../Resources/TableStyles/List1.css');" class="TableStyle-List1" cellspacing="0">
            <col class="Column-Column1" />
            <col class="Column-Column1" />
            <tbody>
                <tr class="Body-Body1">
                    <td class="BodyE-Column1-Body1" data-mc-conditions="Default.SA"><b>Linux/AIX</b>
                    </td>
                    <td class="BodyD-Column1-Body1" data-mc-conditions="Default.SA">cd /usr/safenet/lunaclient/bin</td>
                </tr>
                <tr class="Body-Body1">
                    <td class="BodyE-Column1-Body1" data-mc-conditions="Default.SA"><b>Solaris/HP-UX</b>
                    </td>
                    <td class="BodyD-Column1-Body1" data-mc-conditions="Default.SA">cd /opt/safenet/lunaclient/bin</td>
                </tr>
                <tr class="Body-Body1">
                    <td class="BodyB-Column1-Body1" data-mc-conditions="Default.SA"><b>Windows</b>
                    </td>
                    <td class="BodyA-Column1-Body1" data-mc-conditions="Default.SA">cd 
 C:\Program Files\SafeNet\LunaClient</td>
                </tr>
            </tbody>
        </table>
        <p class="ol1" data-mc-autonum="4." data-mc-conditions="Default.SA"><span class="autonumber"><span class="ol1Number">4.</span></span>Copy the SafeNet appliance package file from  the ftp directory 
 to the SafeNet appliance, as follows:</p>
        <table style="width: 97%;mc-table-style: url('../../Resources/TableStyles/List1.css');" class="TableStyle-List1" cellspacing="0">
            <col class="Column-Column1" />
            <col class="Column-Column1" />
            <tbody>
                <tr class="Body-Body1">
                    <td class="BodyE-Column1-Body1"><b>Linux/UNIX</b>
                    </td>
                    <td class="BodyD-Column1-Body1">
                        <p>./scp /&lt;path&gt;/&lt;spkg_patch_file.spkg&gt; &#160;admin@&lt;LunaHostname&gt;:</p>
                    </td>
                </tr>
                <tr class="Body-Body1">
                    <td class="BodyB-Column1-Body1"><b>Windows</b>
                    </td>
                    <td class="BodyA-Column1-Body1">pscp \&lt;path&gt;\&lt;spkg_patch_file.spkg&gt; &#160;admin@&lt;LunaHostname&gt;:</td>
                </tr>
            </tbody>
        </table>
        <h3 data-mc-conditions="Default.SA">Installing the Upgrade Package</h3>
        <p data-mc-conditions="Default.SA">Once the package has been transferred to the appliance, it is installed in two stages. First the package is unwrapped into its component files with the <b>package</b> command. Then the update is applied to the HSM with the <b>hsm update</b> command.</p>
        <h5 data-mc-conditions="Default.SA">To install the upgrade package</h5>
        <p class="ol1Start" data-mc-autonum="1." data-mc-conditions="Default.SA"><span class="autonumber"><span class="ol1Number">1.</span></span>Open an SSH session or console session to the SafeNet Network HSM appliance. </p>
        <p class="ol1" data-mc-autonum="2." data-mc-conditions="Default.SA"><span class="autonumber"><span class="ol1Number">2.</span></span>Log in to the appliance as "admin".</p>
        <p class="ol1" data-mc-autonum="3." data-mc-conditions="Default.SA"><span class="autonumber"><span class="ol1Number">3.</span></span>Verify that the package has arrived: </p><pre xml:space="preserve" class="listLevel1" data-mc-conditions="Default.SA">[myluna] lunash:&gt;package listf       <br />7874  Dec 19 2011 16:46 caupdateK3908000139_100000.spkg        <br />7874  Dec 19 2011 16:35 caupdateK3908000086_100000.spkg  <br />Command Result : 0 (Success) <br />[myluna] lunash:&gt;</pre><pre xml:space="preserve" class="listLevel1" data-mc-conditions="Default.SA">
</pre>
        <p class="ol1" data-mc-autonum="4." data-mc-conditions="Default.SA"><span class="autonumber"><span class="ol1Number">4.</span></span>Open the desired package:</p><pre class="listLevel1" xml:space="preserve" data-mc-conditions="Default.SA">[myluna] lunash:&gt;package update caupdateK3908000139_100000.spkg -a XS9p7YbsW5WJp5PT <br />Command succeeded:  decrypt package <br />Command succeeded:  verify package certificate  <br />Command succeeded:  verify package signature  <br />Preparing packages for installation...  <br />908-000139-001_100000-1.0.0-0  <br />Running update script   <br />Command Result : 0 (Success) <br />[myluna] lunash:&gt;</pre><pre class="listLevel1" xml:space="preserve" data-mc-conditions="Default.SA">&#160;</pre>
        <p class="ol1" data-mc-autonum="5." data-mc-conditions="Default.SA"><span class="autonumber"><span class="ol1Number">5.</span></span>Check that the desired package is ready to be applied :</p><pre class="listLevel1" xml:space="preserve" data-mc-conditions="Default.SA">[myluna] lunash:&gt;hsm update show <br />Capability Updates:          <br />&#160;&#160;&#160;&#160;908000139_100000     <br />Command Result : 0 (Success)  <br />[myluna] lunash:&gt;</pre><pre class="listLevel1" xml:space="preserve" data-mc-conditions="Default.SA">
            <br />        </pre>
        <p class="ol1" data-mc-autonum="6." data-mc-conditions="Default.SA"><span class="autonumber"><span class="ol1Number">6.</span></span>Apply the new capability:  &#160;</p><pre class="listLevel1" xml:space="preserve" data-mc-conditions="Default.SA">[myluna] lunash:&gt;hsm update capability -capability 908000139_100000 <br style="mc-tag-and-class: ;" />CAUTION:  This command updates the HSM Capability.            <br style="mc-tag-and-class: ;" />&#160;&#160;&#160;&#160;This process cannot be reversed.            <br style="mc-tag-and-class: ;" />&#160;&#160;&#160;&#160;Any connected clients will have their            <br style="mc-tag-and-class: ;" />&#160;&#160;&#160;&#160;connections closed.            <br style="mc-tag-and-class: ;" />&#160;&#160;&#160;&#160;All clients should disconnect and the            <br style="mc-tag-and-class: ;" />&#160;&#160;&#160;&#160;NTLS should be stopped before proceeding. <br style="mc-tag-and-class: ;" />    Type 'proceed' to continue, or 'quit' to quit now.            <br style="mc-tag-and-class: ;" />&#160;&#160;&#160;&#160;&gt; proceed</pre><pre class="listLevel1" xml:space="preserve" data-mc-conditions="Default.SA"> <br style="mc-tag-and-class: ;" />FwUpdate3 Application Version 2.2  <br style="mc-tag-and-class: ;" />SafeNet Firmware/Capability Update Utility for G5 and K6 modules  <br style="mc-tag-and-class: ;" />Enter slot number (0 for the first slot found) : 0  <br style="mc-tag-and-class: ;" />This is a NON-destructive capability update  <br style="mc-tag-and-class: ;" />Update Result : 0 (Success) <br style="mc-tag-and-class: ;" />Command Result : 0 (Success) <br style="mc-tag-and-class: ;" />[myluna] lunash:&gt;</pre><pre class="listLevel1" xml:space="preserve" data-mc-conditions="Default.SA">  </pre>
        <p class="ol1" data-mc-autonum="7." data-mc-conditions="Default.SA"><span class="autonumber"><span class="ol1Number">7.</span></span>Check that the new capability is in place:</p><pre class="listLevel1" xml:space="preserve" data-mc-conditions="Default.SA">[myluna] lunash:&gt;hsm displayLicenses     <br style="mc-tag-and-class: ;" />HSM CAPABILITY LICENSES <br />   License ID          &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Description     <br style="mc-tag-and-class: ;" />================ &#160;   ====================================== <br style="mc-tag-and-class: ;" />       621000002-000 &#160;&#160;&#160;   K6 base configuration        <br style="mc-tag-and-class: ;" />621000021-001    &#160;&#160;&#160;&#160;&#160;Performance level 15           <br style="mc-tag-and-class: ;" />620127-000    &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Elliptic curve cryptography           <br style="mc-tag-and-class: ;" />620114-001    &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Key backup via cloning protocol            <br style="mc-tag-and-class: ;" />620124-000    &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Maximum 20 partitions        <br style="mc-tag-and-class: ;" />621000003-001    &#160;&#160;&#160;&#160;&#160;Enable government configuration           <br style="mc-tag-and-class: ;" />620109-000    &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;PIN entry device (PED) enabled        <br style="mc-tag-and-class: ;" />621010089-001    &#160;&#160;&#160;&#160;&#160;Enable remote PED capability        <br style="mc-tag-and-class: ;" />621010358-001    &#160;&#160;&#160;&#160;&#160;Enable a split of the master tamper key to be stored  externally        <br style="mc-tag-and-class: ;" />908000086-001 &#160;&#160;&#160;&#160;    Enabled for 15.5 megabytes of object storage        <br style="mc-tag-and-class: ;" />908000139-001    &#160;&#160;&#160;&#160;&#160;Korean market cryptographic algorithms <br style="mc-tag-and-class: ;" />   Command Result : 0 (Success)  <br style="mc-tag-and-class: ;" />[myluna] lunash:&gt;</pre><pre class="listLevel1" xml:space="preserve" data-mc-conditions="Default.SA">  </pre>
        <p class="ol1" data-mc-autonum="8." data-mc-conditions="Default.SA"><span class="autonumber"><span class="ol1Number">8.</span></span>Reboot the system to enable the new capability:  &#160;</p><pre class="listLevel1" xml:space="preserve" data-mc-conditions="Default.SA">[myluna] lunash:&gt;sysconf appliance reboot -force  <br />Force option used. Proceed prompt bypassed.  <br />'hsm supportInfo' successful. <br /> Use 'scp' from a client machine to get file  named: <br /> supportInfo.txt <br /><br />Broadcast message from root (pts/0) (Mon Dec 19 16:49:56 2011):  <br />The system is going down for reboot NOW!  <br />Reboot commencing     <br />Command Result : 0 (Success)  <br />[myluna] lunash:&gt;  

</pre>
        <p data-mc-conditions="Default.SA">&#160;</p>
        <p>In some Windows configurations, you might not have authority to copy or unzip files directly into C:\Program Files\.... In that case, put the files in a known location that can be referenced in a lunacm command.</p>
        <p class="footer"><span class="DefaultProduct">SafeNet Network HSM</span> <span class="DefaultRelease">6.2.2</span> <span class="DefaultProjectTitle">Product Documentation</span> <br /><span class="DefaultPartNumber">007-011136-012</span> <span class="DefaultRevision">Rev. A</span> <span style="color: #5e5e5c;"><![CDATA[  ]]></span> <span class="DefaultDateLong">01 December 2016</span> <span style="color: #5e5e5c;"><![CDATA[  ]]></span> <span class="DefaultCopyright">Copyright 2001-2016</span>&#160;<span class="DefaultCompanyNameLong">Gemalto</span> <span style="color: #5e5e5c;"><![CDATA[  ]]></span>All rights reserved. </p>
    </body>
</html>