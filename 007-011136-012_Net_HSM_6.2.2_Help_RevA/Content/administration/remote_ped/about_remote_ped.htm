<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" data-mc-search-type="Stem" data-mc-help-system-file-name="index.xml" data-mc-path-to-help-system="../../../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-medium="non-print" data-mc-toc-path="Administration Guide|Remote PED">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>About Remote PED</title>
        <link href="../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../Resources/TableStyles/Page.css" rel="stylesheet" />
        <link href="../../Resources/TableStyles/Breadcrumbs.css" rel="stylesheet" />
        <link href="../../Resources/Stylesheets/Gemalto_Template_Enterprise.css" rel="stylesheet" />
        <script src="../../../Resources/Scripts/custom.modernizr.js">
        </script>
        <script src="../../../Resources/Scripts/jquery.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.config.js">
        </script>
        <script src="../../../Resources/Scripts/foundation.min.js">
        </script>
        <script src="../../../Resources/Scripts/plugins.min.js">
        </script>
        <script src="../../../Resources/Scripts/MadCapAll.js">
        </script>
    </head>
    <body>
        <table style="width: 100%;border-spacing: 0px 0px;mc-table-style: url('../../Resources/TableStyles/Breadcrumbs.css');border-left-style: none;border-left-width: 1px;border-left-color: #000000;border-right-style: none;border-right-width: 1px;border-right-color: #000000;border-top-style: none;border-top-width: 0px;border-top-color: #000000;border-bottom-style: solid;border-bottom-width: 2px;border-bottom-color: #e6e6e6;" class="TableStyle-Breadcrumbs" cellspacing="0">
            <col style="width: 41px;" class="TableStyle-Breadcrumbs-Column-Column1" />
            <col class="TableStyle-Breadcrumbs-Column-Column1" />
            <tbody>
                <tr class="TableStyle-Breadcrumbs-Body-Body1">
                    <th class="TableStyle-Breadcrumbs-BodyB-Column1-Body1">
                        <p class="home" style="font-weight: normal;"><a href="../../Home_sa.htm">Home</a> &gt;
                        </p>
                    </th>
                    <th class="TableStyle-Breadcrumbs-BodyA-Column1-Body1">
                        <div class="MCBreadcrumbsBox_0"><span class="MCBreadcrumbsPrefix">  <![CDATA[ ]]></span><span class="MCBreadcrumbsSelf">Administration Guide</span><span class="MCBreadcrumbsDivider"> &gt; </span><a class="MCBreadcrumbsLink" href="remote_ped.htm">Remote PED</a><span class="MCBreadcrumbsDivider"> &gt; </span><span class="MCBreadcrumbs">About Remote PED</span>
                        </div>
                    </th>
                </tr>
            </tbody>
        </table>
        <h2>About Remote PED</h2>
        <p>The Remote PED  (SafeNet PED with Remote Capability) allows you to administer HSMs that are housed away from their owners/administrators, at physically remote sites or inside heavily-secured premises, where obtaining local physical access to the HSM is difficult or time-consuming. Remote PED provides administrative convenience similar to remotely accessing a Password-authenticated HSM, but with the added security and role separation of PED authentication.</p>
        <p>The feature requires: </p>
        <p class="ul1" data-mc-autonum="&lt;b&gt;•&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>•</b></span></span> a Remote PED Server instance </p>
        <p class="ul2" data-mc-autonum="&lt;b&gt;–&lt;/b&gt;"><span class="autonumber"><span class="ul2Bullet"><b>–</b></span></span>on a workstation </p>
        <p class="ul2" data-mc-autonum="&lt;b&gt;–&lt;/b&gt;"><span class="autonumber"><span class="ul2Bullet"><b>–</b></span></span>that connects over a secure network link </p>
        <p class="ul2" data-mc-autonum="&lt;b&gt;–&lt;/b&gt;"><span class="autonumber"><span class="ul2Bullet"><b>–</b></span></span>with a Remote PED Client </p>
        <p class="ul2" data-mc-autonum="&lt;b&gt;–&lt;/b&gt;"><span class="autonumber"><span class="ul2Bullet"><b>–</b></span></span>in the computer or appliance that contains the HSM</p>
        <p class="ul1" data-mc-autonum="&lt;b&gt;•&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>•</b></span></span> a SafeNet  PED 2.4.0-3 or greater, <b>with</b> the Remote PED feature installed, (which has the capability to operate in Local PED&#160;or Remote PED mode, as needed).</p>
        <p class="note" data-mc-autonum="&lt;b&gt;Note:&lt;/b&gt; &#160;"><span class="autonumber"><span><b>Note:</b> &#160;</span></span> Not every PED 2.4.0 includes the Remote PED feature. That PED capability must be ordered specifically and factory installed.</p>
        <p class="ul1" data-mc-autonum="&lt;b&gt;•&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>•</b></span></span> an orange RemotePED PED Key that provides the authentication for the Remote PED connection between </p>
        <p class="ul2" data-mc-autonum="&lt;b&gt;–&lt;/b&gt;"><span class="autonumber"><span class="ul2Bullet"><b>–</b></span></span>the workstation computer (with SafeNet PED 2 connected and PEDServer running) and </p>
        <p class="ul2" data-mc-autonum="&lt;b&gt;–&lt;/b&gt;"><span class="autonumber"><span class="ul2Bullet"><b>–</b></span></span>the remotely located SafeNet HSM  with the PEDclient running on the HSM's host.<br /><br /></p>
        <table style="width: 100%;margin-left: 0;margin-right: auto;mc-table-style: url('../../Resources/TableStyles/Page.css');" class="TableStyle-Page" cellspacing="0">
            <col class="TableStyle-Page-Column-Column1" />
            <col class="TableStyle-Page-Column-Column1" />
            <thead>
                <tr class="TableStyle-Page-Head-Header1">
                    <th class="TableStyle-Page-HeadE-Column1-Header1" style="text-align: left;">Term &#160;&#160;</th>
                    <th class="TableStyle-Page-HeadD-Column1-Header1" style="text-align: left;">Meaning &#160;&#160;</th>
                </tr>
            </thead>
            <tbody>
                <tr class="TableStyle-Page-Body-Body1">
                    <td class="TableStyle-Page-BodyE-Column1-Body1">Remote PED &#160;&#160;</td>
                    <td class="TableStyle-Page-BodyD-Column1-Body1">A SafeNet PED, with Remote capability, connected, powered on, and set to Remote mode. &#160;&#160;</td>
                </tr>
                <tr class="TableStyle-Page-Body-Body1">
                    <td class="TableStyle-Page-BodyE-Column1-Body1">RPV &#160;&#160;</td>
                    <td class="TableStyle-Page-BodyD-Column1-Body1">Remote PED Vector - a randomly generated, encrypted value used to authenticate between a Remote PED (via PedServer) and a distant SafeNet HSM (PEDclient). &#160;&#160;</td>
                </tr>
                <tr class="TableStyle-Page-Body-Body1">
                    <td class="TableStyle-Page-BodyE-Column1-Body1">RPK &#160;&#160;</td>
                    <td class="TableStyle-Page-BodyD-Column1-Body1">Remote PED Key - an orange PED Key, the portable repository of an RPV value, for use in the Remote PED process.&#160;&#160;</td>
                </tr>
                <tr class="TableStyle-Page-Body-Body1">
                    <td class="TableStyle-Page-BodyE-Column1-Body1">PedServer &#160;&#160;</td>
                    <td class="TableStyle-Page-BodyD-Column1-Body1">The PED server program that resides on a workstation and mediates between a locally-connected Remote PED and a distant PEDclient (running at a distant SafeNet HSM). &#160;&#160;</td>
                </tr>
                <tr class="TableStyle-Page-Body-Body1">
                    <td class="TableStyle-Page-BodyB-Column1-Body1">PEDClient</td>
                    <td class="TableStyle-Page-BodyA-Column1-Body1">The PED Client program. For a SafeNet Network HSM appliance, PEDclient is embedded. For SafeNet PCIe HSM, SafeNet USB HSM, or SafeNet Backup HSM, PEDclient must be installed on the HSM's host computer. The PED client anchors the HSM end of the Remote PED service and initiates the contact with a PedServer instance, on behalf of its HSM.</td>
                </tr>
            </tbody>
        </table>
        <h3>Why do I want it?</h3>
        <p>You want to locate your operational  HSM hosts at remote locations or 
 multiple locations around the city, country, world, and be able to administer 
 them fully, from one location, without need for site visits and without 
 carrying of PED&#160;Keys through unsecured areas.</p>
        <h3>How does it work?</h3>
        <p>The HSM must initially be configured with a local PED, in order to set its authentication and create a relationship between the HSM and an orange PED Key (RPV, or Remote PED&#160;Vector). That RPV, carried via the orange PED Key, is the means by which a PED at a remote (PedServer) location can be recognized and trusted over a distance, by an HSM that shares the same RPV. During the imprinting process, the HSM can take on the RPV of an existing orange PED Key (RPK, or Remote PED Key), or the HSM can generate a new RPV and imprint it on an orange PED Key. This allows you to choose whether </p>
        <p class="ul1" data-mc-autonum="&lt;b&gt;•&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>•</b></span></span>the current HSM is one of possibly several HSMs that can be remotely administered with the PED data path secured by a single orange PED Key, or </p>
        <p class="ul1" data-mc-autonum="&lt;b&gt;•&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>•</b></span></span>the current HSM will be the only one secured with that particular Remote PED authentication (it could remain alone, or could be the start of a new authentication group for Remote PED activity - your choice)</p>
        <p>The following diagram shows the preliminary imprinting step, where the HSM and (at least one) orange PED Key are made to share an RPV. Again, this must take place via a locally connected PED. The administrator could be co-located with the HSM, or could be elsewhere issuing the commands, but either the administrator or an assistant must be present at the HSM to present the orange PED Key for the RPV imprinting. Once that is completed, further PED operations can be untethered from direct local PED connection and moved anywhere along with that RPV-bearing orange PED Key.</p>
        <p data-mc-conditions="Default.SA">
            <img src="../../Resources/Images/sa/luna-sa-5_prep_for_remote-ped.png" alt="Illustration of equipment and relationships in preparing for Remote PED operation" title="Setting up to use Remote PED" style="width: 633px;height: 381px;" />
        </p>
        <p>The HSM is then shipped and installed at its remote location.</p>
        <p>At your administrative location, a workstation is configured with special (PedServer) software, and a SafeNet PED 2 Remote (remote-capable PED) is connected via USB to that workstation. </p>
        <p>Using SSH, you open an administrative session (connect and log in as "admin") on the remote HSM. You tell the HSM&#160;to expect a remote PED, rather than local PED. You issue commands as needed. </p>
        <p>When an HSM command requires authentication to the HSM, the HSM looks for a remote PED server with the same Remote PED&#160;Vector. If it can authenticate properly with that remote PED server, the HSM accepts authentication data via that connection. </p>
        <h3>One-to-One Remote PED Connections</h3>
        <p>A SafeNet HSM running the PED client can establish a Remote PED connection with any workstation that meets the following criteria:<br /></p>
        <p class="ul1" data-mc-autonum="&lt;b&gt;•&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>•</b></span></span> is running PEDserver.exe<br /></p>
        <p class="ul1" data-mc-autonum="&lt;b&gt;•&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>•</b></span></span> has a suitable Remote PED connected<br /></p>
        <p class="ul1" data-mc-autonum="&lt;b&gt;•&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>•</b></span></span> has the correct PED Keys (including the orange key) for that HSM. </p>
        <p>The SafeNet HSM can make only a single connection for Remote PED operation at one time. The current session must timeout or be deliberately stopped before another workstation can be called into a Remote PED connection with that SafeNet HSM.'</p>
        <p>Similarly, a given workstation can enter into a Remote PED connection with any SafeNet HSM with PEDClient, or any SafeNet HSM, that initiates such a connection (provided the proper PED, PED Keys, software, etc. are all in place), but it can make only one such connection at a time. This contrasts with SSH connections, where that same workstation could have multiple SSH windows open to multiple admin sessions on a single or multiple SafeNet HSMs.</p>
        <p>There is no requirement for the workstation providing the Remote PED connection to be the same one that provides SSH administrative access to the HSM, nor is there any requirement that they be different workstations.</p>
        <h3>Legacy vs Peer-to-peer Remote PED Connections</h3>
        <p>The above descriptions apply to Remote PED operations in general. The PEDClient runs on the computer that hosts the SafeNet HSM, while the PEDServer runs on the computer that hosts the SafeNet PED. Historically, this meant that PEDClient was launched and tried to open a connection to a specified instance of PEDServer. However, in some cases the network and firewall rules that surround the HSM host forbid that host initiating the connection from inside the firewall. For those situations, PEDServer now supports the ability to initiate the Remote PED connection from the PEDServer side, over a link secured by means of the HSM host's (usually SafeNet Network Appliance) server certificate. In aid of that peer-to-peer connection, Remote PED also makes use of a configuration file separate from the LunaClient crystoki.ini file. </p>
        <p>Peer-to-peer connection is supported by <b>PedServer.exe -mode connect</b> and <b>-mode disconnect</b> commands. The rules governing the connections are as follows: </p>
        <p class="ul1" data-mc-autonum="&lt;b&gt;•&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>•</b></span></span>The default mode when PEDServer starts is legacy mode (where PEDServer waits for a connection to be initiated from an instance of PEDClient). </p>
        <p class="ul1" data-mc-autonum="&lt;b&gt;•&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>•</b></span></span>When you type the <b>-mode connect</b> command for PEDServer (requesting the start of peer-to-peer mode), that command requires the registered HSM appliance name, which is stored in the PedServer configuration file, where each appliance name is associated with an IP&#160;address. That information, along with the appliance certificate is used to create the connection to an instance of PEDClient on the HSM host computer (usually SafeNet Network HSM). </p>
        <p class="ul1" data-mc-autonum="&lt;b&gt;•&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>•</b></span></span>The <b>-mode connect</b> command detects if legacy mode is running. </p>
        <p class="ul2" data-mc-autonum="&lt;b&gt;–&lt;/b&gt;"><span class="autonumber"><span class="ul2Bullet"><b>–</b></span></span>If legacy mode <i>is not</i> running, the <b>-mode connect</b> command initiates a connection to the indicated HSM host (normally SafeNet Network HSM appliance). </p>
        <p class="ul2" data-mc-autonum="&lt;b&gt;–&lt;/b&gt;"><span class="autonumber"><span class="ul2Bullet"><b>–</b></span></span>If legacy mode <i>is</i> running, then <b>PEDServer -mode connect</b> checks if a legacy-mode connection currently exists. If such a connection currently exists, then the <b>-mode connect</b> presents an error message informing you to terminate that connection before retrying the requested peer-to-peer connection. That is, a <b>-mode connect</b> request for peer connection does not override an existing legacy connection; it just tells you about it and lets you make the decision.</p>
        <p class="ul2" data-mc-autonum="&lt;b&gt;–&lt;/b&gt;"><span class="autonumber"><span class="ul2Bullet"><b>–</b></span></span>If legacy mode is running and <b>PEDServer -mode connect</b> does NOT&#160;discover an existing legacy connection in effect, then the legacy mode is shut down and the peer-to-peer connection is initiated. </p>
        <p class="ul1" data-mc-autonum="&lt;b&gt;•&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>•</b></span></span>The <b>-mode disconnect</b> command terminates an existing peer connection and returns the PEDServer to legacy mode. If the PEDServer is already in legacy mode, the the <b>-mode disconnect</b> command is ignored. </p>
        <h3>PedClient legacy vs peer mode</h3>
        <p>&#160;</p>
        <h3>Constraints</h3>
        <p>The following constraints apply to Remote PED connections:</p>
        <p class="ul1" data-mc-autonum="&lt;b&gt;•&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>•</b></span></span>A maximum of twenty connections is supported on the PedClient. </p>
        <p class="ul1" data-mc-autonum="&lt;b&gt;•&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>•</b></span></span>A maximum of 80 Network HSM appliances can be registered in PedServer. </p>
        <p class="ul1" data-mc-autonum="&lt;b&gt;•&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>•</b></span></span>If the connection is terminated abnormally (for example, a router switch died), there is no auto-connection. The PedServer automatically restarts and  runs in legacy mode. </p>
        <p class="ul1" data-mc-autonum="&lt;b&gt;•&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>•</b></span></span>When running in peer connection mode, the PedServer does not engage the listening service, for security reasons and to simplify usability. </p>
        <p class="ul1" data-mc-autonum="&lt;b&gt;•&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>•</b></span></span>Once the PedServer connection to the PedClient is established, the connection remains up until the</p>
        <p class="ul2" data-mc-autonum="&lt;b&gt;–&lt;/b&gt;"><span class="autonumber"><span class="ul2Bullet"><b>–</b></span></span>the <b>-mode disconnect</b> command is executed from the PedServer, or&#160;&#160;</p>
        <p class="ul2" data-mc-autonum="&lt;b&gt;–&lt;/b&gt;"><span class="autonumber"><span class="ul2Bullet"><b>–</b></span></span> PedClient  terminates the connection.</p>
        <h3>Certificate exchange and port</h3>
        <p>The exchange of certificates for peer-to-peer Remote PED is similar to the exchange and registration of certificates for NTLS, and enables a TLS&#160;1.2 link. It is implemented separately because a Remote PED&#160;host computer might also be a client for SafeNet Network HSM appliances, or it might not, and the secure peer-to-peer Remote PED connection must be able to work in either circumstance. </p>
        <p>On a SafeNet Network HSM appliance at version 6.2.1 or newer, to support peer-mode Remote PED, port number 9697 is opened for public TCP access. This is not considered a security hazard, since only incoming connections with a certificate are accepted. </p>
        <h3>Configuration file</h3>
        <p>From release 6.2.1, onward, configuration file pedServer.ini supports certificate management and other aspects of peer-to-peer Remote PED. The pedServer.ini configuration file is used to change the timeouts values and to store a list of appliance certificates, to support SSL TLS v1.2 connections between the PedServer and a SafeNet Network HSM appliance.</p>
        <p>The following entries are available : </p><pre xml:space="preserve">[RemotePed]
PongTimeout = 5 
PingInterval = 1 
LogFileTrace = 0 
LogFileError = 1 
LogFileWarning = 1 
LogFileInfo = 1  ;
MaxLogFileSize = 4194304 
LogFileName = .\remotePedServerLog.log 
BGProcessShutdownTimeoutSeconds = 25 
BGProcessStartupTimeoutSeconds = 10 
InternalShutdownTimeoutSeconds = 10 
SocketWriteTimeoutSeconds = 50 
SocketReadRspTimeoutSeconds = 180 
SocketReadTimeoutSeconds = 100 
ExternalServerIF = 1 
ServerPortValue = 1503 
ExternalAdminIF = 0 
AdminPort = 1502 
IdleConnectionTimeoutSeconds = 1800 
RpkSerialNumberQueryTimeout = 15 

[Appliances] 
SSLConfigFile = \usr\safenet\lunaclient\bin\openssl.cnf
ServerCAFile = \root\CAFile.pem 
ServerIP00 = 192.20.11.86 
ServerPort00 = 9696 
ServerName00 = mySafeNetAppliance 
CommonCertName00 = test1 
ServerName01 = myotherSafeNetAppliance 
ServerIP01 = 192.20.9.46 
ServerPort01 = 9697 
CommonCertName01 = test2 
&#160;&#160;&#160;</pre>
        <p>&#160;</p>
        <p>An entry  is added in the chrystoki configuration file to point to the location of the PedServer configuration file. </p><pre xml:space="preserve">[Ped Server]
PedConfigFile = \usr\safenet\lunaclient\data\ped\config </pre>
        <p>&#160;</p>
        <p>&#160;</p>
        <h3>Priority and Lockout</h3>
        <p>When a Remote PED connection is in force, the local PED interface to the HSM is disabled. If a local PED operation is in progress, it is not possible to start a Remote PED connection until the current local-PED-mediated HSM&#160;operation completes. But it must be an active operation sequence - merely having a local PED&#160;physically connected to the HSM does not lock out the initiation of a Remote PED connection. For example, if you had started an HSM command that began using a connected local PED and PED Key for authentication, and you started an SSH session in which you issued the <b>ped connect</b> (LunaCM) command or <b>hsm ped connect</b> (LunaSH) command, one of the following two things would happen:</p>
        <p class="ul1" data-mc-autonum="&lt;b&gt;•&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>•</b></span></span>the remote PED connect command would begin executing, but would pause while the local-PED operation (started in the other command session) was in progress, and resume when the local-PED operation terminated</p>
        <p class="ul1" data-mc-autonum="&lt;b&gt;•&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>•</b></span></span>the remote PED connect command would begin executing, but would pause while the local-PED operation was in progress, and eventually time-out if the local-PED operation did not terminate sufficiently quickly.</p>
        <p>If a Remote PED connection is currently in force, then the local PED is ignored, and all PED requests are routed to the Remote PED. </p>
        <p>If a Remote PED connection is currently in force, then subsequent attempts to start a different connection are refused until the current connection times out or is deliberately stopped. </p>
        <h3>Remote PED&#160;Timeout</h3>
        <p>In local PED mode, one SafeNet PED is connected directly to the HSM. Timeouts are governed by the configuration of the appliance or host computer and the HSM and are not generally modifiable.</p>
        <p data-mc-conditions="Default.SA">In Remote PED&#160;mode, the PED Server on each remote workstation has a timeout setting (which can be modified), and the HSM has a Remote PED timeout setting that can be shown (lunash command <b>hsm ped timeout show</b> on SafeNet Network HSM) and modified (lunash command <b>hsm ped timeout set</b> on SafeNet Network HSM). If nothing has been set, then the default value for the Remote PED&#160;connection timeout (1800 seconds) is in effect. </p>
        <p>The Remote PED server instances on workstations, and the Remote PED&#160;client inside the SafeNet Network HSM appliance or on an HSM host computer, are not aware of each other's timeout values. For a given Remote PED connection, the shorter timeout value rules. Thus, if a Remote PED server on one of your workstation computers were to timeout during a Remote PED sequence, it would log the event and send a message to the appliance or HSM host that the connection had been open too long. The Remote PED Client on the SafeNet Network HSM appliance or HSM host computer, receiving that message, would gracefully close the link and the host-side timeout would not be reached. </p>
        <p>Generally, the state that causes the HSM to look for PED authentication via the Remote path, rather than from a locally-connected PED, persists unless you change it. The session between the Remote PED and the PedServer on that host also remains intact. It is the link between PedClient (at the HSM end) and PedServer (at the Remote PED end) that goes down for lack of use, and that link can be restarted with a single command when needed.</p>
        <p data-mc-conditions="Default.SA">If it has been some time (more than half an hour) since you performed any authentication operations via Remote PED, the link has probably lapsed. Find out with lunash:&gt;<b>hsm ped show</b>. If it says "not assigned", then the connection has been lost. Simply issue the <b>hsm ped connect</b> command again, when needed. </p>
        <h3>Ports</h3>
        <p>We suggest port 1503 for the legacy Remote PED connection, but you can use any port that does not conflict with another operation.</p>
        <h3>Windows 7</h3>
        <p><b>PedServer.exe</b> (on the computer to which your Remote PED is attached) is run from the command line. If you accepted default locations when installing LunaClient (or Remote PED option from within LunaClient installer), then the software is installed on your C: drive under "Program Files". This has implications regarding the permissions you have on the system. </p>
        <p>To use PedServer from within a protected location on a Windows 7 computer, right-click the Command Prompt icon, and from the resulting menu select "Run as Administrator".</p>
        <p>
            <img src="../../Resources/Images/ped/run_win7_console_as_admin.png" />
        </p>
        <p class="note" data-mc-autonum="&lt;b&gt;Note:&lt;/b&gt; &#160;"><span class="autonumber"><span><b>Note:</b> &#160;</span></span>If you lack system permissions to operate as Administrator on the computer that is to host the PED Server, contact your IT department to address the situation. <br />Alternatively, install LunaClient (or a subset of it, such as Remote PED) in a non-default location in your computer that is not subject to permission restrictions. If you do so, you avoid this permission problem, but you must translate all file-location references in this documentation to reflect the chosen install location. </p>
        <p>If you open a command-prompt window as an ordinary user in Windows 7, and run PedServer.exe, the program detects if it lacks access and permissions, and returns an error like the following:</p><pre xml:space="preserve">C:\Program Files\SafeNet\LunaClient&gt;pedserver mode start
Ped Server Version 1.0.5 (10005)

Failed to load configuration file.  Using default settings.

Ped Server launched in startup mode.
Starting background process
InternalRead: 10 seconds timeout
Failed to recv query response command: RC_OPERATION_TIMED_OUT c0000303
Background process startup timed out after 10 seconds.
Startup failed. : 0xc0000303 RC_OPERATION_TIMED_OUT

C:\Program Files\SafeNet\LunaClient&gt;</pre><pre xml:space="preserve">&#160;</pre>
        <p>If you encounter the error above, use Windows Task Manager to select the PedServer process, right-click, and select "End process", before cleanly retrying <b>PedServer.exe</b> via an Administrator Command Prompt. </p>
        <p>Other Windows versions have not exhibited this requirement.</p>
        <h3>Limitations</h3>
        <p>Regardless of whether you use legacy mode or peer-to-peer, the connection is one-on-one. While a Remote PED connection is active between one HSM and one remote PED workstation (running PedServer.exe), neither entity is able to make a similar connection with a different partner. The connection must time out, or be deliberately stopped before the HSM can connect with another PedServer workstation and enter a new remote PED authentication arrangement.</p>
        <p>When an RPV is created, it is a randomly-generated value that exists nowhere else. You control which (and how many) HSMs will contain that RPV, and which (and how many) orange RPK PED Keys will contain copies of it. A Remote PED with an inserted RPK (orange Remote PED&#160;Key) can be used only with distant SafeNet HSMs that share that exact RPV. If you launch a Remote PedServer with a connected Remote PED and provide any other orange PED&#160;Key, it is not accepted by any distant SafeNet HSM that does not have the matching RPV. In this manner, you can segregate the ability of personnel to remotely control specific HSMs, by controlling which orange PED&#160;Keys they are issued. Two people in the same office could have access and control of entirely different sets of remotely located HSMs, with no overlap, as long as you trusted them not to exchange orange PED&#160;Keys. You can further control who has what access by invoking MofN when you first create an RPV.</p>
        <h3>Compatibility</h3>
        <p>Remote PED for SafeNet HSM 5.2 is not compatible with earlier HSM versions.</p>
        <h3>Security of Remote PED</h3>
        <p>All communication between the Remote PED and the HSM in its host is transmitted within an AES-256 encrypted channel using session keys based on secrets (the Remote PED Vector (RPV) on the orange Remote PED Key (RPK)) that are shared out-of-band via the Remote PED role. This is considered a very secure query/response mechanism.</p>
        <p>&#160;</p>
        <h3>Remote PED Peer-to-peer Step-by-step Setup </h3>
        <p>This example assumes : </p>
        <p class="ul1" data-mc-autonum="&lt;b&gt;•&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>•</b></span></span>A SafeNet Network HSM </p>
        <p class="ul1" data-mc-autonum="&lt;b&gt;•&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>•</b></span></span>A SafeNet Network HSM appliance user with administrator or operator role privilege level (we will call this one the Safenet Appliance user or "SA user")</p>
        <p class="ul1" data-mc-autonum="&lt;b&gt;•&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>•</b></span></span>A client computer that hosts a Remote PED (SafeNet PED with Remote capability)</p>
        <p class="ul1" data-mc-autonum="&lt;b&gt;•&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>•</b></span></span>A user on the Remote PED host computer that has Windows administrative privilege (we will call this one the PEDServer user or "PS user")</p>
        <h4>Configuration (one time only)</h4>
        <p class="ol1Start" data-mc-autonum="1."><span class="autonumber"><span class="ol1Number">1.</span></span>SA user uses scp or PSCP to acquire a copy of the SafeNet Network HSM server.pem file and delivers that to PS user. </p>
        <p class="ol1" data-mc-autonum="2."><span class="autonumber"><span class="ol1Number">2.</span></span>&#160;PS user registers the server.pem by executing the command </p><pre class="listLevel1" xml:space="preserve">pedServer –appliance register –name &lt;unique name&gt; -certificate &lt;Luna SA certificate file&gt; 
-ip &lt;Luna SA server&gt; [-port &lt;port number&gt;]&#160;&#160;</pre>
        <p>&#160;</p>
        <p class="ol1" data-mc-autonum="3."><span class="autonumber"><span class="ol1Number">3.</span></span>[Optional] SA user regenerates the client-side certificate by running command: </p><pre class="listLevel1">pedServer –regenCert</pre>
        <p>&#160;</p>
        <p>&#160;</p>
        <p>&#160;</p>
        <p class="footer"><span class="DefaultProduct">SafeNet Network HSM</span> <span class="DefaultRelease">6.2.2</span> <span class="DefaultProjectTitle">Product Documentation</span> <br /><span class="DefaultPartNumber">007-011136-012</span> <span class="DefaultRevision">Rev. A</span> <span style="color: #5e5e5c;"><![CDATA[  ]]></span> <span class="DefaultDateLong">01 December 2016</span> <span style="color: #5e5e5c;"><![CDATA[  ]]></span> <span class="DefaultCopyright">Copyright 2001-2016</span>&#160;<span class="DefaultCompanyNameLong">Gemalto</span> <span style="color: #5e5e5c;"><![CDATA[  ]]></span>All rights reserved. </p>
    </body>
</html>