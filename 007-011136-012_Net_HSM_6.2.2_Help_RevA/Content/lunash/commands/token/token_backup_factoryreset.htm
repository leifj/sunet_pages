<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" data-mc-search-type="Stem" data-mc-help-system-file-name="index.xml" data-mc-path-to-help-system="../../../../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-medium="non-print" data-mc-toc-path="LunaSH Command Reference Guide|LunaSH Commands|token|token backup">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>token backup factoryreset</title>
        <link href="../../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Resources/TableStyles/Page.css" rel="stylesheet" />
        <link href="../../../Resources/TableStyles/Breadcrumbs.css" rel="stylesheet" />
        <link href="../../../Resources/Stylesheets/Gemalto_Template_Enterprise.css" rel="stylesheet" />
        <script src="../../../../Resources/Scripts/custom.modernizr.js">
        </script>
        <script src="../../../../Resources/Scripts/jquery.min.js">
        </script>
        <script src="../../../../Resources/Scripts/require.min.js">
        </script>
        <script src="../../../../Resources/Scripts/require.config.js">
        </script>
        <script src="../../../../Resources/Scripts/foundation.min.js">
        </script>
        <script src="../../../../Resources/Scripts/plugins.min.js">
        </script>
        <script src="../../../../Resources/Scripts/MadCapAll.js">
        </script>
    </head>
    <body>
        <table style="width: 100%;border-spacing: 0px 0px;mc-table-style: url('../../../Resources/TableStyles/Breadcrumbs.css');border-left-style: none;border-left-width: 1px;border-left-color: #000000;border-right-style: none;border-right-width: 1px;border-right-color: #000000;border-top-style: none;border-top-width: 0px;border-top-color: #000000;border-bottom-style: solid;border-bottom-width: 2px;border-bottom-color: #e6e6e6;" class="TableStyle-Breadcrumbs" cellspacing="0">
            <col style="width: 41px;" class="TableStyle-Breadcrumbs-Column-Column1" />
            <col class="TableStyle-Breadcrumbs-Column-Column1" />
            <tbody>
                <tr class="TableStyle-Breadcrumbs-Body-Body1">
                    <th class="TableStyle-Breadcrumbs-BodyB-Column1-Body1">
                        <p class="home" style="font-weight: normal;"><a href="../../../Home_sa.htm">Home</a> &gt;
                        </p>
                    </th>
                    <th class="TableStyle-Breadcrumbs-BodyA-Column1-Body1">
                        <div class="MCBreadcrumbsBox_0"><span class="MCBreadcrumbsPrefix">  <![CDATA[ ]]></span><span class="MCBreadcrumbsSelf">LunaSH Command Reference Guide</span><span class="MCBreadcrumbsDivider"> &gt; </span><a class="MCBreadcrumbsLink" href="../commands.htm">LunaSH Commands</a><span class="MCBreadcrumbsDivider"> &gt; </span><a class="MCBreadcrumbsLink" href="token.htm">token</a><span class="MCBreadcrumbsDivider"> &gt; </span><span class="MCBreadcrumbs">token backup factoryreset</span>
                        </div>
                    </th>
                </tr>
            </tbody>
        </table>
        <h2 class="pageBreak">token backup factoryreset</h2>
        <p>Reset a backup token to factory default settings (destroys the KEK&#160;or permanently denies access to existing objects, erasesor authentication, so you need to initialize before using again). &#160;Can 
 be run only from the local serial console.</p>
        <p>The action is equivalent to the <span style="font-family: monospace;">hsm factoryReset</span> command that acts on the appliance's built-in HSM.</p>
        <p>View a table that compares and contrasts various "deny access" events or actions that are sometimes confused.&#160; <a href="../../../administration/decommission/destroy_scenarios.htm" target="_blank">"Destroy" action/event scenarios</a>&#160;&#160;(Right-click the link if you prefer that it not open in a new window.)</p>
        <p>An external SafeNet HSM can be USB-connected to a SafeNet Network HSM appliance for:</p>
        <p class="ul1" data-mc-autonum="&lt;b&gt;•&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>•</b></span></span>local backup/restore operations (SafeNet Backup HSM)</p>
        <p class="ul1" data-mc-autonum="&lt;b&gt;•&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>•</b></span></span>PKI bundle operations (SafeNet USB HSM)</p>
        <p>SafeNet Network HSM does not pass PED operations and data through to an externally connected SafeNet HSM from a SafeNet PED that is connected locally to the SafeNet Network HSM.</p>
        <p>If the external HSM is PED-authenticated, then the options for SafeNet PED connection are:</p>
        <p class="ul1" data-mc-autonum="&lt;b&gt;•&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>•</b></span></span>local PED connection, directly to the affected HSM, when needed, or</p>
        <p class="ul1" data-mc-autonum="&lt;b&gt;•&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>•</b></span></span>Remote PED connection, passed through the SafeNet Network HSM&#160;</p>
        <p class="note" data-mc-autonum="&lt;b&gt;Note:&lt;/b&gt; &#160;"><span class="autonumber"><span><b>Note:</b> &#160;</span></span>Support for PKI Bundles with Remote PED  begins at firmware version 6.10.1 in the external HSM.</p>
        <p class="note" data-mc-autonum="&lt;b&gt;Note:&lt;/b&gt; &#160;"><span class="autonumber"><span><b>Note:</b> &#160;</span></span>Support for  locally connected Backup HSM with Remote PED, <br />begins at firmware version 6.10.1 in the external HSM.</p>
        <p class="note" data-mc-autonum="&lt;b&gt;Note:&lt;/b&gt; &#160;"><span class="autonumber"><span><b>Note:</b> &#160;</span></span>Use of Remote PED with an external device is made possible when you set up with the commands <br /><b>hsm ped vector init</b> -serial &lt;serial#_of_external_HSM&gt; <br />and <br /><b>hsm ped connect</b> -serial &lt;serial#_of_external_HSM&gt; <br />before using <b>token pki</b> or <b>token backup</b> commands. &#160;</p>
        <p>&#160;</p>
        <p class="note" data-mc-autonum="&lt;b&gt;Note:&lt;/b&gt; &#160;"><span class="autonumber"><span><b>Note:</b> &#160;</span></span><b>WHEN to USE lunash "token backup" commands, or use "vtl backup" commands?</b>  &#160;<br /><br /><span style="color: #000000;">LunaSH </span><span class="code"><span style="color: #000000;">token backup</span></span><span style="color: #000000;"> commands operate a SafeNet Backup HSM  attached directly to SafeNet Network HSM via USB, and are <b>not</b> intended for use with remotely connected backup devices.</span><![CDATA[  ]]><br />You might have a <span class="MCExpanding MCExpanding_Open expanding"><a href="javascript:void(0);" class="MCExpandingHead MCExpandingHotSpot expandingHead MCExpandingHotSpot_">locally-connected backup HSM<img class="MCExpanding_Image_Icon" src="../../../../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" /></a><span class="MCExpandingBody expandingBody"> [ connects directly to a SafeNet Network HSM via USB cable ]</span></span> and a locally connected serial terminal and be walking them from SafeNet Network HSM to SafeNet Network HSM in your server room to perform backups. Or you might be administering remotely via SSH and lunash:&gt; commands, while a technician in your server center carries the backup HSM from one SafeNet Network HSM to the next. In either case, these "token backup" commands are the method to use.The important distinction is where the backup HSM is physically connected -  from the SafeNet Network HSM perspective, those are both local backup operations to a Backup HSM that is locally connected to the appliance.<br /><br /><span style="color: #000000;">VTL backup commands operate a SafeNet Backup HSM connected to a computer, and located distantly from your primary SafeNet Network HSM appliance. The VTL backup commands are <b>not</b> for use with a SafeNet Backup HSM that is connected directly to your SafeNet Network HSM appliance.</span><br />For true, hands-off, lights-out operation of your SafeNet appliances, use a SafeNet Remote Backup HSM located in your <span class="MCExpanding MCExpanding_Open expanding"><a href="javascript:void(0);" class="MCExpandingHead MCExpandingHotSpot expandingHead MCExpandingHotSpot_">administrator's office<img class="MCExpanding_Image_Icon" src="../../../../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" /></a><span class="MCExpandingBody expandingBody"> [ or other convenient location ]</span></span>, connected to a computer acting as a <span class="MCExpanding MCExpanding_Open expanding"><a href="javascript:void(0);" class="MCExpandingHead MCExpandingHotSpot expandingHead MCExpandingHotSpot_">Remote Backup server<img class="MCExpanding_Image_Icon" src="../../../../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" /></a><span class="MCExpandingBody expandingBody"> [ this could be your administrative workstation, or it could be a completely separate computer ]</span></span>. This means the computer and Backup HSM are located near you and remote/distant from your SafeNet Network HSM appliance(s). For that application, use the <b>backup commands in the VTL utility</b> supplied with the SafeNet Network HSM <span class="MCExpanding MCExpanding_Open expanding"><a href="javascript:void(0);" class="MCExpandingHead MCExpandingHotSpot expandingHead MCExpandingHotSpot_">Client software<img class="MCExpanding_Image_Icon" src="../../../../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" /></a><span class="MCExpandingBody expandingBody"> [ which must be installed on the computer that is acting as Remote Backup server ]</span></span> &#160;- the appliance <span class="code">token backup</span> commands (previous paragraph) are not designed to work for Remote Backup.</p>
        <h3 class="ntoc">Syntax</h3>
        <p class="code"><b>token backup factoryReset -serial</b> &lt;serialnum&gt; <b>[-force</b>]</p>
        <table style="mc-table-style: url('../../../Resources/TableStyles/Page.css');width: 100%;" class="TableStyle-Page" cellspacing="0">
            <col style="width: 173px;" class="TableStyle-Page-Column-Column1" />
            <col style="width: 81px;" class="TableStyle-Page-Column-Column1" />
            <col style="width: 282px;" class="TableStyle-Page-Column-Column1" />
            <thead>
                <tr class="TableStyle-Page-Head-Header1">
                    <th class="TableStyle-Page-HeadE-Column1-Header1">Parameter</th>
                    <th class="TableStyle-Page-HeadE-Column1-Header1">Shortcut</th>
                    <th class="TableStyle-Page-HeadD-Column1-Header1">Description</th>
                </tr>
            </thead>
            <tbody>
                <tr class="TableStyle-Page-Body-Body1">
                    <td class="TableStyle-Page-BodyE-Column1-Body1" style="font-weight: bold;">-serial</td>
                    <td class="TableStyle-Page-BodyE-Column1-Body1" style="font-weight: bold;">-s</td>
                    <td class="TableStyle-Page-BodyD-Column1-Body1">Specifies the token serial number. </td>
                </tr>
                <tr class="TableStyle-Page-Body-Body1">
                    <td class="TableStyle-Page-BodyB-Column1-Body1" style="font-weight: bold;">-force</td>
                    <td class="TableStyle-Page-BodyB-Column1-Body1" style="font-weight: bold;">-f</td>
                    <td class="TableStyle-Page-BodyA-Column1-Body1">Force the action without prompting.</td>
                </tr>
            </tbody>
        </table>
        <h3 class="ntoc">Example</h3><pre xml:space="preserve">lunash:&gt; token backup factoryReset -serial 667788<br />&#160;</pre><pre xml:space="preserve">Command Result : 0 (Success)<br />lunash:&gt;</pre><pre xml:space="preserve">&#160;</pre><pre xml:space="preserve">If you run the command via a network connection, the system refuses:</pre><pre xml:space="preserve">lunash:&gt;token backup factoryReset
</pre><pre xml:space="preserve">&#160;</pre><pre xml:space="preserve">Error:  'token factoryReset' can only be run from the local
console. Login as 'admin' using the serial port on
the SafeNet Network HSM before running this command.
</pre><pre xml:space="preserve">&#160;</pre><pre xml:space="preserve">Command Result : 0 (Success)
</pre>
        <p class="footer"><span class="DefaultProduct">SafeNet Network HSM</span> <span class="DefaultRelease">6.2.2</span> <span class="DefaultProjectTitle">Product Documentation</span> <br /><span class="DefaultPartNumber">007-011136-012</span> <span class="DefaultRevision">Rev. A</span> <span style="color: #5e5e5c;"><![CDATA[  ]]></span> <span class="DefaultDateLong">01 December 2016</span> <span style="color: #5e5e5c;"><![CDATA[  ]]></span> <span class="DefaultCopyright">Copyright 2001-2016</span>&#160;<span class="DefaultCompanyNameLong">Gemalto</span> <span style="color: #5e5e5c;"><![CDATA[  ]]></span>All rights reserved. </p>
    </body>
</html>