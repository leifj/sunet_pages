<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" data-mc-search-type="Stem" data-mc-help-system-file-name="index.xml" data-mc-path-to-help-system="../../../../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-medium="non-print" data-mc-toc-path="LunaSH Command Reference Guide|LunaSH Commands|hsm|hsm firmware">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>hsm firmware upgrade </title>
        <link href="../../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Resources/TableStyles/Page.css" rel="stylesheet" />
        <link href="../../../Resources/TableStyles/Breadcrumbs.css" rel="stylesheet" />
        <link href="../../../Resources/Stylesheets/Gemalto_Template_Enterprise.css" rel="stylesheet" />
        <script src="../../../../Resources/Scripts/custom.modernizr.js">
        </script>
        <script src="../../../../Resources/Scripts/jquery.min.js">
        </script>
        <script src="../../../../Resources/Scripts/require.min.js">
        </script>
        <script src="../../../../Resources/Scripts/require.config.js">
        </script>
        <script src="../../../../Resources/Scripts/foundation.min.js">
        </script>
        <script src="../../../../Resources/Scripts/plugins.min.js">
        </script>
        <script src="../../../../Resources/Scripts/MadCapAll.js">
        </script>
    </head>
    <body>
        <table style="width: 100%;border-spacing: 0px 0px;mc-table-style: url('../../../Resources/TableStyles/Breadcrumbs.css');border-left-style: none;border-left-width: 1px;border-left-color: #000000;border-right-style: none;border-right-width: 1px;border-right-color: #000000;border-top-style: none;border-top-width: 0px;border-top-color: #000000;border-bottom-style: solid;border-bottom-width: 2px;border-bottom-color: #e6e6e6;" class="TableStyle-Breadcrumbs" cellspacing="0">
            <col style="width: 41px;" class="TableStyle-Breadcrumbs-Column-Column1" />
            <col class="TableStyle-Breadcrumbs-Column-Column1" />
            <tbody>
                <tr class="TableStyle-Breadcrumbs-Body-Body1">
                    <th class="TableStyle-Breadcrumbs-BodyB-Column1-Body1">
                        <p class="home" style="font-weight: normal;"><a href="../../../Home_sa.htm">Home</a> &gt;
                        </p>
                    </th>
                    <th class="TableStyle-Breadcrumbs-BodyA-Column1-Body1">
                        <div class="MCBreadcrumbsBox_0"><span class="MCBreadcrumbsPrefix">  <![CDATA[ ]]></span><span class="MCBreadcrumbsSelf">LunaSH Command Reference Guide</span><span class="MCBreadcrumbsDivider"> &gt; </span><a class="MCBreadcrumbsLink" href="../commands.htm">LunaSH Commands</a><span class="MCBreadcrumbsDivider"> &gt; </span><a class="MCBreadcrumbsLink" href="hsm.htm">hsm</a><span class="MCBreadcrumbsDivider"> &gt; </span><span class="MCBreadcrumbs">hsm firmware upgrade</span>
                        </div>
                    </th>
                </tr>
            </tbody>
        </table>
        <h2 class="pageBreak">hsm firmware upgrade </h2>
        <p>This command updates the HSM firmware by applying the Firmware Update File that was saved in the standby location by the SafeNet factory, or by your most recent SafeNet Network HSM appliance update. The current HSM firmware version (before this command is run), becomes the rollback version after the command is run. See command <a href="hsm_firmware_rollback.htm" class="MCXref xref">hsm firmware rollback </a>, to roll back to the previous firmware version.</p>
        <p>The command example, below, shows that the command offers guidance about re-sizing of partitions, before you update the HSM firmware, in anticipation of the increased partition overhead with the newer firmware (and therefore slightly reduced space for objects in each partition) : </p>
        <p class="ul1" data-mc-autonum="&lt;b&gt;•&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>•</b></span></span>Always archive your partition contents before manipulating the partition(s). </p>
        <p class="ul1" data-mc-autonum="&lt;b&gt;•&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>•</b></span></span>Resizing is needed only if you intend to keep the partition contents. </p>
        <p class="note" data-mc-autonum="&lt;b&gt;Note:&lt;/b&gt; &#160;"><span class="autonumber"><span><b>Note:</b> &#160;</span></span>If you are both <br />&#160;- upgrading from an earlier firmware version to HSM firmware 6.22.0 (or newer) <br />AND <br />&#160;- applying the Per-Partition SO (PPSO)&#160;capability update, <br />be aware that the PPSO capability update is destructive. Therefore, there is no need to re-size partitions. <br /><br />Instead, to avoid unnecessary duplication of effort, you should <br />&#160;- safeguard (archive) any existing partition contents, <br />&#160;- then zeroize the HSM for a clean update, <br />&#160;- then perform  both the firmware AND capability updates, <br />&#160;- and finally restore to new partitions.</p>
        <h3 class="ntoc">Syntax</h3>
        <p class="code"><b>hsm firmware upgrade</b>
        </p>
        <table style="caption-side: top;width: 100%;mc-table-style: url('../../../Resources/TableStyles/Page.css');" class="TableStyle-Page" cellspacing="0">
            <col class="TableStyle-Page-Column-Column1" style="width: 126px;" />
            <col class="TableStyle-Page-Column-Column1" style="width: 149px;" />
            <col class="TableStyle-Page-Column-Column1" />
            <thead>
                <tr class="TableStyle-Page-Head-Header1">
                    <th style="text-align: left;font-size: 12pt;" class="TableStyle-Page-HeadE-Column1-Header1">
                        <p> Parameter</p>
                    </th>
                    <th style="text-align: left;font-size: 12pt;" class="TableStyle-Page-HeadE-Column1-Header1">
                        <p>Shortcut  </p>
                    </th>
                    <th style="text-align: left;font-size: 12pt;" class="TableStyle-Page-HeadD-Column1-Header1">
                        <p>Description </p>
                    </th>
                </tr>
            </thead>
            <tbody>
                <tr class="TableStyle-Page-Body-Body1">
                    <td class="TableStyle-Page-BodyB-Column1-Body1" style="font-weight: bold;">-force</td>
                    <td class="TableStyle-Page-BodyB-Column1-Body1" style="font-weight: bold;">-f</td>
                    <td class="TableStyle-Page-BodyA-Column1-Body1">
                        <p>Force the action </p>
                    </td>
                </tr>
            </tbody>
        </table>
        <h3 class="ntoc">Example </h3><pre xml:space="preserve">[mylunaSA2] lunash:&gt;hsm firmware update

   The HSM Administrator is logged in. Proceeding...

   WARNING: This operation will upgrade the firmware and restart NTLS/HTL/STC !!!

         (1) All current NTLS and/or STC sessions will be reset.
         (2) If the server keys are in hardware, you must re-activate them.
         (3) If the PED use is remote, you must re-connect it.

*****************************************************************************************
  IMPORTANT NOTICE WITH UPGRADE TO FIRMWARE VERSION 6.22.0+

  The architecture of the new firmware requires re-organization of memory on the HSM.
  Before updating:
    1. Backup the contents of your HSM.
    2. Delete any unused partitions and their contents.
    3. Re-size any partitions that reserved more space than needed.
    4. If you have no unused partitions and none that you can resize,
       you must free up sufficient memory for the new firmware by
       moving some partitions and their contents to another
       HSM or upgrading memory if at the factory configuration.

  Do not proceed with firmware update until you have increased the available
  memory on the HSM sufficiently.
*****************************************************************************************

   Type 'proceed' to continue, or 'quit' to quit now.

   &gt; proceed
   Proceeding...


Upgrade firmware version has requirements for available free space on HSM.
Checking that sufficient free space exists before firmware upgrade.


        Partition #: 153182004  Name: Cryptoki User     Status: Passed
Sufficient space exists for firmware upgrade.


Update Result : 0 (Success)
resetting HSM ...
Stopping ntls:OK
Starting ntls:OK
Stopping htl:OK
Starting htl:OK
Stopping stcd:                                             [  OK  ]
Starting stcd:                                             [  OK  ]

Command Result : 0 (Success)
[mylunaSA2] lunash:&gt;</pre><pre xml:space="preserve">&#160;</pre>
        <p>&#160;</p>
        <p class="footer"><span class="DefaultProduct">SafeNet Network HSM</span> <span class="DefaultRelease">6.2.2</span> <span class="DefaultProjectTitle">Product Documentation</span> <br /><span class="DefaultPartNumber">007-011136-012</span> <span class="DefaultRevision">Rev. A</span> <span style="color: #5e5e5c;"><![CDATA[  ]]></span> <span class="DefaultDateLong">01 December 2016</span> <span style="color: #5e5e5c;"><![CDATA[  ]]></span> <span class="DefaultCopyright">Copyright 2001-2016</span>&#160;<span class="DefaultCompanyNameLong">Gemalto</span> <span style="color: #5e5e5c;"><![CDATA[  ]]></span>All rights reserved. </p>
    </body>
</html>