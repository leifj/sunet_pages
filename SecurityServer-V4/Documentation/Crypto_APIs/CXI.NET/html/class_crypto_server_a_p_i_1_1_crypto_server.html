<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>CXI.NET: CryptoServer Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">CXI.NET
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.2 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespace_crypto_server_a_p_i.html">CryptoServerAPI</a></li><li class="navelem"><a class="el" href="class_crypto_server_a_p_i_1_1_crypto_server.html">CryptoServer</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pro-static-attribs">Static Protected Attributes</a> &#124;
<a href="#properties">Properties</a> &#124;
<a href="class_crypto_server_a_p_i_1_1_crypto_server-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">CryptoServer Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>This class implements an interface to Utimaco's Hardware Security Modul "CryptoServer".  
 <a href="class_crypto_server_a_p_i_1_1_crypto_server.html#details">More...</a></p>

<p><code>#include &lt;CryptoServer.h&gt;</code></p>
<div class="dynheader">
Inheritance diagram for CryptoServer:</div>
<div class="dyncontent">
 <div class="center">
  <img src="class_crypto_server_a_p_i_1_1_crypto_server.png" usemap="#CryptoServer_map" alt=""/>
  <map id="CryptoServer_map" name="CryptoServer_map">
<area href="class_crypto_server_a_p_i_1_1_crypto_server_cluster.html" title="This class implements an interface to a cluster of Utimaco&#39;s Hardware Security Moduls &quot;CryptoServer&quot;..." alt="CryptoServerCluster" shape="rect" coords="0,56,129,80"/>
<area href="class_crypto_server_c_x_i_1_1_cxi.html" title="This class implements an interface to the firmware module CXI running on Utimaco&#39;s Hardware Security ..." alt="Cxi" shape="rect" coords="0,112,129,136"/>
</map>
 </div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a33f610dd329f493745fefbe602f8a2ff"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_crypto_server_a_p_i_1_1_crypto_server.html#a33f610dd329f493745fefbe602f8a2ff">CryptoServer</a> (String^ device, int connect_timeout, int read_timeout)</td></tr>
<tr class="separator:a33f610dd329f493745fefbe602f8a2ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae376cb5d52319dea4f0144d7fe21f051"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_crypto_server_a_p_i_1_1_crypto_server.html#ae376cb5d52319dea4f0144d7fe21f051">CryptoServer</a> (String^ device, int connect_timeout)</td></tr>
<tr class="separator:ae376cb5d52319dea4f0144d7fe21f051"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ed846551bea334cf4c534b9a95a1561"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_crypto_server_a_p_i_1_1_crypto_server.html#a4ed846551bea334cf4c534b9a95a1561">CryptoServer</a> (<a class="el" href="class_crypto_server_a_p_i_1_1_crypto_server_config.html">CryptoServerConfig</a>^ config)</td></tr>
<tr class="separator:a4ed846551bea334cf4c534b9a95a1561"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a767c258df5ebabd33ba08c783df459fa"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_crypto_server_a_p_i_1_1_crypto_server.html#a767c258df5ebabd33ba08c783df459fa">~CryptoServer</a> ()</td></tr>
<tr class="separator:a767c258df5ebabd33ba08c783df459fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4aad287f2dbac574bb939f9c6efe77a9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_crypto_server_a_p_i_1_1_crypto_server.html#a4aad287f2dbac574bb939f9c6efe77a9">!CryptoServer</a> ()</td></tr>
<tr class="separator:a4aad287f2dbac574bb939f9c6efe77a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9346a35b44811828dc424826472d2417"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_crypto_server_a_p_i_1_1_crypto_server.html#a9346a35b44811828dc424826472d2417">Close</a> (void)</td></tr>
<tr class="separator:a9346a35b44811828dc424826472d2417"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adb96cedc9341a1a50436003ac815fa60"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_crypto_server_a_p_i_1_1_crypto_server.html#adb96cedc9341a1a50436003ac815fa60">PrepareAuthentication</a> (String^ user, String^ key, String^ password)</td></tr>
<tr class="separator:adb96cedc9341a1a50436003ac815fa60"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a545ad21dc709e4adeac255e6576af76f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_crypto_server_a_p_i_1_1_crypto_server.html#a545ad21dc709e4adeac255e6576af76f">PrepareAuthentication</a> (String^ user, String^ password)</td></tr>
<tr class="separator:a545ad21dc709e4adeac255e6576af76f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac3908b235d93a9664fd8de7fa6fbdcb6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_crypto_server_a_p_i_1_1_crypto_server.html#ac3908b235d93a9664fd8de7fa6fbdcb6">EndAuthentication</a> (void)</td></tr>
<tr class="separator:ac3908b235d93a9664fd8de7fa6fbdcb6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac12452d54092c3d2711833ca787ecf04"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_crypto_server_a_p_i_1_1_crypto_server.html#ac12452d54092c3d2711833ca787ecf04">GetSessionKey</a> (String^ user, String^ password)</td></tr>
<tr class="separator:ac12452d54092c3d2711833ca787ecf04"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a113c38e816b9517b16c21a1c8485323b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_crypto_server_a_p_i_1_1_crypto_server.html#a113c38e816b9517b16c21a1c8485323b">GetSessionKey</a> (void)</td></tr>
<tr class="separator:a113c38e816b9517b16c21a1c8485323b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b3cc44e2007ff04a24694a3a1936cfb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_crypto_server_a_p_i_1_1_crypto_server.html#a6b3cc44e2007ff04a24694a3a1936cfb">EndSession</a> (void)</td></tr>
<tr class="separator:a6b3cc44e2007ff04a24694a3a1936cfb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f1df259da19fc7c50d304255c7f9946"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_crypto_server_a_p_i_1_1_crypto_server.html#a9f1df259da19fc7c50d304255c7f9946">Logon</a> (String^ user, String^ key, String^ password)</td></tr>
<tr class="separator:a9f1df259da19fc7c50d304255c7f9946"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaff8af35401a1414ca0a4ad31a2de27d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_crypto_server_a_p_i_1_1_crypto_server.html#aaff8af35401a1414ca0a4ad31a2de27d">Logon</a> (String^ user, String^ password)</td></tr>
<tr class="separator:aaff8af35401a1414ca0a4ad31a2de27d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a68d510d503cbdd8768fbbcca8949119a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_crypto_server_a_p_i_1_1_crypto_server.html#a68d510d503cbdd8768fbbcca8949119a">Logoff</a> (void)</td></tr>
<tr class="separator:a68d510d503cbdd8768fbbcca8949119a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16e082608c2b456eb92f1d0d4ed18099"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_crypto_server_a_p_i_1_1_crypto_server.html#a16e082608c2b456eb92f1d0d4ed18099">GetAuthState</a> (void)</td></tr>
<tr class="separator:a16e082608c2b456eb92f1d0d4ed18099"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6bce3b95cf671b7b3b86f24db2586d12"><td class="memItemLeft" align="right" valign="top">array&lt; Byte &gt;^&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_crypto_server_a_p_i_1_1_crypto_server.html#a6bce3b95cf671b7b3b86f24db2586d12">Exec</a> (int fc, int sfc, array&lt; Byte &gt;^command)</td></tr>
<tr class="separator:a6bce3b95cf671b7b3b86f24db2586d12"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:add5a6738221cc1272e2100d8d791907b"><td class="memItemLeft" align="right" valign="top">static String^&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_crypto_server_a_p_i_1_1_crypto_server.html#add5a6738221cc1272e2100d8d791907b">GetVersion</a> (void)</td></tr>
<tr class="separator:add5a6738221cc1272e2100d8d791907b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-static-attribs"></a>
Static Protected Attributes</h2></td></tr>
<tr class="memitem:a8794849a350cc195f475e528c0ff3e9d"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a8794849a350cc195f475e528c0ff3e9d"></a>
static const int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_crypto_server_a_p_i_1_1_crypto_server.html#a8794849a350cc195f475e528c0ff3e9d">DEF_READ_TIMEOUT</a> = 60000</td></tr>
<tr class="memdesc:a8794849a350cc195f475e528c0ff3e9d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Default read timeout on command execution in milliseconds. <br/></td></tr>
<tr class="separator:a8794849a350cc195f475e528c0ff3e9d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03e9f3e985d157f77b14727fc137d6a2"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a03e9f3e985d157f77b14727fc137d6a2"></a>
static const int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_crypto_server_a_p_i_1_1_crypto_server.html#a03e9f3e985d157f77b14727fc137d6a2">DEF_CONNECT_TIMEOUT</a> = 3000</td></tr>
<tr class="memdesc:a03e9f3e985d157f77b14727fc137d6a2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Default connection timeout in milliseconds. <br/></td></tr>
<tr class="separator:a03e9f3e985d157f77b14727fc137d6a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="properties"></a>
Properties</h2></td></tr>
<tr class="memitem:a4c7a521b8f1a0769c09bfa4a1fca7dab"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_crypto_server_a_p_i_1_1_crypto_server.html#a4c7a521b8f1a0769c09bfa4a1fca7dab">version</a><code> [get]</code></td></tr>
<tr class="separator:a4c7a521b8f1a0769c09bfa4a1fca7dab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee145bfca8e9b2eaf3cd3c47157be9a3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_crypto_server_a_p_i_1_1_crypto_server.html#aee145bfca8e9b2eaf3cd3c47157be9a3">timeout</a><code> [get, set]</code></td></tr>
<tr class="separator:aee145bfca8e9b2eaf3cd3c47157be9a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a06a8deb1fddefddb64dede7476cc31d4"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_crypto_server_a_p_i_1_1_crypto_server.html#a06a8deb1fddefddb64dede7476cc31d4">keepSessionAlive</a><code> [get, set]</code></td></tr>
<tr class="separator:a06a8deb1fddefddb64dede7476cc31d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a111944a310c32c89c958ad7813e01c60"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_crypto_server_a_p_i_1_1_crypto_server.html#a111944a310c32c89c958ad7813e01c60">endSessionOnShutdown</a><code> [get, set]</code></td></tr>
<tr class="separator:a111944a310c32c89c958ad7813e01c60"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This class implements an interface to Utimaco's Hardware Security Modul "CryptoServer". </p>
<p>Each instance of this class handles a connection to one dedicated CryptoServer. </p>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="class_crypto_server_a_p_i_1_1_crypto_server_cluster.html">CryptoServerCluster</a> on how to create an instance to a cluster of CryptoServer.</dd></dl>
<dl class="section user"><dt>Example (C#):</dt><dd></dd></dl>
<p>The following code illustrates the usage of the class <a class="el" href="class_crypto_server_a_p_i_1_1_crypto_server.html" title="This class implements an interface to Utimaco&#39;s Hardware Security Modul &quot;CryptoServer&quot;.">CryptoServer</a>: </p>
<div class="fragment"><div class="line"><span class="keyword">using</span> System;</div>
<div class="line"><span class="keyword">using</span> CryptoServerAPI;</div>
<div class="line"></div>
<div class="line"><span class="keyword">namespace </span>CryptoServerDemo</div>
<div class="line">{</div>
<div class="line">  <span class="keyword">class </span>Program</div>
<div class="line">  {</div>
<div class="line">    <span class="keyword">static</span> <span class="keywordtype">void</span> Main(<span class="keywordtype">string</span>[] args)</div>
<div class="line">    {   </div>
<div class="line">      String device = System.Environment.GetEnvironmentVariable(<span class="stringliteral">&quot;CRYPTOSERVER&quot;</span>);</div>
<div class="line">      </div>
<div class="line">      <span class="keywordflow">if</span> (device == null)</div>
<div class="line">        device = <span class="stringliteral">&quot;PCI:0&quot;</span>;</div>
<div class="line"></div>
<div class="line">      CryptoServer cs = null;</div>
<div class="line"></div>
<div class="line">      <span class="keywordflow">try</span></div>
<div class="line">      {</div>
<div class="line">        <span class="comment">// open connection to CryptoServer with a connection timeout of 3 seconds</span></div>
<div class="line">        CryptoServer cs = <span class="keyword">new</span> CryptoServer(device, 3000);</div>
<div class="line">          </div>
<div class="line">        <span class="comment">// set the command execution timeout to 60 seconds</span></div>
<div class="line">        cs.timeout = 60000;</div>
<div class="line">      </div>
<div class="line">        <span class="comment">// prevent a secure messaging session from exiring after 15 minutes of idle time</span></div>
<div class="line">        cs.keepSessionAlive = <span class="keyword">true</span>;</div>
<div class="line">        </div>
<div class="line">        <span class="comment">// logon first user &#39;paul&#39; with password &#39;utimaco&#39;</span></div>
<div class="line">        cs.Logon(<span class="stringliteral">&quot;paul&quot;</span>, <span class="stringliteral">&quot;utimaco&quot;</span>);</div>
<div class="line">        </div>
<div class="line">        <span class="comment">// logon second user &#39;kate&#39; with encrypted keyfile &#39;rsa.key&#39; and password &#39;123456&#39;</span></div>
<div class="line">        cs.Logon(<span class="stringliteral">&quot;kate&quot;</span>, <span class="stringliteral">&quot;rsa.key&quot;</span>, <span class="stringliteral">&quot;123456&quot;</span>);</div>
<div class="line">      </div>
<div class="line">        <span class="comment">// logon third user &#39;bill&#39; with a smartcard at a USB connected reader </span></div>
<div class="line">        cs.Logon(<span class="stringliteral">&quot;bill&quot;</span>, <span class="stringliteral">&quot;:cs2:cyb:USB0&quot;</span>, <span class="keyword">nullptr</span>);</div>
<div class="line">      </div>
<div class="line">        <span class="comment">// get resulting authentication status (permission sum of paul, kate and bill)</span></div>
<div class="line">        <span class="keywordtype">int</span> auth_state = cs.GetAuthState();</div>
<div class="line">        Console.WriteLine(<span class="stringliteral">&quot;AuthState: &quot;</span> + String.Format(<span class="stringliteral">&quot;{0:X}&quot;</span>, state));</div>
<div class="line">        </div>
<div class="line">        <span class="comment">// execute echo command (sfc = 0) on CMDS firmware module (fc = 0x83)</span></div>
<div class="line">        byte[] command = System.Text.Encoding.ASCII.GetBytes(<span class="stringliteral">&quot;Hello World&quot;</span>);</div>
<div class="line">        byte[] answ = cs.Exec(0x83, 0, command);</div>
<div class="line">        CryptoServerUtil.XTrace(<span class="stringliteral">&quot;answ&quot;</span>, answ);</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">catch</span> (CryptoServerException ex)</div>
<div class="line">      {</div>
<div class="line">        Console.WriteLine(ex.Message);   </div>
<div class="line">        Console.WriteLine(ex.StackTrace);</div>
<div class="line"></div>
<div class="line">        Console.WriteLine(<span class="stringliteral">&quot;ErrorCode: 0x{0,8:X}&quot;</span>, ex.ErrorCode);</div>
<div class="line">        CryptoServerUtil.XTrace(<span class="stringliteral">&quot;ErrorAnswer&quot;</span>, ex.ErrorAnswer);</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">finally</span></div>
<div class="line">      {</div>
<div class="line">        <span class="keywordflow">if</span> (cs != null) cs.Dispose();</div>
<div class="line">      }   </div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --> </div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a33f610dd329f493745fefbe602f8a2ff"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_crypto_server_a_p_i_1_1_crypto_server.html">CryptoServer</a> </td>
          <td>(</td>
          <td class="paramtype">String^&#160;</td>
          <td class="paramname"><em>device</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>connect_timeout</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>read_timeout</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Creates a new connection to a CryptoServer.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">device</td><td>Address of the CryptoServer. May contain the prefix "TCP:" followed by the IP address or port number and IP address (seperated by a '@'), or the prefix "PCI:" followed by the device name of a PCI device.<br/>
 Examples:<br/>
<ul>
<li>"TCP:192.168.4.99"</li>
<li>"TCP:288@192.168.4.201"</li>
<li>"PCI:0"</li>
<li>"PCI:/dev/cs2" </li>
</ul>
</td></tr>
    <tr><td class="paramname">connect_timeout</td><td>Timeout in milliseconds to establich the connection to a CryptoServer.<br/>
 If the given value is less or equal to zero a default value of <a class="el" href="class_crypto_server_a_p_i_1_1_crypto_server.html#a03e9f3e985d157f77b14727fc137d6a2">DEF_CONNECT_TIMEOUT</a> is used.</td></tr>
    <tr><td class="paramname">read_timeout</td><td>Read timeout on command execution in milliseconds (see <a class="el" href="class_crypto_server_a_p_i_1_1_crypto_server.html#aee145bfca8e9b2eaf3cd3c47157be9a3">timeout</a>).<br/>
 If the given value is less or equal to zero a default value of <a class="el" href="class_crypto_server_a_p_i_1_1_crypto_server.html#a8794849a350cc195f475e528c0ff3e9d">DEF_READ_TIMEOUT</a> is used. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ae376cb5d52319dea4f0144d7fe21f051"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_crypto_server_a_p_i_1_1_crypto_server.html">CryptoServer</a> </td>
          <td>(</td>
          <td class="paramtype">String^&#160;</td>
          <td class="paramname"><em>device</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>connect_timeout</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Creates a new connection to a CryptoServer.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">device</td><td>Address of the CryptoServer. May contain the prefix "TCP:" followed by the IP address or port number and IP address (seperated by a '@'), or the prefix "PCI:" followed by the device name of a PCI device.<br/>
 Examples:<br/>
<ul>
<li>"TCP:192.168.4.99"</li>
<li>"TCP:288@192.168.4.201"</li>
<li>"PCI:0"</li>
<li>"PCI:/dev/cs2" </li>
</ul>
</td></tr>
    <tr><td class="paramname">connect_timeout</td><td>Timeout in milliseconds to establich the connection to a CryptoServer.<br/>
 If the given value is less or equal to zero a default value of <a class="el" href="class_crypto_server_a_p_i_1_1_crypto_server.html#a03e9f3e985d157f77b14727fc137d6a2">DEF_CONNECT_TIMEOUT</a> is used.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>The command execution timeout is set to a default value of <a class="el" href="class_crypto_server_a_p_i_1_1_crypto_server.html#a8794849a350cc195f475e528c0ff3e9d">DEF_READ_TIMEOUT</a>. </dd></dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="class_crypto_server_a_p_i_1_1_crypto_server.html#aee145bfca8e9b2eaf3cd3c47157be9a3">timeout</a> property </dd></dl>

</div>
</div>
<a class="anchor" id="a4ed846551bea334cf4c534b9a95a1561"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_crypto_server_a_p_i_1_1_crypto_server.html">CryptoServer</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_crypto_server_a_p_i_1_1_crypto_server_config.html">CryptoServerConfig</a>^&#160;</td>
          <td class="paramname"><em>config</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Creates a new connection to a CryptoServer.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">config</td><td>Configuration object. The following key names will be recognized:<br/>
<br/>
 <table class="doxtable">
<tr>
<th>Key </th><th>Mandatory </th><th>Default Value </th><th>Description  </th></tr>
<tr>
<td>Device </td><td>Yes </td><td>- </td><td>Device specifier of CryptoServer to be connected (e.g 'PCI:0', '192.168.4.1').  </td></tr>
<tr>
<td>Timeout </td><td>No </td><td>60000 </td><td>Timeout in milliseconds the API waits for an answer on command execution (see <a class="el" href="class_crypto_server_a_p_i_1_1_crypto_server.html#aee145bfca8e9b2eaf3cd3c47157be9a3">timeout</a>).  </td></tr>
<tr>
<td>ConnectionTimeout </td><td>No </td><td>3000 </td><td>Timeout in milliseconds the API waits on attempt to connect to a CryptoServer  </td></tr>
<tr>
<td>KeepSessionAlive </td><td>No </td><td>false </td><td>Prevents a secure messaging session from expiring after having been idle for more than 15 minutes (see <a class="el" href="class_crypto_server_a_p_i_1_1_crypto_server.html#a06a8deb1fddefddb64dede7476cc31d4">keepSessionAlive</a>).  </td></tr>
<tr>
<td>EndSessionOnShutdown </td><td>No </td><td>false </td><td>Enables or disables an event handler that terminates active sessions on shutdown (see <a class="el" href="class_crypto_server_a_p_i_1_1_crypto_server.html#a111944a310c32c89c958ad7813e01c60">endSessionOnShutdown</a>).  </td></tr>
<tr>
<td><br/>
 </td><td></td><td></td><td></td></tr>
</table>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Examplary configuration file:</dt><dd><div class="fragment"><div class="line"><span class="preprocessor"># examplary configuration file for a single CryptoServer</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line">Device = 192.168.4.183</div>
<div class="line">#Device = PCI:0</div>
<div class="line"></div>
<div class="line">ConnectionTimeout = 1000 </div>
<div class="line">Timeout = 30000</div>
<div class="line">KeepSessionAlive = <span class="keyword">true</span></div>
<div class="line">EndSessionOnShutdown = <span class="keyword">true</span></div>
</div><!-- fragment --> </dd></dl>

</div>
</div>
<a class="anchor" id="a767c258df5ebabd33ba08c783df459fa"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">~<a class="el" href="class_crypto_server_a_p_i_1_1_crypto_server.html">CryptoServer</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Terminates the current session (if any) and closes the connection to the CryptoServer.</p>
<dl class="section note"><dt>Note</dt><dd>Use the delete operator method only if you are an old-fashioned software developer.</dd></dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="class_crypto_server_a_p_i_1_1_crypto_server.html#a6b3cc44e2007ff04a24694a3a1936cfb">EndSession</a> </dd>
<dd>
<a class="el" href="class_crypto_server_a_p_i_1_1_crypto_server.html#a9346a35b44811828dc424826472d2417">Close</a> </dd></dl>

</div>
</div>
<a class="anchor" id="a4aad287f2dbac574bb939f9c6efe77a9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">!<a class="el" href="class_crypto_server_a_p_i_1_1_crypto_server.html">CryptoServer</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Terminates the current session (if any) and closes the connection to the CryptoServer.</p>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="class_crypto_server_a_p_i_1_1_crypto_server.html#a6b3cc44e2007ff04a24694a3a1936cfb">EndSession</a> </dd>
<dd>
<a class="el" href="class_crypto_server_a_p_i_1_1_crypto_server.html#a9346a35b44811828dc424826472d2417">Close</a> </dd></dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="add5a6738221cc1272e2100d8d791907b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">String GetVersion </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Returns the version of the <a class="el" href="class_crypto_server_a_p_i_1_1_crypto_server.html" title="This class implements an interface to Utimaco&#39;s Hardware Security Modul &quot;CryptoServer&quot;.">CryptoServer</a> API as string. </p>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="class_crypto_server_a_p_i_1_1_crypto_server.html#a4c7a521b8f1a0769c09bfa4a1fca7dab">version</a> </dd></dl>

</div>
</div>
<a class="anchor" id="a9346a35b44811828dc424826472d2417"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Close </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Closes the connection to the CryptoServer. <br/>
 </p>

</div>
</div>
<a class="anchor" id="adb96cedc9341a1a50436003ac815fa60"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PrepareAuthentication </td>
          <td>(</td>
          <td class="paramtype">String^&#160;</td>
          <td class="paramname"><em>user</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">String^&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">String^&#160;</td>
          <td class="paramname"><em>password</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Prepares authentication with either RSA or ECDSA signature authentication mechanism.</p>
<p>The subsequent commands executed via the <a class="el" href="class_crypto_server_a_p_i_1_1_crypto_server.html#a6bce3b95cf671b7b3b86f24db2586d12">Exec</a> method or the <a class="el" href="class_crypto_server_a_p_i_1_1_crypto_server.html#ac12452d54092c3d2711833ca787ecf04">GetSessionKey</a> method are authenticated. Call <a class="el" href="class_crypto_server_a_p_i_1_1_crypto_server.html#ac3908b235d93a9664fd8de7fa6fbdcb6">EndAuthentication</a> to stop authentication.</p>
<p>This method can be called multiple times for different users in order to apply a Multi-Persons-Rule.</p>
<dl class="section note"><dt>Note</dt><dd><a class="el" href="class_crypto_server_a_p_i_1_1_crypto_server.html#adb96cedc9341a1a50436003ac815fa60">PrepareAuthentication</a> will not create an encrypted (secure messaging) session, subsequent commands will still be send in plain.<br/>
 </dd></dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="class_crypto_server_a_p_i_1_1_crypto_server.html#ac12452d54092c3d2711833ca787ecf04">GetSessionKey</a> in order to established an encrypted session.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">user</td><td>Name of user to be authenticated. </td></tr>
    <tr><td class="paramname">key</td><td>Device specifier of signature token:<ul>
<li>smartcard (e.g. ':cs2:cyb:COM3')</li>
<li>key file (e.g. 'D:\secret\MySecret.key'). </li>
</ul>
</td></tr>
    <tr><td class="paramname">password</td><td>Password of key file in case of an encrypted key file.<br/>
 The password should be set to nullptr in case of a plain key file.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Example:</dt><dd></dd></dl>
<p>The following code illustrates the usage of the PrepareAuthentication method: </p>
<div class="fragment"><div class="line">CryptoServer ^cs = <span class="keyword">gcnew</span> CryptoServer(<span class="stringliteral">&quot;PCI:0&quot;</span>, 1000, 60000);</div>
<div class="line">  </div>
<div class="line"><span class="comment">// logon first user &#39;kate&#39; with encrypted keyfile &#39;rsa.key&#39; and password &#39;123456&#39;</span></div>
<div class="line">cs-&gt;Logon(<span class="stringliteral">&quot;kate&quot;</span>, <span class="stringliteral">&quot;rsa.key&quot;</span>, <span class="stringliteral">&quot;123456&quot;</span>);</div>
<div class="line"></div>
<div class="line"><span class="comment">// logon second user &#39;bill&#39; with a smartcard at a USB connected reader </span></div>
<div class="line">cs-&gt;Logon(<span class="stringliteral">&quot;bill&quot;</span>, <span class="stringliteral">&quot;:cs2:cyb:USB0&quot;</span>, <span class="keyword">nullptr</span>);</div>
<div class="line"></div>
<div class="line"><span class="comment">// get resulting authentication status (permission sum of kate and bill)</span></div>
<div class="line"><span class="keywordtype">int</span> auth_state = cs-&gt;GetAuthState();</div>
<div class="line">Console::WriteLine(<span class="stringliteral">&quot;AuthState: &quot;</span> + String::Format(<span class="stringliteral">&quot;{0:X}&quot;</span>, state));</div>
<div class="line"> </div>
<div class="line"><span class="comment">// execute further commands ...</span></div>
<div class="line"><span class="comment">// cs-&gt;Exec(...);</span></div>
<div class="line"></div>
<div class="line"><span class="comment">// end authentication</span></div>
<div class="line">cs-&gt;EndAuthentication();</div>
</div><!-- fragment --> 
</div>
</div>
<a class="anchor" id="a545ad21dc709e4adeac255e6576af76f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PrepareAuthentication </td>
          <td>(</td>
          <td class="paramtype">String^&#160;</td>
          <td class="paramname"><em>user</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">String^&#160;</td>
          <td class="paramname"><em>password</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Prepares authentication with a password authentication mechanism.</p>
<p>The subsequent commands executed via the <a class="el" href="class_crypto_server_a_p_i_1_1_crypto_server.html#a6bce3b95cf671b7b3b86f24db2586d12">Exec</a> method or the <a class="el" href="class_crypto_server_a_p_i_1_1_crypto_server.html#ac12452d54092c3d2711833ca787ecf04">GetSessionKey</a> method are authenticated. Call <a class="el" href="class_crypto_server_a_p_i_1_1_crypto_server.html#ac3908b235d93a9664fd8de7fa6fbdcb6">EndAuthentication</a> to stop authentication.</p>
<p>This method can be called multiple times for different users in order to apply a Multi-Persons-Rule.</p>
<dl class="section note"><dt>Note</dt><dd><a class="el" href="class_crypto_server_a_p_i_1_1_crypto_server.html#adb96cedc9341a1a50436003ac815fa60">PrepareAuthentication</a> will not create an encrypted (secure messaging) session, subsequent commands will still be send in plain.<br/>
 </dd></dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="class_crypto_server_a_p_i_1_1_crypto_server.html#ac12452d54092c3d2711833ca787ecf04">GetSessionKey</a> in order to established an encrypted session.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">user</td><td>Name of user to be authenticated. </td></tr>
    <tr><td class="paramname">password</td><td>Password of user.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Example:</dt><dd></dd></dl>
<p>The following code illustrates the usage of the PrepareAuthentication method: </p>
<div class="fragment"><div class="line">CryptoServer ^cs = <span class="keyword">gcnew</span> CryptoServer(<span class="stringliteral">&quot;PCI:0&quot;</span>, 1000, 60000);</div>
<div class="line">  </div>
<div class="line"><span class="comment">// logon first user &#39;paul&#39; with password &#39;utimaco&#39;</span></div>
<div class="line">cs-&gt;Logon(<span class="stringliteral">&quot;paul&quot;</span>, <span class="stringliteral">&quot;utimaco&quot;</span>);</div>
<div class="line"></div>
<div class="line"><span class="comment">// logon second user &#39;peter&#39; with password &#39;123456&#39;</span></div>
<div class="line">cs-&gt;Logon(<span class="stringliteral">&quot;peter&quot;</span>, <span class="stringliteral">&quot;123456&quot;</span>);</div>
<div class="line"></div>
<div class="line"><span class="comment">// get resulting authentication status (permission sum of paul and peter)</span></div>
<div class="line"><span class="keywordtype">int</span> auth_state = cs-&gt;GetAuthState();</div>
<div class="line">Console::WriteLine(<span class="stringliteral">&quot;AuthState: &quot;</span> + String::Format(<span class="stringliteral">&quot;{0:X}&quot;</span>, state));</div>
<div class="line"></div>
<div class="line"><span class="comment">// execute further commands ...</span></div>
<div class="line"><span class="comment">// cs-&gt;Exec(...);</span></div>
<div class="line"></div>
<div class="line"><span class="comment">// end authentication</span></div>
<div class="line">cs-&gt;EndAuthentication();</div>
</div><!-- fragment --> 
</div>
</div>
<a class="anchor" id="ac3908b235d93a9664fd8de7fa6fbdcb6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EndAuthentication </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Ends authentication. All pending authentication requests issued with <a class="el" href="class_crypto_server_a_p_i_1_1_crypto_server.html#adb96cedc9341a1a50436003ac815fa60">PrepareAuthentication</a> are cancelled. </p>

</div>
</div>
<a class="anchor" id="ac12452d54092c3d2711833ca787ecf04"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void GetSessionKey </td>
          <td>(</td>
          <td class="paramtype">String^&#160;</td>
          <td class="paramname"><em>user</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">String^&#160;</td>
          <td class="paramname"><em>password</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Establishs an encrypted (secure messaging) session between host and CryptoServer.</p>
<p>Subsequent commands are automatically authenticated by all users having authenticated themself so far.</p>
<p>In case of a password authentication mechanism the session key is derived from the password otherwise the session key is exchanged with the RSA or ECDSA based Diffie-Hellman algorithm.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">user</td><td>Name of user to be used to exchange the session key. </td></tr>
    <tr><td class="paramname">password</td><td>Password of user to be used to derive the session key. Set to nullptr in case of any signature authentication mechanism.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>An AES or DES session key is negotiated with the CryptoServer and used to encrypt all commands send to and all answers received from the CryptoServer. The session is valid for all subsequence communication until a new session key is generated or the session is terminated with the <a class="el" href="class_crypto_server_a_p_i_1_1_crypto_server.html#a6b3cc44e2007ff04a24694a3a1936cfb">EndSession</a> method. </dd></dl>

</div>
</div>
<a class="anchor" id="a113c38e816b9517b16c21a1c8485323b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void GetSessionKey </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Establishs an encrypted (secure messaging) session between host and CryptoServer.</p>
<p>Subsequent commands are automatically authenticated by all users having authenticated themself so far.</p>
<p>The session key is allways exchanged with the Diffie-Hellman algorithm based on a temporary 1024 bits RSA key.</p>
<dl class="section note"><dt>Note</dt><dd>An AES or DES session key is negotiated with the CryptoServer and used to encrypt all commands send to and all answers received from the CryptoServer. The session is valid for all subsequence communication until a new session key is generated or the session is terminated with the <a class="el" href="class_crypto_server_a_p_i_1_1_crypto_server.html#a6b3cc44e2007ff04a24694a3a1936cfb">EndSession</a> method.<br/>
<br/>
</dd>
<dd>
This method exchanges the session keys in a FIPS compliant way. </dd></dl>

</div>
</div>
<a class="anchor" id="a6b3cc44e2007ff04a24694a3a1936cfb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EndSession </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Keeps a secure messaging session alive and prevents it from expiring after 15 minutes idle time. Terminates a secure messaging session (if any) and frees all resources having been allocated by <a class="el" href="class_crypto_server_a_p_i_1_1_crypto_server.html#adb96cedc9341a1a50436003ac815fa60">PrepareAuthentication</a> and <a class="el" href="class_crypto_server_a_p_i_1_1_crypto_server.html#ac12452d54092c3d2711833ca787ecf04">GetSessionKey</a>.</p>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="class_crypto_server_a_p_i_1_1_crypto_server.html#ac3908b235d93a9664fd8de7fa6fbdcb6">EndAuthentication</a> </dd></dl>

</div>
</div>
<a class="anchor" id="a9f1df259da19fc7c50d304255c7f9946"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Logon </td>
          <td>(</td>
          <td class="paramtype">String^&#160;</td>
          <td class="paramname"><em>user</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">String^&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">String^&#160;</td>
          <td class="paramname"><em>password</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Authenticates a user with signature mechanism to the CryptoServer (see <a class="el" href="class_crypto_server_a_p_i_1_1_crypto_server.html#adb96cedc9341a1a50436003ac815fa60">PrepareAuthentication</a>) and creates an encrypted (secure messaging) session (see <a class="el" href="class_crypto_server_a_p_i_1_1_crypto_server.html#ac12452d54092c3d2711833ca787ecf04">GetSessionKey</a>).</p>
<p>This method can be called multiple times for different users in order to apply a Multi-Persons-Rule.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">user</td><td>Name of user to be authenticated. </td></tr>
    <tr><td class="paramname">key</td><td>Device specifier of signature token:<ul>
<li>smartcard (e.g. ':cs2:cyb:COM3')</li>
<li>key file (e.g. 'D:\secret\MySecret.key'). </li>
</ul>
</td></tr>
    <tr><td class="paramname">password</td><td>Password of key file in case of an encrypted key file.<br/>
 The password should be set to nullptr in case of a plain key file.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="class_crypto_server_a_p_i_1_1_crypto_server.html#adb96cedc9341a1a50436003ac815fa60">PrepareAuthentication</a>(String ^user, String ^key, String ^password) </dd>
<dd>
<a class="el" href="class_crypto_server_a_p_i_1_1_crypto_server.html#a113c38e816b9517b16c21a1c8485323b">GetSessionKey()</a> </dd></dl>

</div>
</div>
<a class="anchor" id="aaff8af35401a1414ca0a4ad31a2de27d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Logon </td>
          <td>(</td>
          <td class="paramtype">String^&#160;</td>
          <td class="paramname"><em>user</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">String^&#160;</td>
          <td class="paramname"><em>password</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Authenticates a user with password mechanism to the CryptoServer (see <a class="el" href="class_crypto_server_a_p_i_1_1_crypto_server.html#adb96cedc9341a1a50436003ac815fa60">PrepareAuthentication</a>) and creates an encrypted (secure messaging) session (see <a class="el" href="class_crypto_server_a_p_i_1_1_crypto_server.html#ac12452d54092c3d2711833ca787ecf04">GetSessionKey</a>).</p>
<p>This method can be called multiple times for different users in order to apply a Multi-Persons-Rule.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">user</td><td>Name of user to be authenticated. </td></tr>
    <tr><td class="paramname">password</td><td>Password of user.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="class_crypto_server_a_p_i_1_1_crypto_server.html#adb96cedc9341a1a50436003ac815fa60">PrepareAuthentication</a>(String ^user, String ^password) </dd>
<dd>
<a class="el" href="class_crypto_server_a_p_i_1_1_crypto_server.html#a113c38e816b9517b16c21a1c8485323b">GetSessionKey()</a> </dd></dl>

</div>
</div>
<a class="anchor" id="a68d510d503cbdd8768fbbcca8949119a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Logoff </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Terminates a session (if any) and frees all resources having been allocated by <a class="el" href="class_crypto_server_a_p_i_1_1_crypto_server.html#adb96cedc9341a1a50436003ac815fa60">PrepareAuthentication</a> and <a class="el" href="class_crypto_server_a_p_i_1_1_crypto_server.html#ac12452d54092c3d2711833ca787ecf04">GetSessionKey</a></p>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="class_crypto_server_a_p_i_1_1_crypto_server.html#a6b3cc44e2007ff04a24694a3a1936cfb">EndSession</a> </dd>
<dd>
<a class="el" href="class_crypto_server_a_p_i_1_1_crypto_server.html#ac3908b235d93a9664fd8de7fa6fbdcb6">EndAuthentication</a> </dd></dl>

</div>
</div>
<a class="anchor" id="a16e082608c2b456eb92f1d0d4ed18099"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int GetAuthState </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Returns the resulting authentication state within the current session.</p>
<p>The state is evaluated as the permission sum of all users having authenticated the current session. </p>

</div>
</div>
<a class="anchor" id="a6bce3b95cf671b7b3b86f24db2586d12"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">array&lt; Byte &gt; Exec </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>sfc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">array&lt; Byte &gt;^&#160;</td>
          <td class="paramname"><em>command</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Sends a command the the CryptoServer and receives the answer.</p>
<p>Executes a command of the CryptoServer. First the command data is send to the CryptoServer. Then the answer from the CryptoServer is received and returned. This method blocks until an answer was received from the CryptoSever or an error occurs.</p>
<p>If authentication was requested (<a class="el" href="class_crypto_server_a_p_i_1_1_crypto_server.html#adb96cedc9341a1a50436003ac815fa60">PrepareAuthentication</a> or <a class="el" href="class_crypto_server_a_p_i_1_1_crypto_server.html#a9f1df259da19fc7c50d304255c7f9946">Logon</a>), the command data send to the CryptoServer is authenticated.</p>
<p>If secure messaging is established for this connection (<a class="el" href="class_crypto_server_a_p_i_1_1_crypto_server.html#ac12452d54092c3d2711833ca787ecf04">GetSessionKey</a> or <a class="el" href="class_crypto_server_a_p_i_1_1_crypto_server.html#a9f1df259da19fc7c50d304255c7f9946">Logon</a>), then the data send to and received from the CryptoServer is encrypted.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fc</td><td>Function Code: Id of the firmware module being adressed. </td></tr>
    <tr><td class="paramname">sfc</td><td>Sub-Function Code: Index of the module function to be called. </td></tr>
    <tr><td class="paramname">command,:</td><td>Data to be sent to the CryptoServer.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Answer received from CryptoServer. </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname"><a class="el" href="class_crypto_server_a_p_i_1_1_crypto_server_exception.html" title="Signals that a CryptoServer exception of some sort has occured.">CryptoServerException</a></td><td>in case of a communication error or an error reported by the CryptoServer. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Property Documentation</h2>
<a class="anchor" id="a4c7a521b8f1a0769c09bfa4a1fca7dab"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">version</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">get</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Version number of the <a class="el" href="class_crypto_server_a_p_i_1_1_crypto_server.html" title="This class implements an interface to Utimaco&#39;s Hardware Security Modul &quot;CryptoServer&quot;.">CryptoServer</a> API (d.d.d.d) </p>

</div>
</div>
<a class="anchor" id="aee145bfca8e9b2eaf3cd3c47157be9a3"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">timeout</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">get</span><span class="mlabel">set</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Read timeout on command execution in milliseconds. </p>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="class_crypto_server_a_p_i_1_1_crypto_server.html#a6bce3b95cf671b7b3b86f24db2586d12">CryptoServer::Exec</a> </dd></dl>

</div>
</div>
<a class="anchor" id="a06a8deb1fddefddb64dede7476cc31d4"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">keepSessionAlive</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">get</span><span class="mlabel">set</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Enables or disables an additional thread that keeps a secure messaging session alive and prevents it from expiring after 15 minutes idle time. </p>

</div>
</div>
<a class="anchor" id="a111944a310c32c89c958ad7813e01c60"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">endSessionOnShutdown</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">get</span><span class="mlabel">set</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Enables or disables an additional event handler that terminates a secure messaging session if the system is shut down. </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Mar 21 2017 18:14:11 for CXI.NET by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.2
</small></address>
</body>
</html>
