<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>CXI: Cryptographic eXtended Interface</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">CXI
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.2 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Cryptographic eXtended Interface </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="content_sec"></a>
Content</h1>
<hr/>
<ul>
<li><a class="el" href="index.html#intro_sec">Introduction</a></li>
<li><a class="el" href="index.html#keystorage_sec">Key Storage</a></li>
<li><a class="el" href="index.html#auth_sec">Authentication</a></li>
<li><a class="el" href="index.html#sm_sec">Secure Messaging</a></li>
<li><a class="el" href="index.html#keyaccess_sec">Key Access Restrictions</a></li>
<li><a class="el" href="index.html#load_balancing_sec">Load Balancing</a></li>
<li><a class="el" href="index.html#failover_sec">Failover</a></li>
<li><a class="el" href="index.html#prog_sec">Programming Interface</a></li>
<li><a class="el" href="index.html#example_sec">Examples</a></li>
<li><a class="el" href="index.html#algo_sec">Supported Algorithms</a></li>
<li><a class="el" href="index.html#install_sec">Installation</a></li>
<li><a class="el" href="index.html#requirements_sec">Requirements</a></li>
<li><a class="el" href="group__history.html">Change History</a></li>
</ul>
<h1><a class="anchor" id="intro_sec"></a>
Introduction</h1>
<hr/>
<p>The CXI API provides an general purpose C++ interface used to access the external functions of the CryptoServer firmware module CXI from an application running on a host.<br/>
 With the CryptoServer API it is possible either to access a CryptoServer plugged in a slot of the local computer or to access a CryptoServer LAN over TCP/IP.<br/>
 The CXI API can use different logical protocols with a variable number of protocol layers to communicate with the CryptoServer.<br/>
 To use this interface the firmware module CXI must be loaded into the CryptoServer and the application must be able to load the specific shared library (cxi.dll / libcxi.so).</p>
<p>The CXI API basically supports two operating modes: </p>
<ul>
<li>
<p class="startli"><b>Dedicated Mode:</b> One instance of CXI represents a logical connection to one CryptoServer.<br/>
 This mode has to be used if a dedicated CryptoServer should be addressed (e.g. for key management).<br/>
</p>
<p class="endli"></p>
</li>
<li>
<b>Cluster Mode:</b> One instance of CXI represents a logical connection to a cluster of CryptoServer.<br/>
 This mode supports a failover mechanism, that automatically switches to another CryptoServer in case of a communication error.<br/>
 The API only returns an error if the communication to all devices failed or if the CryptoServer responds an application error.<br/>
 Additionally, a load balancing mechanism is supported where the devices can be simultaneously used to distribute the connection processing across the clustered devices.<br/>
 </li>
</ul>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="index.html#prog_sec">Programming Interface</a> on how to apply an operating mode.<br/>
</dd></dl>
<p>The CXI API offers various cryptographic services (see <a class="el" href="classcxi_1_1_cxi.html">cxi::Cxi</a>):</p>
<ul>
<li>Construction / Destruction<ul>
<li>create instance that represents a logical connection to a dedicated CryptoServer</li>
<li>create instance that represents a logical connection to a cluster of CryptoServer</li>
<li>create instance based on a configuration file (either dedicated or cluster)</li>
</ul>
</li>
</ul>
<ul>
<li>Basic Functions<ul>
<li>execute arbitrary command on CryptoServer</li>
<li>get version of CXI API and CXI firmware module</li>
</ul>
</li>
</ul>
<ul>
<li>Authentication<ul>
<li>password mechanisms</li>
<li>signature mechanisms (RSA, ECDSA) with smartcard</li>
<li>signature mechanisms (RSA, ECDSA) with (password encrypted) key files</li>
</ul>
</li>
</ul>
<ul>
<li>Key Management<ul>
<li>key generation (DES, AES, RSA, ECDSA, DSA)</li>
<li>import and export of keys</li>
<li>backup and restore of keys</li>
<li>get/set key properties</li>
</ul>
</li>
</ul>
<ul>
<li>Cryptography<ul>
<li>encryption / decryption (DES, AES, RSA, ECIES)</li>
<li>signature generation / verification (ECDSA, RSA)</li>
<li>MAC calculation / verification (DES, AES)</li>
<li>calculation of shared secrets (ECDSA)</li>
<li>generation of random bytes</li>
</ul>
</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>The complete class overview can be found <a href="annotated.html"><b>here</b></a>.</dd></dl>
<p>The CXI API is also available for the programming languages JAVA (CryptoServerCXI.jar) and the dot.NET languages C#, C++ and Basic (cxi.net.dll).</p>
<h1><a class="anchor" id="keystorage_sec"></a>
Key Storage</h1>
<hr/>
<p>Within CXI keys are identified by their key name, key group and key specifier. The key name is mandatory, group and specifier are optional and may be omitted.<br/>
 In either case the combination of name, group and specifier has to be unique.<br/>
</p>
<p>Keys can either be stored on the CryptoServer (internal) or on the host PC (external). On generation or import of keys the application can decide whether to store the key internally or externally.</p>
<p>In case of internal keys the application receives a key handle that links to the key, otherwise, in case of external keys, the application receives a key blob, that contains the key, encrypted with the CryptoServers Master Box Key. CXI offers a key store (see <a class="el" href="classcxi_1_1_key_store.html">cxi::KeyStore</a>) that can be used to store external keys, but the application may also use other storage locations for external keys (e.g. key files).</p>
<p>Any function on the CryptoServer that needs a key as input parameter (e.g. encryption or signature creation), accepts either key handles or key blobs. If a key handle is given the key is loaded from the key database, if a key blob is given the key is decrypted with the Master Box Key. Basically the usage of internal and external keys can be mixed.</p>
<h1><a class="anchor" id="auth_sec"></a>
Authentication</h1>
<hr/>
<p>Any user who wants to execute security relevant commands on the CryptoServer has to authenticate to the CryptoServer. Some commands can either be executed by one user holding the exclusive permissions or by two users with shared permissions (two-person rule). In either case the CryptoServer calculates the resulting permission level, and checks whether the desired command may be executed.</p>
<p>The CryptoServer API supports the following authentication methods:</p>
<ul>
<li><b>RSA Signature and ECDSA Signature</b><br/>
 The command is signed with the private part of the RSA or ECDSA key and the CryptoServer verifies the signature with the public part of the key.<br/>
 The private part of the key (used to create the signature) can be stored on the following media: <ul>
<li>
plaintext key file </li>
<li>
password-encrypted key file </li>
<li>
smartcard (the smartcard reader has to be connected to the host PC)<br/>
  </li>
</ul>
<br/>
 In either case the public part of the key has to be imported into the CryptoServer on creation of the user.</li>
</ul>
<ul>
<li><b>RSA Smartcard</b><br/>
 This method is a special case of RSA Signature, where the smartcard reader (PIN pad) is directly connected to the CryptoServer.</li>
</ul>
<ul>
<li><b>HMAC hashed password</b> Password authentication using a Hash-based Message Authentication Code.<br/>
 This mechanism is recommended and should be preferred to SHA hashed password mechanism.</li>
</ul>
<ul>
<li><b>SHA hashed password</b><br/>
 Password authentication using a SHA hashed password.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>On a cluster of CryptoServer only password authentication is supported (see <a class="el" href="classcxi_1_1_cxi.html#a979e95d677f1eff4a6cb36aef68fa590">cxi::Cxi::logon_pass</a>).</dd></dl>
<p>In order to apply an authentication method a user with the corresponding authentication mechanism is needed. The authentication mechanism has to be assigned on creation of the user and can't be changed later.</p>
<h1><a class="anchor" id="sm_sec"></a>
Secure Messaging</h1>
<hr/>
<p>Instead of authenticating every command, the CryptoServer API allows to create an encrypted 'Secure Messaging' session with the CryptoServer. Thereby the user only authenticates the creation of the session (exchange of the session key). Any command sent through this session will automatically be authenticated with the permission of the user.</p>
<p>A session can be created by using one of the following methods:</p>
<ul>
<li><a class="el" href="classcxi_1_1_cxi.html#ab44adac412254acc636c959ccc91b302">cxi::Cxi::logon_sign</a> <br/>
 Logs on a user with signature mechanism (RSA or ECDSA, smartcard or key file).</li>
</ul>
<ul>
<li><a class="el" href="classcxi_1_1_cxi.html#a979e95d677f1eff4a6cb36aef68fa590">cxi::Cxi::logon_pass</a> <br/>
 Logs on a user with password mechanism</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>If a session remains idle (no command was sent) for more than 15 minutes, the session expires and is automatically invalidated by the CryptoServer.<br/>
 Set the keep_alive parameter of the logon_XXX methods to true to prevent a session from expiration.</dd></dl>
<h1><a class="anchor" id="keyaccess_sec"></a>
Key Access Restrictions</h1>
<hr/>
<p>Any user who wants to access an - internal or external - key has to authenticate to the CryptoServer. The CryptoServer checks on a resulting permission level of 2 in group 0 (mask: 00000002). The necessary permission level of 2 in group 0 can be achieved by either two user with a permission level of one (Two-Persons-Rule) or one user with a permission level of 2.</p>
<p>If a key has been assigned to a group (on key generation or import), it may only be accessed by a user who is member of the same group. Therefore the user attribute 'CXI_GROUP' has to be set on creation of the user. The CXI_GROUP attribute may also contain wildcards '*' or question marks '?' in order to assign a user to multiple groups.<br/>
</p>
<p>Examples:<br/>
 </p>
<ul>
<li>
<p class="startli"><b>User 1: CXI_GROUP=test</b><br/>
 This user may only access keys with the group attribute 'test', other keys are 'invisible' for the user.<br/>
</p>
<p class="endli"></p>
</li>
<li>
<p class="startli"><b>User 2: CXI_GROUP=test*</b><br/>
 This user may only access whose entity attributes start with 'test' (e.g. 'test', 'test01', 'test_xxx'), other keys are 'invisible' for the user.<br/>
</p>
<p class="endli"></p>
</li>
<li>
<p class="startli"><b>User 3: CXI_GROUP=*</b><br/>
 This user is allowed to access all keys.<br/>
</p>
<p class="endli"></p>
</li>
</ul>
<p>If no group attribute has been set for a key, the key may be accessed by all users regardless of their group membership.</p>
<h1><a class="anchor" id="load_balancing_sec"></a>
Load Balancing</h1>
<hr/>
<p>In a load balancing cluster the CryptoServer devices are configured to optimize the use of resources to reach higher system performance, and to avoid overloading a single device. All CryptoServer in the cluster must be configured identically. A new connection is always established to the CryptoServer with the least number of existing connections. In case of communication errors the API automatically switches to the next device and tries to execute the command on that CryptoServer. Only if the API wasn't able to execute the command on any device, it gives up and throws an exception.<br/>
</p>
<h1><a class="anchor" id="failover_sec"></a>
Failover</h1>
<hr/>
<p>CXI provides fault tolerant operation on a CryptoServer cluster. In case of communication errors the API automatically switches to the next device and tries to execute the command on that CryptoServer. Only if the API wasn't able to execute the command on any device, it gives up and throws an exception.<br/>
</p>
<p>After having successfully switched to another device the API basically stays connected with this device and does not switch back. Optionally, a fallback interval may be configured that causes the API to switch back to the first (primary) device of the device list.<br/>
</p>
<h1><a class="anchor" id="prog_sec"></a>
Programming Interface</h1>
<hr/>
 In order to use the CXI API the file 'cxi.h' has to be included and the application has to be linked against the CXI library file.<br/>
 The API consists of its main class CXI and several other classes that are needed to handle with objects (e.g. keys, properties, configuration).<br/>
</p>
<p>The complete class overview can be found <a href="annotated.html"><b>here</b></a></p>
<p>CXI offers three constructors to be used for different purposes: </p>
<ul>
<li>
<p class="startli"><b><a class="el" href="classcxi_1_1_cxi.html#a5dd2d4f8f1c30c228793996f4c23952b">cxi::Cxi::Cxi(char *device, int timeout, int ctimeout)</a> </b><br/>
 Opens the specified CryptoServer with the given connect and command timeouts. Use this constructor if you want to use a single device exclusively.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli"><b><a class="el" href="classcxi_1_1_cxi.html#ac019ec536635215ed77f06fd12e48c1e">cxi::Cxi::Cxi(char **devices, int ndevs, int timeout, int ctimeout, int fallback_interval)</a> </b><br/>
 Opens multiple CryptoServer as a cluster. Use this constructor if you want to set up a fault-tolerant system that supports failover.</p>
<p class="endli"></p>
</li>
<li>
<b><a class="el" href="classcxi_1_1_cxi.html#ad06fb5c45abd46c4b821131384d52ba0">cxi::Cxi::Cxi(Config &amp;config)</a> </b><br/>
 Reads the device configuration from the given configuration file. Here you can either configure a single device (e.g. 'Device = PCI:0') or multiple devices as a cluster<br/>
 (e.g. 'Device = PCI:0 192.168.4.1 192.168.4.2') </li>
</ul>
<dl class="section note"><dt>Note</dt><dd><b>Don't use cluster mode if a dedicated CryptoServer should be addressed!</b></dd></dl>
<h1><a class="anchor" id="example_sec"></a>
Examples</h1>
<hr/>
<p>The following code illustrates how to manage keys on a single device: </p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;cxi.h&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="keyword">using namespace </span>cxi;</div>
<div class="line"></div>
<div class="line">printf(<span class="stringliteral">&quot;CXI library version: %08x\n&quot;</span>, <a class="code" href="classcxi_1_1_cxi.html#a2c00593236091bfa52ac43683dddbd9e">Cxi::get_version</a>());</div>
<div class="line"></div>
<div class="line"><a class="code" href="classcxi_1_1_cxi.html" title="Command interface to CXI firmware module. Handles all communication with the CryptoServer.">Cxi</a> *cxi = NULL;</div>
<div class="line"></div>
<div class="line"><span class="keywordflow">try</span></div>
<div class="line">{</div>
<div class="line">  <span class="comment">// init logging </span></div>
<div class="line">  <a class="code" href="classcxi_1_1_log.html" title="Provides unified logging.">Log</a> &amp;log = <a class="code" href="classcxi_1_1_log.html#a847717d2333a9fa528235190a7f0346f">Log::getInstance</a>();</div>
<div class="line">  log.<a class="code" href="classcxi_1_1_log.html#a42d901eb29cd0d8fbf9a8f9a02fbce33">init</a>(<span class="stringliteral">&quot;./cxi.log&quot;</span>, <a class="code" href="classcxi_1_1_log.html#aa3af05317f417ad2e5485d889aa2c053a2c5e7c66e41be7a8f0fcfb4f81a12c4a" title="log errors and warnings">Log::LEVEL_WARNING</a>, 1000000); </div>
<div class="line"></div>
<div class="line">  <span class="comment">// open CryptoServer PCI</span></div>
<div class="line">  cxi = <span class="keyword">new</span> <a class="code" href="classcxi_1_1_cxi.html" title="Command interface to CXI firmware module. Handles all communication with the CryptoServer.">Cxi</a>(<span class="stringliteral">&quot;PCI:0&quot;</span>, 20000, 5000);</div>
<div class="line"></div>
<div class="line">  <span class="comment">// logon a user with smartcard based signature authentication mechanism</span></div>
<div class="line">  cxi-&gt;logon_sign(<span class="stringliteral">&quot;SO1&quot;</span>, <span class="stringliteral">&quot;:cs2:cyb:COM3&quot;</span>, NULL);</div>
<div class="line">  </div>
<div class="line">  <span class="comment">// logon a second user with key file based signature authentication mechanism</span></div>
<div class="line">  cxi-&gt;logon_sign(<span class="stringliteral">&quot;SO2&quot;</span>, <span class="stringliteral">&quot;so01_rsa.key&quot;</span>, <span class="stringliteral">&quot;mypass&quot;</span>);</div>
<div class="line"></div>
<div class="line">  <span class="comment">// create a key</span></div>
<div class="line">  <a class="code" href="classcxi_1_1_property_list.html" title="Constructs and parses key property lists, see Key Properties.">PropertyList</a> keyTemplate; </div>
<div class="line">  keyTemplate.<a class="code" href="classcxi_1_1_property_list.html#aa8d0e82b5457dbbf75adbc23378c22c0">setAlgo</a>(<a class="code" href="group__cxi__algos.html#gab39590bbb344830c32ce8889aa73bbce" title="AES.">CXI_KEY_ALGO_AES</a>);</div>
<div class="line">  keyTemplate.<a class="code" href="classcxi_1_1_property_list.html#a72020e2e3721c814d7a5ff1dac539484">setSize</a>(256); </div>
<div class="line">  keyTemplate.<a class="code" href="classcxi_1_1_property_list.html#ab3a256e7d9fad73fa57de7c1fedf51c5">setName</a>(<span class="stringliteral">&quot;AES test key&quot;</span>);</div>
<div class="line"></div>
<div class="line">  <a class="code" href="classcxi_1_1_key.html" title="Encapsulates key handles or key blobs of type &#39;Backup Blob&#39;, see Format of Key Blobs.">Key</a> aesKey = cxi-&gt;key_generate(<a class="code" href="group__cxi__flags.html#ga4e7e1d2397745c8a7024496ba451a64e" title="Overwrite key if already existing.">CXI_FLAG_KEY_OVERWRITE</a>, keyTemplate);</div>
<div class="line">}</div>
<div class="line"><span class="keywordflow">catch</span> (<a class="code" href="classcxi_1_1_exception.html" title="Constructs an exception object.">Exception</a> &amp;ex) </div>
<div class="line">{</div>
<div class="line">  printf(<span class="stringliteral">&quot;%sat %s\n&quot;</span>, ex.<a class="code" href="classcxi_1_1_exception.html#a6472a0f347efd3e832db2b9f028d31a5" title="plain text error message">err_str</a>, ex.<a class="code" href="classcxi_1_1_exception.html#abfc63678afc880a87fc97e9da26bbc36" title="name of function where error occurs">where</a>);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">// delete Cxi object</span></div>
<div class="line"><span class="keyword">delete</span> cxi;</div>
</div><!-- fragment --><p>The following code illustrates how to use cryptographic functions on a cluster of devices: </p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;cxi.h&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="keyword">using namespace </span>cxi;</div>
<div class="line"></div>
<div class="line"><a class="code" href="classcxi_1_1_cxi.html" title="Command interface to CXI firmware module. Handles all communication with the CryptoServer.">Cxi</a> *cxi = NULL;</div>
<div class="line"></div>
<div class="line"><span class="keywordflow">try</span></div>
<div class="line">{</div>
<div class="line">  <span class="comment">// create configuration object</span></div>
<div class="line">  <a class="code" href="classcxi_1_1_config.html" title="Reads and parses configuration files and provides methods to access configuration items...">Config</a> config = <a class="code" href="classcxi_1_1_config.html" title="Reads and parses configuration files and provides methods to access configuration items...">Config</a>(<span class="stringliteral">&quot;./cxi.cfg&quot;</span>);</div>
<div class="line">  </div>
<div class="line">  <span class="comment">// create new Cxi object with the given configuration</span></div>
<div class="line">  cxi = <span class="keyword">new</span> <a class="code" href="classcxi_1_1_cxi.html" title="Command interface to CXI firmware module. Handles all communication with the CryptoServer.">Cxi</a>(config);</div>
<div class="line"></div>
<div class="line">  <span class="comment">// logon a user with password mechanism</span></div>
<div class="line">  cxi-&gt;logon_pass(<span class="stringliteral">&quot;USER&quot;</span>, <span class="stringliteral">&quot;swordfish&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line"></div>
<div class="line">  <span class="comment">// open previously generated AES key</span></div>
<div class="line">  <a class="code" href="classcxi_1_1_property_list.html" title="Constructs and parses key property lists, see Key Properties.">PropertyList</a> keyTemplate;</div>
<div class="line">  keyTemplate.<a class="code" href="classcxi_1_1_property_list.html#ab3a256e7d9fad73fa57de7c1fedf51c5">setName</a>(<span class="stringliteral">&quot;AES test key&quot;</span>);</div>
<div class="line">  </div>
<div class="line">  <a class="code" href="classcxi_1_1_key.html" title="Encapsulates key handles or key blobs of type &#39;Backup Blob&#39;, see Format of Key Blobs.">Key</a> aesKey = cxi-&gt;key_open(CXI_KEY_FLAG_EXTERNAL, keyTemplate);</div>
<div class="line">  </div>
<div class="line">  <span class="comment">// encrypt data with the key</span></div>
<div class="line">  <a class="code" href="classcxi_1_1_mechanism_parameter.html" title="Constructs mechanism parameter that are used on cryptographic operations. A mechanism parameter consi...">MechanismParameter</a> mechParam = <a class="code" href="classcxi_1_1_mechanism_parameter.html" title="Constructs mechanism parameter that are used on cryptographic operations. A mechanism parameter consi...">MechanismParameter</a>(<a class="code" href="group__cxi__mech__mode.html#ga60376ba8a71aced951fd917fa6eab246" title="Encryption mode.">CXI_MECH_MODE_ENCRYPT</a>|<a class="code" href="group__cxi__mech__chain.html#ga966de78e6158c4e34dc61b4f8269b428" title="Cipher Block Chaining.">CXI_MECH_CHAIN_CBC</a>|<a class="code" href="group__cxi__mech__pad.html#ga4da20cf7e8b419b3309be845d84bde56" title="Don’t apply padding.">CXI_MECH_PAD_NONE</a>); </div>
<div class="line">  <a class="code" href="classcxi_1_1_byte_array.html" title="Encapsulates an array of primitive type char in an object and provides methods to operate on binary d...">ByteArray</a> data = <a class="code" href="classcxi_1_1_byte_array.html" title="Encapsulates an array of primitive type char in an object and provides methods to operate on binary d...">ByteArray</a>(<span class="stringliteral">&quot;Change, we can believe in&quot;</span>);</div>
<div class="line">  <a class="code" href="classcxi_1_1_byte_array.html" title="Encapsulates an array of primitive type char in an object and provides methods to operate on binary d...">ByteArray</a> crypt = cxi-&gt;crypt(0, aesKey, mechParam, data); </div>
<div class="line">}</div>
<div class="line"><span class="keywordflow">catch</span> (<a class="code" href="classcxi_1_1_exception.html" title="Constructs an exception object.">Exception</a> &amp;ex) </div>
<div class="line">{</div>
<div class="line">  printf(<span class="stringliteral">&quot;%sat %s\n&quot;</span>, ex.<a class="code" href="classcxi_1_1_exception.html#a6472a0f347efd3e832db2b9f028d31a5" title="plain text error message">err_str</a>, ex.<a class="code" href="classcxi_1_1_exception.html#abfc63678afc880a87fc97e9da26bbc36" title="name of function where error occurs">where</a>);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">// delete Cxi object</span></div>
<div class="line"><span class="keyword">delete</span> cxi; </div>
</div><!-- fragment --><h1><a class="anchor" id="algo_sec"></a>
Supported Algorithms</h1>
<hr/>
<p>The CXI firmware module supports the following algorithms and mechanisms: </p>
<table  class="doxtable">
<tr>
<th>Algorithm </th><th>Key Sizes [bit] </th><th>Mode </th><th>Chaining </th><th>Padding  </th></tr>
<tr>
<td rowspan="2">DES </td><td rowspan="2">56,112,168 </td><td>Encryption, Decryption </td><td>ECB, CBC </td><td>None, PKCS#5, ISO7816, Random  </td></tr>
<tr>
<td>Mac </td><td>CBC, CBC-Retail, CFB-Retail </td><td>None, Zero, PKCS#5, ISO7816, Random  </td></tr>
<tr>
<td rowspan="2">AES </td><td rowspan="2">128,192,256 </td><td>Encryption, Decryption </td><td>ECB, CBC, GCM, OFB, CCM </td><td>None, PKCS#5, ISO7816, Random  </td></tr>
<tr>
<td>Mac </td><td>CBC, GMAC, CMAC </td><td>None, Zero, PKCS#5, ISO7816, Random  </td></tr>
<tr>
<td rowspan="2">RSA </td><td rowspan="2">512...16384 (delta = 1bit) </td><td>Encryption, Decryption </td><td>- </td><td>None, PKCS#1, PKCS-OAEP  </td></tr>
<tr>
<td>Sign, Verify </td><td>- </td><td>PKCS#1, X9.31, PKCS-PSS  </td></tr>
<tr>
<td rowspan="2">ECDSA </td><td rowspan="2">Brainpool: 160..512<br/>
 NIST: 192..521<br/>
 secp: 112..571  </td><td>Encryption, Decryption<br/>
 (ECIES) </td><td>- </td><td>-  </td></tr>
<tr>
<td>Sign, Verify<br/>
 (Raw Format, ASN.1 Format) </td><td>- </td><td>-  </td></tr>
<tr>
<td>DSA </td><td>P: 512..1024, Q: 160 </td><td>Sign, Verify </td><td>- </td><td>-  </td></tr>
</table>
<p>The following hash algorithms are supported: </p>
<ul>
<li>
SHA1 </li>
<li>
SHA224 </li>
<li>
SHA256 </li>
<li>
SHA384 </li>
<li>
SHA512 </li>
<li>
SHA3-224 </li>
<li>
SHA3-256 </li>
<li>
SHA3-384 </li>
<li>
SHA3-512 </li>
<li>
MD5 </li>
<li>
RipeMD160 </li>
</ul>
<h1><a class="anchor" id="install_sec"></a>
Installation</h1>
<hr/>
<h2><a class="anchor" id="step1"></a>
Step 1:</h2>
<p>Load the firmware module package (e.g. SecurityServer-XX-Series-x.x.x.mpkg) into the CryptoServer.<br/>
<br/>
 Example:<br/>
 csadm &lt;authentication&gt; LoadPKG=SecurityServer-CS-Series-2.21.5.mpkg<br/>
</p>
<h2><a class="anchor" id="step2"></a>
Step 2:</h2>
<p>Create one or more users with authentication mechanism either HMAC-password or signature (RSA, ECDSA) and the following properties:<br/>
</p>
<ul>
<li>permission of level 2 in group 0 ('00000002').<br/>
</li>
<li>flags 'secure messaging with authentication' ('sma').<br/>
</li>
<li>attribute 'CXI_GROUP=&lt;key-group&gt;', where 'key-group' represents the group of keys the user will be allowed to access.<br/>
 Use wildcards ('*', '?') to assign a user to multiple groups.<br/>
<br/>
 Example:<br/>
 csadm &lt;authentication&gt; AddUserHMACPwd=CXI,00000002{CXI_GROUP=test*},sma,&lt;password&gt;<br/>
</li>
</ul>
<h1><a class="anchor" id="requirements_sec"></a>
Requirements</h1>
<hr/>
<h2><a class="anchor" id="vcredist"></a>
Microsoft Visual C++ SP1 redistributable package</h2>
<p>On Microsoft Windows the CXI API requires the redistributable package runtime library to be installed. It is required to run applications developed with Visual C++ 2008 SP1 on a PC that have no Visual C++ 2008 SP1 installed. The package is automatically installed on installation of the Utimaco CryptoServer Product CD, but it also can be obtained from the Microsoft websites (a version for 32 bit and 64 bit is available). </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Mar 21 2017 18:12:35 for CXI by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.2
</small></address>
</body>
</html>
