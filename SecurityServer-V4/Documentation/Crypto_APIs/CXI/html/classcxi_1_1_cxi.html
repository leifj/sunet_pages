<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>CXI: Cxi Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">CXI
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.2 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><b>cxi</b></li><li class="navelem"><a class="el" href="classcxi_1_1_cxi.html">Cxi</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="classcxi_1_1_cxi-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">Cxi Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Command interface to CXI firmware module. Handles all communication with the CryptoServer.  
 <a href="classcxi_1_1_cxi.html#details">More...</a></p>

<p>Inherited by Cxx.</p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structcxi_1_1_cxi_1_1_c_l_u_s_t_e_r___e_r_r_o_r.html">CLUSTER_ERROR</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Defines an additional error code/mask that causes the cluster to switch to another device instead of returning to the caller.  <a href="structcxi_1_1_cxi_1_1_c_l_u_s_t_e_r___e_r_r_o_r.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="member-group"></a>
Construction / Destruction</h2></td></tr>
<tr class="memitem:a5dd2d4f8f1c30c228793996f4c23952b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcxi_1_1_cxi.html#a5dd2d4f8f1c30c228793996f4c23952b">Cxi</a> (char *device, int timeout=60000, int ctimeout=5000)</td></tr>
<tr class="separator:a5dd2d4f8f1c30c228793996f4c23952b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac019ec536635215ed77f06fd12e48c1e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcxi_1_1_cxi.html#ac019ec536635215ed77f06fd12e48c1e">Cxi</a> (char **devices, int ndevs, int timeout=60000, int ctimeout=5000, int fallback_interval=0)</td></tr>
<tr class="separator:ac019ec536635215ed77f06fd12e48c1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a449d5ff24a70006e8f9eaa23de5c037a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcxi_1_1_cxi.html#a449d5ff24a70006e8f9eaa23de5c037a">Cxi</a> (std::vector&lt; std::string &gt; devices, int timeout=60000, int ctimeout=5000, int fallback_interval=0)</td></tr>
<tr class="separator:a449d5ff24a70006e8f9eaa23de5c037a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad06fb5c45abd46c4b821131384d52ba0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcxi_1_1_cxi.html#ad06fb5c45abd46c4b821131384d52ba0">Cxi</a> (<a class="el" href="classcxi_1_1_config.html">Config</a> &amp;config)</td></tr>
<tr class="separator:ad06fb5c45abd46c4b821131384d52ba0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af560e4e9b18f6b7120324bab50c036bf"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcxi_1_1_cxi.html#af560e4e9b18f6b7120324bab50c036bf">~Cxi</a> (void)</td></tr>
<tr class="separator:af560e4e9b18f6b7120324bab50c036bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="member-group"></a>
Miscellaneous Functions</h2></td></tr>
<tr class="memitem:ad98220ac29eb9571be2817a8d8d3a32d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcxi_1_1_cxi.html#ad98220ac29eb9571be2817a8d8d3a32d">exec</a> (unsigned int fc, unsigned int sfc, unsigned char *p_cmd, unsigned int l_cmd, unsigned char **pp_answ, unsigned int *p_l_answ, <a class="el" href="structcxi_1_1_cxi_1_1_c_l_u_s_t_e_r___e_r_r_o_r.html">CLUSTER_ERROR</a> *errlist=NULL, unsigned int err_ct=0)</td></tr>
<tr class="separator:ad98220ac29eb9571be2817a8d8d3a32d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a50e1e01b60aa88d420c2246c7be82346"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcxi_1_1_cxi.html#a50e1e01b60aa88d420c2246c7be82346">free_answ</a> (unsigned char *p_answ)</td></tr>
<tr class="separator:a50e1e01b60aa88d420c2246c7be82346"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a19699ea81c1d2f40c31fdd671f9ece78"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcxi_1_1_cxi.html#a19699ea81c1d2f40c31fdd671f9ece78">get_fw_version</a> (void)</td></tr>
<tr class="separator:a19699ea81c1d2f40c31fdd671f9ece78"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c00593236091bfa52ac43683dddbd9e"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcxi_1_1_cxi.html#a2c00593236091bfa52ac43683dddbd9e">get_version</a> (void)</td></tr>
<tr class="separator:a2c00593236091bfa52ac43683dddbd9e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="member-group"></a>
Authentication</h2></td></tr>
<tr class="memitem:ab44adac412254acc636c959ccc91b302"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcxi_1_1_cxi.html#ab44adac412254acc636c959ccc91b302">logon_sign</a> (char *user, char *key, char *password=0, bool keep_alive=false)</td></tr>
<tr class="separator:ab44adac412254acc636c959ccc91b302"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a979e95d677f1eff4a6cb36aef68fa590"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcxi_1_1_cxi.html#a979e95d677f1eff4a6cb36aef68fa590">logon_pass</a> (char *user, char *password, bool keep_alive=false)</td></tr>
<tr class="separator:a979e95d677f1eff4a6cb36aef68fa590"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e634a337fa6b8a7d9921e419fc2991a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcxi_1_1_cxi.html#a2e634a337fa6b8a7d9921e419fc2991a">logoff</a> (void)</td></tr>
<tr class="separator:a2e634a337fa6b8a7d9921e419fc2991a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a229f92a7dce2975e2b941a717e39a143"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcxi_1_1_cxi.html#a229f92a7dce2975e2b941a717e39a143">get_auth_state</a> (void)</td></tr>
<tr class="separator:a229f92a7dce2975e2b941a717e39a143"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="member-group"></a>
Key Management</h2></td></tr>
<tr class="memitem:a446ca60bc97ff5d1e7665676ed62a3cd"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classcxi_1_1_key_list.html">KeyList</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcxi_1_1_cxi.html#a446ca60bc97ff5d1e7665676ed62a3cd">key_list</a> (<a class="el" href="classcxi_1_1_property_list.html">PropertyList</a> &amp;keyTemplate=NULL_REF(<a class="el" href="classcxi_1_1_property_list.html">PropertyList</a>))</td></tr>
<tr class="separator:a446ca60bc97ff5d1e7665676ed62a3cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a063ad47b7b9682361af1c25af09a7ed6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classcxi_1_1_key.html">Key</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcxi_1_1_cxi.html#a063ad47b7b9682361af1c25af09a7ed6">key_generate</a> (int flags, <a class="el" href="classcxi_1_1_property_list.html">PropertyList</a> &amp;keyTemplate, int mech=-1)</td></tr>
<tr class="separator:a063ad47b7b9682361af1c25af09a7ed6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1bc1c645bc41fcdcad1f7ca1ecb5f669"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classcxi_1_1_key.html">Key</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcxi_1_1_cxi.html#a1bc1c645bc41fcdcad1f7ca1ecb5f669">key_open</a> (int flags, <a class="el" href="classcxi_1_1_property_list.html">PropertyList</a> &amp;keyTemplate)</td></tr>
<tr class="separator:a1bc1c645bc41fcdcad1f7ca1ecb5f669"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afbd6b562f308fb09c9142cfd24645599"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcxi_1_1_cxi.html#afbd6b562f308fb09c9142cfd24645599">key_delete</a> (<a class="el" href="classcxi_1_1_property_list.html">PropertyList</a> &amp;keyTemplate)</td></tr>
<tr class="separator:afbd6b562f308fb09c9142cfd24645599"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a65f03a133f7ae8f4575fafc4d42744cc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcxi_1_1_cxi.html#a65f03a133f7ae8f4575fafc4d42744cc">key_delete</a> (<a class="el" href="classcxi_1_1_key.html">Key</a> &amp;key)</td></tr>
<tr class="separator:a65f03a133f7ae8f4575fafc4d42744cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa236ca70a4d8d0fe4d60284e12962bac"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classcxi_1_1_property_list.html">PropertyList</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcxi_1_1_cxi.html#aa236ca70a4d8d0fe4d60284e12962bac">key_prop_get</a> (<a class="el" href="classcxi_1_1_key.html">Key</a> &amp;key, int properties[], int nprops)</td></tr>
<tr class="separator:aa236ca70a4d8d0fe4d60284e12962bac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac08ca859db31def5ab876bad782f975f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classcxi_1_1_key.html">Key</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcxi_1_1_cxi.html#ac08ca859db31def5ab876bad782f975f">key_prop_set</a> (<a class="el" href="classcxi_1_1_key.html">Key</a> &amp;key, <a class="el" href="classcxi_1_1_property_list.html">PropertyList</a> &amp;propList)</td></tr>
<tr class="separator:ac08ca859db31def5ab876bad782f975f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac1a13557e155e9c737354c7531fe3cdb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classcxi_1_1_byte_array.html">ByteArray</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcxi_1_1_cxi.html#ac1a13557e155e9c737354c7531fe3cdb">key_export</a> (int type, <a class="el" href="classcxi_1_1_key.html">Key</a> &amp;key, <a class="el" href="classcxi_1_1_key.html">Key</a> &amp;exportKey, int mech=-1)</td></tr>
<tr class="separator:ac1a13557e155e9c737354c7531fe3cdb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad519612c629ad949006f832be416ebd"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classcxi_1_1_key.html">Key</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcxi_1_1_cxi.html#aad519612c629ad949006f832be416ebd">key_import</a> (int flags, int type, <a class="el" href="classcxi_1_1_property_list.html">PropertyList</a> &amp;keyTemplate, <a class="el" href="classcxi_1_1_byte_array.html">ByteArray</a> &amp;keyBlob, <a class="el" href="classcxi_1_1_key.html">Key</a> &amp;importKey, int mech=-1)</td></tr>
<tr class="separator:aad519612c629ad949006f832be416ebd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec6aec91d75b772ea77cf3744d4c6a67"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classcxi_1_1_property_list.html">PropertyList</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcxi_1_1_cxi.html#aec6aec91d75b772ea77cf3744d4c6a67">key_dsa_xgen</a> (int psize, int qsize=160, int mech=-1)</td></tr>
<tr class="separator:aec6aec91d75b772ea77cf3744d4c6a67"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab10cd7e28c064e048ceab7325551490f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classcxi_1_1_property_list.html">PropertyList</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcxi_1_1_cxi.html#ab10cd7e28c064e048ceab7325551490f">key_dsa_pqgen</a> (<a class="el" href="classcxi_1_1_mechanism_parameter.html">MechanismParameter</a> &amp;mechParam)</td></tr>
<tr class="separator:ab10cd7e28c064e048ceab7325551490f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaac8a4fa0048f94620759628359905c0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classcxi_1_1_property_list.html">PropertyList</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcxi_1_1_cxi.html#aaac8a4fa0048f94620759628359905c0">key_dsa_ggen</a> (<a class="el" href="classcxi_1_1_property_list.html">PropertyList</a> &amp;propList, <a class="el" href="classcxi_1_1_mechanism_parameter.html">MechanismParameter</a> &amp;mechParam)</td></tr>
<tr class="separator:aaac8a4fa0048f94620759628359905c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af67dcccc3667f54abb9b31ae6902433e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classcxi_1_1_key.html">Key</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcxi_1_1_cxi.html#af67dcccc3667f54abb9b31ae6902433e">key_backup</a> (<a class="el" href="classcxi_1_1_key.html">Key</a> &amp;key)</td></tr>
<tr class="separator:af67dcccc3667f54abb9b31ae6902433e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a676b3f676b535f6bc81e024c0b4220e2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classcxi_1_1_key.html">Key</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcxi_1_1_cxi.html#a676b3f676b535f6bc81e024c0b4220e2">key_restore</a> (int flags, <a class="el" href="classcxi_1_1_key.html">Key</a> &amp;key, <a class="el" href="classcxi_1_1_property_list.html">PropertyList</a> &amp;keyTemplate=NULL_REF(<a class="el" href="classcxi_1_1_property_list.html">PropertyList</a>))</td></tr>
<tr class="separator:a676b3f676b535f6bc81e024c0b4220e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="member-group"></a>
Key Management (deprecated)</h2></td></tr>
<tr class="memitem:a76a9dce5b9867f0f146cba6c7db704c9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classcxi_1_1_key.html">Key</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcxi_1_1_cxi.html#a76a9dce5b9867f0f146cba6c7db704c9">key_create</a> (int flags, <a class="el" href="classcxi_1_1_property_list.html">PropertyList</a> &amp;keyTemplate, int mech=-1)</td></tr>
<tr class="separator:a76a9dce5b9867f0f146cba6c7db704c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ca2fcd7555e0c4e25ba2b36830cfdda"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classcxi_1_1_key.html">Key</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcxi_1_1_cxi.html#a6ca2fcd7555e0c4e25ba2b36830cfdda">key_open</a> (<a class="el" href="classcxi_1_1_property_list.html">PropertyList</a> &amp;keyTemplate)</td></tr>
<tr class="separator:a6ca2fcd7555e0c4e25ba2b36830cfdda"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="member-group"></a>
Cryptography</h2></td></tr>
<tr class="memitem:a7aa786ac35603292ab4aefc9c9dfde5c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classcxi_1_1_byte_array.html">ByteArray</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcxi_1_1_cxi.html#a7aa786ac35603292ab4aefc9c9dfde5c">crypt</a> (int flags, <a class="el" href="classcxi_1_1_key.html">Key</a> &amp;key, const <a class="el" href="classcxi_1_1_mechanism_parameter.html">MechanismParameter</a> &amp;mechParam, const <a class="el" href="classcxi_1_1_byte_array.html">ByteArray</a> &amp;data, <a class="el" href="classcxi_1_1_byte_array.html">ByteArray</a> &amp;iv=NULL_REF(<a class="el" href="classcxi_1_1_byte_array.html">ByteArray</a>), <a class="el" href="classcxi_1_1_byte_array.html">ByteArray</a> &amp;tag=NULL_REF(<a class="el" href="classcxi_1_1_byte_array.html">ByteArray</a>), const <a class="el" href="classcxi_1_1_byte_array.html">ByteArray</a> &amp;tag_in=NULL_REF(<a class="el" href="classcxi_1_1_byte_array.html">ByteArray</a>))</td></tr>
<tr class="separator:a7aa786ac35603292ab4aefc9c9dfde5c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad0bae61fa0ec7b8a1d2967bb8677cec"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aad0bae61fa0ec7b8a1d2967bb8677cec"></a>
unsigned int&#160;</td><td class="memItemRight" valign="bottom"><b>getBufferedDataSize</b> (const <a class="el" href="classcxi_1_1_byte_array.html">ByteArray</a> &amp;iv)</td></tr>
<tr class="separator:aad0bae61fa0ec7b8a1d2967bb8677cec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a008783fee629bbc4ba279540cb2d2a09"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="classcxi_1_1_byte_array.html">ByteArray</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcxi_1_1_cxi.html#a008783fee629bbc4ba279540cb2d2a09">bulk_crypt</a> (<a class="el" href="classcxi_1_1_key.html">Key</a> &amp;key, const <a class="el" href="classcxi_1_1_mechanism_parameter.html">MechanismParameter</a> &amp;mechParam, const std::vector&lt; <a class="el" href="classcxi_1_1_byte_array.html">ByteArray</a> &gt; &amp;data)</td></tr>
<tr class="separator:a008783fee629bbc4ba279540cb2d2a09"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a36b96d576073b1fc7d97169f40530fef"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classcxi_1_1_byte_array.html">ByteArray</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcxi_1_1_cxi.html#a36b96d576073b1fc7d97169f40530fef">sign</a> (int flags, <a class="el" href="classcxi_1_1_key.html">Key</a> &amp;key, const <a class="el" href="classcxi_1_1_mechanism_parameter.html">MechanismParameter</a> &amp;mechParam, const <a class="el" href="classcxi_1_1_byte_array.html">ByteArray</a> &amp;data, <a class="el" href="classcxi_1_1_byte_array.html">ByteArray</a> &amp;iv=NULL_REF(<a class="el" href="classcxi_1_1_byte_array.html">ByteArray</a>))</td></tr>
<tr class="separator:a36b96d576073b1fc7d97169f40530fef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac876fa351943b494ebb5af693024ad38"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="classcxi_1_1_byte_array.html">ByteArray</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcxi_1_1_cxi.html#ac876fa351943b494ebb5af693024ad38">bulk_sign</a> (<a class="el" href="classcxi_1_1_key.html">Key</a> &amp;key, const <a class="el" href="classcxi_1_1_mechanism_parameter.html">MechanismParameter</a> &amp;mechParam, const std::vector&lt; <a class="el" href="classcxi_1_1_byte_array.html">ByteArray</a> &gt; &amp;data)</td></tr>
<tr class="separator:ac876fa351943b494ebb5af693024ad38"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adf47e1a7fc3bb211009cdf3be5e7cbeb"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcxi_1_1_cxi.html#adf47e1a7fc3bb211009cdf3be5e7cbeb">verify</a> (int flags, <a class="el" href="classcxi_1_1_key.html">Key</a> &amp;key, const <a class="el" href="classcxi_1_1_mechanism_parameter.html">MechanismParameter</a> &amp;mechParam, <a class="el" href="classcxi_1_1_byte_array.html">ByteArray</a> &amp;data, const <a class="el" href="classcxi_1_1_byte_array.html">ByteArray</a> &amp;signature, <a class="el" href="classcxi_1_1_byte_array.html">ByteArray</a> &amp;iv=NULL_REF(<a class="el" href="classcxi_1_1_byte_array.html">ByteArray</a>))</td></tr>
<tr class="separator:adf47e1a7fc3bb211009cdf3be5e7cbeb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa633feee24c18e738b0ebe1f75fa60dd"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classcxi_1_1_byte_array.html">ByteArray</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcxi_1_1_cxi.html#aa633feee24c18e738b0ebe1f75fa60dd">rnd_gen</a> (int len, int mech=-1)</td></tr>
<tr class="separator:aa633feee24c18e738b0ebe1f75fa60dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b70e9293a6ede7a494cacf4d13a0072"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classcxi_1_1_byte_array.html">ByteArray</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcxi_1_1_cxi.html#a6b70e9293a6ede7a494cacf4d13a0072">hash_compute</a> (int flags, <a class="el" href="classcxi_1_1_mechanism_parameter.html">MechanismParameter</a> &amp;mechParam, <a class="el" href="classcxi_1_1_byte_array.html">ByteArray</a> &amp;data, <a class="el" href="classcxi_1_1_byte_array.html">ByteArray</a> &amp;info=NULL_REF(<a class="el" href="classcxi_1_1_byte_array.html">ByteArray</a>), <a class="el" href="classcxi_1_1_key.html">Key</a> &amp;key=NULL_REF(<a class="el" href="classcxi_1_1_key.html">Key</a>))</td></tr>
<tr class="separator:a6b70e9293a6ede7a494cacf4d13a0072"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a13632fb9601103b404da667112daf0a6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classcxi_1_1_byte_array.html">ByteArray</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcxi_1_1_cxi.html#a13632fb9601103b404da667112daf0a6">secret_agree</a> (int flags, <a class="el" href="classcxi_1_1_key.html">Key</a> &amp;privateKey, <a class="el" href="classcxi_1_1_key.html">Key</a> &amp;publicKey, <a class="el" href="classcxi_1_1_mechanism_parameter.html">MechanismParameter</a> &amp;mechParam=NULL_REF(<a class="el" href="classcxi_1_1_mechanism_parameter.html">MechanismParameter</a>))</td></tr>
<tr class="separator:a13632fb9601103b404da667112daf0a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="member-group"></a>
Cryptography (deprecated)</h2></td></tr>
<tr class="memitem:ac348604a4d6f57b2060bff9370b68c90"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classcxi_1_1_byte_array.html">ByteArray</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcxi_1_1_cxi.html#ac348604a4d6f57b2060bff9370b68c90">crypt</a> (<a class="el" href="classcxi_1_1_key.html">Key</a> &amp;key, const <a class="el" href="classcxi_1_1_mechanism_parameter.html">MechanismParameter</a> &amp;mechParam, const <a class="el" href="classcxi_1_1_byte_array.html">ByteArray</a> &amp;data, <a class="el" href="classcxi_1_1_byte_array.html">ByteArray</a> &amp;iv=NULL_REF(<a class="el" href="classcxi_1_1_byte_array.html">ByteArray</a>))</td></tr>
<tr class="separator:ac348604a4d6f57b2060bff9370b68c90"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e92997c336ff5c9eb48c468ad709b88"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classcxi_1_1_byte_array.html">ByteArray</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcxi_1_1_cxi.html#a2e92997c336ff5c9eb48c468ad709b88">sign</a> (<a class="el" href="classcxi_1_1_key.html">Key</a> &amp;key, const <a class="el" href="classcxi_1_1_mechanism_parameter.html">MechanismParameter</a> &amp;mechParam, const <a class="el" href="classcxi_1_1_byte_array.html">ByteArray</a> &amp;data, <a class="el" href="classcxi_1_1_byte_array.html">ByteArray</a> &amp;iv=NULL_REF(<a class="el" href="classcxi_1_1_byte_array.html">ByteArray</a>))</td></tr>
<tr class="separator:a2e92997c336ff5c9eb48c468ad709b88"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7e73d06ec4b8c681b9b12927180d4e63"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcxi_1_1_cxi.html#a7e73d06ec4b8c681b9b12927180d4e63">verify</a> (<a class="el" href="classcxi_1_1_key.html">Key</a> &amp;key, const <a class="el" href="classcxi_1_1_mechanism_parameter.html">MechanismParameter</a> &amp;mechParam, <a class="el" href="classcxi_1_1_byte_array.html">ByteArray</a> &amp;data, const <a class="el" href="classcxi_1_1_byte_array.html">ByteArray</a> &amp;signature, <a class="el" href="classcxi_1_1_byte_array.html">ByteArray</a> &amp;iv=NULL_REF(<a class="el" href="classcxi_1_1_byte_array.html">ByteArray</a>))</td></tr>
<tr class="separator:a7e73d06ec4b8c681b9b12927180d4e63"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Command interface to CXI firmware module. Handles all communication with the CryptoServer. </p>
<p>The following example illustrates the usage of the <a class="el" href="classcxi_1_1_cxi.html" title="Command interface to CXI firmware module. Handles all communication with the CryptoServer.">Cxi</a> class:<br/>
 </p>
<div class="fragment"><div class="line"><span class="comment">// open connection to CryptoServer (command timeout: 20 sec, connection timeout: 5 sec.)</span></div>
<div class="line">cxi = <span class="keyword">new</span> <a class="code" href="classcxi_1_1_cxi.html#a5dd2d4f8f1c30c228793996f4c23952b">Cxi</a>(<span class="stringliteral">&quot;192.168.4.1&quot;</span>, 20000, 5000);</div>
<div class="line"></div>
<div class="line"><span class="comment">// logon to CryptoServer (user: CXI, password: utimaco, keep session alive: yes)</span></div>
<div class="line">cxi-&gt;logon_pass(<span class="stringliteral">&quot;CXI&quot;</span>, <span class="stringliteral">&quot;utimaco&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line"></div>
<div class="line"><span class="comment">// logon a second user with smartcard</span></div>
<div class="line">cxi-&gt;logon_sign(<span class="stringliteral">&quot;CXI&quot;</span>, <span class="stringliteral">&quot;:cs2:cyb:USB0&quot;</span>, NULL, <span class="keyword">true</span>);</div>
<div class="line"></div>
<div class="line"><span class="comment">// create an AES key</span></div>
<div class="line">PropertyList keyTemplate;</div>
<div class="line"></div>
<div class="line">keyTemplate.setAlgo(<a class="code" href="group__cxi__algos.html#gab39590bbb344830c32ce8889aa73bbce" title="AES.">CXI_KEY_ALGO_AES</a>);</div>
<div class="line">keyTemplate.setSize(256);</div>
<div class="line">keyTemplate.setGroup(<span class="stringliteral">&quot;test&quot;</span>);</div>
<div class="line">keyTemplate.setName(<span class="stringliteral">&quot;AES test key&quot;</span>);</div>
<div class="line"></div>
<div class="line">Key aesKey = cxi-&gt;key_generate(CXI_KEY_FLAG_OVERWRITE, keyTemplate, <a class="code" href="group__cxi__mech__rnd.html#ga8f393c5737cfa4bea3baa9273e5abd3a" title="Use hybrid random number generator in &#39;Real&#39; mode.">CXI_MECH_RND_REAL</a>);</div>
<div class="line"></div>
<div class="line"><span class="comment">// encrypt data with AES key</span></div>
<div class="line">ByteArray data = ByteArray(<span class="stringliteral">&quot;---secure message---&quot;</span>);</div>
<div class="line">ByteArray iv;</div>
<div class="line">MechanismParameter mechParam = MechanismParameter();</div>
<div class="line">mechParam.set(<a class="code" href="group__cxi__mech__mode.html#ga60376ba8a71aced951fd917fa6eab246" title="Encryption mode.">CXI_MECH_MODE_ENCRYPT</a>|<a class="code" href="group__cxi__mech__chain.html#ga966de78e6158c4e34dc61b4f8269b428" title="Cipher Block Chaining.">CXI_MECH_CHAIN_CBC</a>|<a class="code" href="group__cxi__mech__pad.html#ga732ec31819853a16ef405d1c21648942" title="Apply padding according to PKCS#5.">CXI_MECH_PAD_PKCS5</a>);</div>
<div class="line"></div>
<div class="line">ByteArray <a class="code" href="classcxi_1_1_cxi.html#a7aa786ac35603292ab4aefc9c9dfde5c">crypt</a> = cxi-&gt;crypt(0, aesKey, mechParam, data, iv);</div>
<div class="line">crypt.<a class="code" href="classcxi_1_1_byte_array.html#a2a81208e838a1a78ae26902e39b3ab4f">xtrace</a>(<span class="stringliteral">&quot;encrypted data&quot;</span>);</div>
<div class="line">iv.xtrace(<span class="stringliteral">&quot;iv&quot;</span>);</div>
<div class="line"></div>
<div class="line"><span class="comment">// create a RSA key</span></div>
<div class="line">keyTemplate.clear();</div>
<div class="line">keyTemplate.setAlgo(<a class="code" href="group__cxi__algos.html#ga7924019ed05d722ffcab4a1050f07e29" title="RSA.">CXI_KEY_ALGO_RSA</a>);</div>
<div class="line">keyTemplate.setSize(2048);</div>
<div class="line">keyTemplate.setGroup(<span class="stringliteral">&quot;test&quot;</span>);</div>
<div class="line">keyTemplate.setName(<span class="stringliteral">&quot;RSA test key&quot;</span>);</div>
<div class="line">Key rsaKey = cxi-&gt;key_generate(CXI_KEY_FLAG_OVERWRITE, keyTemplate);</div>
<div class="line"></div>
<div class="line"><span class="comment">// create hash</span></div>
<div class="line">Hash hash;</div>
<div class="line">hash.init(<a class="code" href="group__cxi__mech__hash.html#gaa0b420fc500f5158d0bf09d5f8acc353" title="SHA512.">CXI_MECH_HASH_ALGO_SHA512</a>);</div>
<div class="line">hash.update(<span class="stringliteral">&quot;We are what we &quot;</span>, 15);</div>
<div class="line">hash.update(<span class="stringliteral">&quot;were waiting for&quot;</span>, 16);</div>
<div class="line">hash.final();</div>
<div class="line">hash.xtrace(<span class="stringliteral">&quot;hash&quot;</span>);</div>
<div class="line"></div>
<div class="line"><span class="comment">// sign data</span></div>
<div class="line">mechParam = MechanismParameter(<a class="code" href="group__cxi__mech__pad.html#ga84bb8e9a492a3b893504719baf9c3cca" title="Apply padding according to PKCS#1_v1.5.">CXI_MECH_PAD_PKCS1</a>|<a class="code" href="group__cxi__mech__hash.html#gaa0b420fc500f5158d0bf09d5f8acc353" title="SHA512.">CXI_MECH_HASH_ALGO_SHA512</a>);</div>
<div class="line"></div>
<div class="line">ByteArray <a class="code" href="classcxi_1_1_cxi.html#a36b96d576073b1fc7d97169f40530fef">sign</a> = cxi-&gt;sign(0, rsaKey, mechParam, hash);</div>
<div class="line">sign.<a class="code" href="classcxi_1_1_byte_array.html#a2a81208e838a1a78ae26902e39b3ab4f">xtrace</a>(<span class="stringliteral">&quot;sign&quot;</span>);</div>
<div class="line"></div>
<div class="line"><span class="comment">// verify signature</span></div>
<div class="line">cxi-&gt;verify(0, rsaKey, mechParam, hash, sign);</div>
<div class="line"></div>
<div class="line"><span class="comment">// list keys</span></div>
<div class="line">KeyList keys = cxi-&gt;key_list();</div>
<div class="line"></div>
<div class="line"><span class="comment">//... other commands</span></div>
<div class="line"></div>
<div class="line"><span class="comment">// close connection</span></div>
<div class="line"><span class="keyword">delete</span> cxi;</div>
</div><!-- fragment --> </div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a5dd2d4f8f1c30c228793996f4c23952b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classcxi_1_1_cxi.html">Cxi</a> </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>device</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>timeout</em> = <code>60000</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ctimeout</em> = <code>5000</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Opens a connection to the CryptoServer.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">device</td><td>device specifier of CryptoServer, e.g.:<br/>
<ul>
<li>"PCI:0": first PCI board</li>
<li>"TCP:288@192.168.1.1": CryptoServer LAN on TCP port 288</li>
<li>"288@192.168.1.1": CryptoServer LAN on TCP port 288 (TCP protocol is default and may be omitted)</li>
<li>"192.168.1.1": CryptoServer LAN on TCP port 288 (port 288 is default and may be ommited)</li>
<li>"3001@127.0.0.1": CryptoServer Simulator on TCP port 3001</li>
</ul>
</td></tr>
    <tr><td class="paramname">timeout</td><td>timeout in milliseconds the API waits for an answer on command execution </td></tr>
    <tr><td class="paramname">ctimeout</td><td>timeout the API waits on attempt to connect to a Cryptoserver </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname"><a class="el" href="classcxi_1_1_exception.html" title="Constructs an exception object.">cxi::Exception</a></td><td>if connection can't be established. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ac019ec536635215ed77f06fd12e48c1e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classcxi_1_1_cxi.html">Cxi</a> </td>
          <td>(</td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>devices</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ndevs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>timeout</em> = <code>60000</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ctimeout</em> = <code>5000</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fallback_interval</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Opens a connection to a CryptoServer cluster.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">devices</td><td>array of device specifier of CryptoServer, e.g.:<br/>
<ul>
<li>"PCI:0": first PCI board</li>
<li>"TCP:288@192.168.1.1": CryptoServer LAN on TCP port 288</li>
<li>"288@192.168.1.1": CryptoServer LAN on TCP port 288 (TCP protocol is default and may be omitted)</li>
<li>"192.168.1.1": CryptoServer LAN on TCP port 288 (port 288 is default and may be ommited)</li>
<li>"3001@127.0.0.1": CryptoServer Simulator on TCP port 3001</li>
</ul>
</td></tr>
    <tr><td class="paramname">ndevs</td><td>number of devices in given array </td></tr>
    <tr><td class="paramname">timeout</td><td>timeout in milliseconds the API waits for an answer on command execution </td></tr>
    <tr><td class="paramname">ctimeout</td><td>timeout the API waits on attempt to connect to a Cryptoserver </td></tr>
    <tr><td class="paramname">fallback_interval</td><td>time in seconds the API waits before it tries to reconnect to the primary device (first device in the list) after having switched to another device due to a communication error. </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname"><a class="el" href="classcxi_1_1_exception.html" title="Constructs an exception object.">cxi::Exception</a></td><td>if no connection to any device can be established. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a449d5ff24a70006e8f9eaa23de5c037a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classcxi_1_1_cxi.html">Cxi</a> </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; std::string &gt;&#160;</td>
          <td class="paramname"><em>devices</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>timeout</em> = <code>60000</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ctimeout</em> = <code>5000</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fallback_interval</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Opens a connection to a CryptoServer cluster.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">devices</td><td>list of device specifier of CryptoServer, e.g.:<br/>
<ul>
<li>"PCI:0": first PCI board</li>
<li>"TCP:288@192.168.1.1": CryptoServer LAN on TCP port 288</li>
<li>"288@192.168.1.1": CryptoServer LAN on TCP port 288 (TCP protocol is default and may be omitted)</li>
<li>"192.168.1.1": CryptoServer LAN on TCP port 288 (port 288 is default and may be ommited)</li>
<li>"3001@127.0.0.1": CryptoServer Simulator on TCP port 3001</li>
</ul>
</td></tr>
    <tr><td class="paramname">timeout</td><td>timeout in milliseconds the API waits for an answer on command execution </td></tr>
    <tr><td class="paramname">ctimeout</td><td>timeout the API waits on attempt to connect to a Cryptoserver </td></tr>
    <tr><td class="paramname">fallback_interval</td><td>time in seconds the API waits before it tries to reconnect to the primary device (first device in the list) after having switched to another device due to a communication error. </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname"><a class="el" href="classcxi_1_1_exception.html" title="Constructs an exception object.">cxi::Exception</a></td><td>if no connection to any device can be established. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ad06fb5c45abd46c4b821131384d52ba0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classcxi_1_1_cxi.html">Cxi</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classcxi_1_1_config.html">Config</a> &amp;&#160;</td>
          <td class="paramname"><em>config</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Opens a connection to a CryptoServer cluster according to the given configuration object.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">config</td><td>Configuration object. The following key names will be recognized:<br/>
<br/>
 <table class="doxtable">
<tr>
<th><a class="el" href="classcxi_1_1_key.html" title="Encapsulates key handles or key blobs of type &#39;Backup Blob&#39;, see Format of Key Blobs.">Key</a> </th><th>Mandatory </th><th>Default Value </th><th>Description  </th></tr>
<tr>
<td>Device </td><td>Yes </td><td>- </td><td>Device specifier of CryptoServer to be connected.<br/>
 Optionally multiple device specifier can be assigned in order to establish a fault-tolerant connection to a cluster of CryptoServer (failover).<br/>
 The values have to be separated either by a space or tab character or have to be spread over multiple lines each ended by a backslash character, see <a class="el" href="classcxi_1_1_config.html">cxi::Config</a>.  </td></tr>
<tr>
<td>Timeout </td><td>No </td><td>60000 </td><td>Timeout in milliseconds the API waits for an answer on command execution  </td></tr>
<tr>
<td>ConnectionTimeout </td><td>No </td><td>3000 </td><td>Timeout in milliseconds the API waits on attempt to connect to a CryptoServer  </td></tr>
<tr>
<td>EndSessionOnShutdown </td><td>No </td><td>false </td><td>Enables or disables a ShutdownHook for terminating active sessions  </td></tr>
<tr>
<td>KeepSessionAlive </td><td>No </td><td>false </td><td>Prevents a secure messaging session from expiring after having been idle for more than 15 minutes  </td></tr>
<tr>
<td>FallbackInterval </td><td>No </td><td>0 </td><td>Time in seconds the API waits before it tries to reconnect to the primary device (first device in list)<br/>
 after having switched to another device due to a communication error  </td></tr>
<tr>
<td><br/>
 </td><td></td><td></td><td></td></tr>
</table>
<br/>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname"><a class="el" href="classcxi_1_1_exception.html" title="Constructs an exception object.">cxi::Exception</a></td><td>if configuration doesn't contain a device entry or if no connection to any device can be established. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="af560e4e9b18f6b7120324bab50c036bf"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">~<a class="el" href="classcxi_1_1_cxi.html">Cxi</a> </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Terminates secure messaging and closes connection to the Cryptoserver </p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="ad98220ac29eb9571be2817a8d8d3a32d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void exec </td>
          <td>(</td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>fc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>sfc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>p_cmd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>l_cmd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char **&#160;</td>
          <td class="paramname"><em>pp_answ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int *&#160;</td>
          <td class="paramname"><em>p_l_answ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcxi_1_1_cxi_1_1_c_l_u_s_t_e_r___e_r_r_o_r.html">CLUSTER_ERROR</a> *&#160;</td>
          <td class="paramname"><em>errlist</em> = <code>NULL</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>err_ct</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Sends a generic command to the CryptoServer and receives the answer. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fc</td><td>Function Code (==Module ID) of the target firmware module </td></tr>
    <tr><td class="paramname">sfc</td><td>Sub Function Code of the function to be called </td></tr>
    <tr><td class="paramname">p_cmd</td><td>pointer to command to be send </td></tr>
    <tr><td class="paramname">l_cmd</td><td>length of command to be send </td></tr>
    <tr><td class="paramname">pp_answ</td><td>pointer to answer buffer (memory allocation) </td></tr>
    <tr><td class="paramname">p_l_answ</td><td>pointer to length of answer data </td></tr>
    <tr><td class="paramname">errlist</td><td>additional list of error codes the cluster should not reply to the API but switch to another device or 'NULL' </td></tr>
    <tr><td class="paramname">err_ct</td><td>dimension of error list or zero </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname"><a class="el" href="classcxi_1_1_exception.html" title="Constructs an exception object.">cxi::Exception</a></td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>At first the API tries to execute the command on the current device. In case of a communication error or if the error is member of the additional list of error codes (<a class="el" href="structcxi_1_1_cxi_1_1_c_l_u_s_t_e_r___e_r_r_o_r.html">CLUSTER_ERROR</a>) the API switches to the next device and tries to execute the command on that device. If all devices were tried without success the API gives up, throws an exeption and returns to the caller. </dd></dl>

</div>
</div>
<a class="anchor" id="a50e1e01b60aa88d420c2246c7be82346"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void free_answ </td>
          <td>(</td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>p_answ</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Frees answer buffer allocated by a call to <a class="el" href="classcxi_1_1_cxi.html#ad98220ac29eb9571be2817a8d8d3a32d">Cxi::exec</a>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">p_answ</td><td>pointer to buffer to be freed </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a2c00593236091bfa52ac43683dddbd9e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int get_version </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Inquires version of CXI API library. </p>
<dl class="section return"><dt>Returns</dt><dd>version, e.g. 0x01010000 </dd></dl>

</div>
</div>
<a class="anchor" id="a19699ea81c1d2f40c31fdd671f9ece78"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int get_fw_version </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Inquires version of CXI firmware modul </p>
<dl class="section return"><dt>Returns</dt><dd>version, e.g. 0x01020300 </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname"><a class="el" href="classcxi_1_1_exception.html" title="Constructs an exception object.">cxi::Exception</a></td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ab44adac412254acc636c959ccc91b302"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void logon_sign </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>user</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>password</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>keep_alive</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Authenticates to the CryptoServer and creates an encrypted messaging tunnel to the CryptoServer (secure messaging). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">user</td><td>name (C-string) of user to be logged on </td></tr>
    <tr><td class="paramname">key</td><td>key token (C-string) to be used for signature creation:<ul>
<li>name of key file (opptionally being password encrypted)</li>
<li>smartcard specifier: ":&lt;smartcard&gt;:&lt;reader&gt;:&lt;port&gt;"<ul>
<li>smartcard:<ul>
<li>"cs2": CryptoServer administration smartcard</li>
</ul>
</li>
<li>reader:<ul>
<li>"cyb": ReinerSCT, modell cyberJack</li>
<li>"cp8": Xiring, modell XIMax1MB or Bull, modell CP8</li>
<li>"pcsc": generic PC/SC compatible reader</li>
</ul>
</li>
<li>port:<ul>
<li>"COM&lt;n&gt;": seriell port n on a Windows system</li>
<li>"/dev/ttyS&lt;n&gt;": serial port n on a Unix system</li>
<li>"USB&lt;n&gt;": n-th device in the USB enumeration</li>
<li>"&lt;n&gt;": n-th device in the PC/SC enumeration</li>
</ul>
</li>
</ul>
</li>
</ul>
</td></tr>
    <tr><td class="paramname">password</td><td>password (C-string) of the key file </td></tr>
    <tr><td class="paramname">keep_alive</td><td>keep current session alive and prevent it from expiring after 15 minutes idle time. </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname"><a class="el" href="classcxi_1_1_exception.html" title="Constructs an exception object.">cxi::Exception</a></td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a979e95d677f1eff4a6cb36aef68fa590"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void logon_pass </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>user</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>password</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>keep_alive</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Authenticates to the CryptoServer and creates an encrypted messaging tunnel to the CryptoServer (secure messaging). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">user</td><td>name (C-string) of user to be logged on </td></tr>
    <tr><td class="paramname">password</td><td>password (C-string) </td></tr>
    <tr><td class="paramname">keep_alive</td><td>keep current session alive and prevent it from expiring after 15 minutes idle time. </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname"><a class="el" href="classcxi_1_1_exception.html" title="Constructs an exception object.">cxi::Exception</a></td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a2e634a337fa6b8a7d9921e419fc2991a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void logoff </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Terminates secure messaging. </p>

</div>
</div>
<a class="anchor" id="a229f92a7dce2975e2b941a717e39a143"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int get_auth_state </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Inquires the resulting authentication state of the current secure messaging session.<br/>
 This value is evaluated as the sum of all users currently logged on to the secure messaging session. </p>
<dl class="section return"><dt>Returns</dt><dd>authentciation state, e.g. 0x00000002 </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname"><a class="el" href="classcxi_1_1_exception.html" title="Constructs an exception object.">cxi::Exception</a></td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a446ca60bc97ff5d1e7665676ed62a3cd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classcxi_1_1_key_list.html">KeyList</a> key_list </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classcxi_1_1_property_list.html">PropertyList</a> &amp;&#160;</td>
          <td class="paramname"><em>keyTemplate</em> = <code>NULL_REF(<a class="el" href="classcxi_1_1_property_list.html">PropertyList</a>)</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Enumerates the keys, which are currently stored in the CXI database on the CryptoServer.</p>
<p>The returned key list contains those keys that<br/>
 (1) the user is allowed to access<br/>
 (2) match the given search criteria</p>
<p>1)<br/>
 The user is allowed to access keys according to his group membership and 'global' keys without a group property.</p>
<p>2)<br/>
 A property list may be given to specify a partial set of keys to be listed. Thereby only those keys are listed that match the given property values. If no property list is given keys are not filtered. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">keyTemplate</td><td>List of properties that define search criteria for the keys to be listed. Keys that dont match the given criteria will not be listed.<br/>
 The following example illustrates how to list only RSA keys with 2048 bits: <div class="fragment"><div class="line">Property List := {</div>
<div class="line">   <a class="code" href="group__cxi__props.html#ga4853307cac8d7c0aaab8ad4175981cd7" title="Algorithm specifier, see Algorithm Specifier [int].">CXI_PROP_KEY_ALGO</a> := <a class="code" href="group__cxi__algos.html#ga7924019ed05d722ffcab4a1050f07e29" title="RSA.">CXI_KEY_ALGO_RSA</a></div>
<div class="line">   <a class="code" href="group__cxi__props.html#ga4f4df1deedbd1ed3a387c9f6e8097548" title="Key size in bits [int].">CXI_PROP_KEY_SIZE</a> := 2048</div>
<div class="line">}</div>
</div><!-- fragment --></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Key list. The following properties are returned for every key:<ul>
<li>CXI_PROP_KEY_ALGO</li>
<li>CXI_PROP_KEY_GROUP</li>
<li>CXI_PROP_KEY_NAME</li>
<li>CXI_PROP_KEY_SPEC</li>
<li>CXI_PROP_KEY_SIZE</li>
<li>CXI_PROP_KEY_TYPE <br/>
</li>
</ul>
</dd></dl>
<p>Note:</p>
<ul>
<li>The key list contains only such keys the user is allowed to access, other keys are 'invisible'. Therefore the CryptoServer checks whether the key group matches with the value of the user attribute "CXI_GROUP" of the currently authenticated user(s).</li>
<li>Keys without key group property are listed in any case.</li>
</ul>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname"><a class="el" href="classcxi_1_1_exception.html" title="Constructs an exception object.">cxi::Exception</a></td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a063ad47b7b9682361af1c25af09a7ed6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classcxi_1_1_key.html">Key</a> key_generate </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classcxi_1_1_property_list.html">PropertyList</a> &amp;&#160;</td>
          <td class="paramname"><em>keyTemplate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>mech</em> = <code>-1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Generates new keys or domain parameters according on the given template (property list).<br/>
 Dependant on the given flags the key is either stored in the internal database and a key handle<br/>
 is returned or the key is not stored in the database but a MBK encrypted key backup blob is returned.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">flags</td><td>XOR combination of:<ul>
<li>CXI_KEY_FLAG_OVERWRITE : overwrite already existing key</li>
<li>CXI_KEY_FLAG_EXTERNAL : don't store the key in the internal database but return a key backup blob.</li>
<li>CXI_KEY_FLAG_VOLATILE : don't store the key permanently (lost after restart of CryptoServer) </li>
</ul>
</td></tr>
    <tr><td class="paramname">keyTemplate</td><td>Key properties to be set for the new key (see <a class="el" href="group__cxi__props.html">Key Properties</a>).<br/>
 The following properties are mandatory for the key template:<ul>
<li>CXI_PROP_KEY_ALGO : key algorithm specifier (see <a class="el" href="group__cxi__algos.html">Algorithm Specifier</a>)</li>
<li>CXI_PROP_KEY_SIZE : key size in bits. If the algoritm doesn't require a key size (e.g. EC) the key size has to be set to zero.</li>
<li>CXI_PROP_KEY_NAME : key name (may be omitted in case of external key storage)<br/>
 </li>
</ul>
</td></tr>
    <tr><td class="paramname">mech</td><td>XOR combination of:<ul>
<li>Random mode (see <a class="el" href="group__cxi__mech__rnd.html">Random Generation Parameter</a>):<ul>
<li>CXI_MECH_RND_REAL : use hardware (real) random number generator (better, slower)</li>
<li>CXI_MECH_RND_PSEUDO : use deterministic (pseudo) random number generator (faster)</li>
</ul>
</li>
<li>Key generation mechanism (see <a class="el" href="group__cxi__mech__keygen.html">Key Generation Parameter</a>):<ul>
<li>RSA:<ul>
<li>CXI_MECH_KEYGEN_PROB_PRIME : create 'probable' prime values according to Miller-Rabin's algorithm (default)</li>
<li>CXI_MECH_KEYGEN_PROV_PRIME : create 'proven' prime values according to Maurer's algorithm</li>
<li>CXI_MECH_KEYGEN_ANSI_PRIME : create prime values according to ANSI specification</li>
<li>CXI_MECH_KEYGEN_FIPS186_4_PRIME : create prime numbers according to FIPS-186-4</li>
</ul>
</li>
<li>ECDSA:<ul>
<li>CXI_MECH_KEYGEN_UNCOMP : public key in uncompressed form (default)</li>
<li>CXI_MECH_KEYGEN_COMP : public key in compressed form</li>
<li>CXI_MECH_KEYGEN_HYBRID: public key in hybrid form</li>
</ul>
</li>
<li>DSA:<ul>
<li>CXI_MECH_KEYGEN_PROB_PRIME : create 'probable' prime values according to Miller-Rabin's algorithm (default)</li>
<li>CXI_MECH_KEYGEN_PROV_PRIME : create 'proven' prime values according to Maurer's algorithm</li>
<li>CXI_MECH_DPGEN_DP_FIPS186_4 : create DSA domain parameters conform to FIPS 186-4 </li>
</ul>
</li>
</ul>
</li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Key Object (either key handle or - in case of external key storage - key backup blob). </dd></dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="group__key__blobs.html">Format of Key Blobs</a> </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname"><a class="el" href="classcxi_1_1_exception.html" title="Constructs an exception object.">cxi::Exception</a></td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>FIPS:</dt><dd><br/>
 In FIPS mode the additional key attribute <em>Mechs</em> containing all supported mechanisms must be set prior to the key generation. It is only allowed to choose one padding but all supported hash algos must be defined explicitly. The following code illustrates how to generate an RSA key containing two different mechanisms: <div class="fragment"><div class="line"><span class="keyword">const</span> <span class="keywordtype">int</span> mechs_num = 2;</div>
<div class="line"><span class="keywordtype">int</span> mechs[mechs_num];  </div>
<div class="line">mechs[0] = ( <a class="code" href="group__cxi__mech__hash.html#gae74f820a40c2e4dc8f6938a252b7444e" title="SHA384.">CXI_MECH_HASH_ALGO_SHA384</a> | <a class="code" href="group__cxi__mech__pad.html#ga84bb8e9a492a3b893504719baf9c3cca" title="Apply padding according to PKCS#1_v1.5.">CXI_MECH_PAD_PKCS1</a> );</div>
<div class="line">mechs[1] = ( <a class="code" href="group__cxi__mech__hash.html#gaa0b420fc500f5158d0bf09d5f8acc353" title="SHA512.">CXI_MECH_HASH_ALGO_SHA512</a> | <a class="code" href="group__cxi__mech__pad.html#ga84bb8e9a492a3b893504719baf9c3cca" title="Apply padding according to PKCS#1_v1.5.">CXI_MECH_PAD_PKCS1</a> );</div>
<div class="line"></div>
<div class="line">PropertyList keyTemplate;</div>
<div class="line">keyTemplate.setAlgo(<a class="code" href="group__cxi__algos.html#ga7924019ed05d722ffcab4a1050f07e29" title="RSA.">CXI_KEY_ALGO_RSA</a>);</div>
<div class="line">keyTemplate.setSize(2048);</div>
<div class="line">keyTemplate.setName(<span class="stringliteral">&quot;RSA_DEMO_KEY&quot;</span>);</div>
<div class="line">keyTemplate.setMechs(mechs, mechs_num);</div>
<div class="line"></div>
<div class="line">Key rsaKey = cxi-&gt;key_generate(<a class="code" href="group__cxi__flags.html#gadb52dc105bbaf1dd329ee21ca8d68e87" title="Don&#39;t store key on CryptoServer but return MBK encrypted Backup Blob.">CXI_FLAG_KEY_EXTERNAL</a>, keyTemplate);</div>
</div><!-- fragment --> </dd></dl>

</div>
</div>
<a class="anchor" id="a1bc1c645bc41fcdcad1f7ca1ecb5f669"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classcxi_1_1_key.html">Key</a> key_open </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classcxi_1_1_property_list.html">PropertyList</a> &amp;&#160;</td>
          <td class="paramname"><em>keyTemplate</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Opens a key in the internal database of the CryptoServer and returns either a key handle or a key blob.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">flags</td><td>Command flags:<ul>
<li>CXI_KEY_FLAG_EXTERNAL: return a key blob instead of a key handle.<br/>
 </li>
</ul>
</td></tr>
    <tr><td class="paramname">keyTemplate</td><td>Property list, which specifies the key to be opened. The key is identified by the following properties:<ul>
<li>name (mandatory)</li>
<li>group (optional)</li>
<li>specifier (optional)</li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Key Object (either key handle or - in case of external key storage - key backup blob). </dd></dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="group__key__blobs.html">Format of Key Blobs</a> </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname"><a class="el" href="classcxi_1_1_exception.html" title="Constructs an exception object.">cxi::Exception</a></td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>On a cluster the desired key is returned if it exists on at least one CryptoServer. </dd>
<dd>
Setting flags to CXI_KEY_FLAG_EXTERNAL implicitly executes <a class="el" href="classcxi_1_1_cxi.html#a1bc1c645bc41fcdcad1f7ca1ecb5f669">Cxi::key_open</a> and <a class="el" href="classcxi_1_1_cxi.html#af67dcccc3667f54abb9b31ae6902433e">Cxi::key_backup</a> in one atomic operation and is therefore recommended to provide seamless fail-over. </dd></dl>

</div>
</div>
<a class="anchor" id="afbd6b562f308fb09c9142cfd24645599"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void key_delete </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classcxi_1_1_property_list.html">PropertyList</a> &amp;&#160;</td>
          <td class="paramname"><em>keyTemplate</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Deletes the given key. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">keyTemplate</td><td>property list, which specifies the key to be opened. The key is identified by the following properties:<ul>
<li>name (mandatory)</li>
<li>group (optional)</li>
<li>specifier (optional) </li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname"><a class="el" href="classcxi_1_1_exception.html" title="Constructs an exception object.">cxi::Exception</a></td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a65f03a133f7ae8f4575fafc4d42744cc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void key_delete </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classcxi_1_1_key.html">Key</a> &amp;&#160;</td>
          <td class="paramname"><em>key</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Deletes the given key. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">key</td><td>key to be deleted </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname"><a class="el" href="classcxi_1_1_exception.html" title="Constructs an exception object.">cxi::Exception</a></td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="aa236ca70a4d8d0fe4d60284e12962bac"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classcxi_1_1_property_list.html">PropertyList</a> key_prop_get </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classcxi_1_1_key.html">Key</a> &amp;&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>properties</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nprops</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Inquires one or more key property values. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">key</td><td>key, whose properties are to be inquired </td></tr>
    <tr><td class="paramname">properties</td><td>integer-array of property specifier, see <a class="el" href="group__cxi__props.html">Key Properties</a> </td></tr>
    <tr><td class="paramname">nprops</td><td>number of property specifier </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="classcxi_1_1_property_list.html" title="Constructs and parses key property lists, see Key Properties.">PropertyList</a> containing the desired values. </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname"><a class="el" href="classcxi_1_1_exception.html" title="Constructs an exception object.">cxi::Exception</a></td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ac08ca859db31def5ab876bad782f975f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classcxi_1_1_key.html">Key</a> key_prop_set </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classcxi_1_1_key.html">Key</a> &amp;&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classcxi_1_1_property_list.html">PropertyList</a> &amp;&#160;</td>
          <td class="paramname"><em>propList</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Sets or modifies one or more properties of the given key. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">key</td><td>key whose properties are to be set </td></tr>
    <tr><td class="paramname">propList</td><td>list of property values to be set </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="classcxi_1_1_key.html" title="Encapsulates key handles or key blobs of type &#39;Backup Blob&#39;, see Format of Key Blobs.">Key</a> object<ul>
<li>If a key blob was given, the modified blob is returned</li>
<li>If a key handle was given, the database record is updated and a key handle is returned</li>
</ul>
</dd></dl>
<p>Note:</p>
<ul>
<li>Read-only property values (e.g. key type) are not allowed to be set. <dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname"><a class="el" href="classcxi_1_1_exception.html" title="Constructs an exception object.">cxi::Exception</a></td><td></td></tr>
  </table>
  </dd>
</dl>
</li>
</ul>

</div>
</div>
<a class="anchor" id="ac1a13557e155e9c737354c7531fe3cdb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classcxi_1_1_byte_array.html">ByteArray</a> key_export </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classcxi_1_1_key.html">Key</a> &amp;&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classcxi_1_1_key.html">Key</a> &amp;&#160;</td>
          <td class="paramname"><em>exportKey</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>mech</em> = <code>-1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Exports the given key and returns a key blob of type 'Simple Blob' (see <a class="el" href="group__key__blobs.html">Format of Key Blobs</a>).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">type</td><td>XOR combination of:<ul>
<li>Blob type (see <a class="el" href="group__cxi__blobs.html">Blob Types</a>):<ul>
<li>CXI_KEY_BLOB_SIMPLE: Generic blob format of the CXI module</li>
</ul>
</li>
<li>Key type (see <a class="el" href="group__cxi__types.html">Key Types</a>):<ul>
<li>DES, AES:<ul>
<li>CXI_KEY_TYPE_SECRET : Export secret key</li>
</ul>
</li>
<li>RSA, ECDSA, DSA:<ul>
<li>CXI_KEY_TYPE_PUBLIC : Export public key</li>
<li>CXI_KEY_TYPE_PRIVATE : Export private key </li>
</ul>
</li>
</ul>
</li>
</ul>
</td></tr>
    <tr><td class="paramname">key</td><td>Key to be exported </td></tr>
    <tr><td class="paramname">exportKey</td><td>Key Encryption Key to be used to encrypt key.<ul>
<li>If permitted by the key export property, the key may be exported in plain. The value of exportKey has to be set to 'NULL_REF' in this case </li>
</ul>
</td></tr>
    <tr><td class="paramname">mech</td><td>XOR combination of mechanism parameter used to encrypt key (see <a class="el" href="classcxi_1_1_mechanism_parameter.html">cxi::MechanismParameter</a>):<ul>
<li>Chaining mode (see <a class="el" href="group__cxi__mech__chain.html">Chaining Modes</a>):<ul>
<li>DES, AES:<ul>
<li>CXI_MECH_CHAIN_ECB : Use 'Electronic Codebook' mode (no chaining)</li>
<li>CXI_MECH_CHAIN_CBC : Use 'Cipher Block Chaining' mode (default)</li>
</ul>
</li>
</ul>
</li>
<li>Padding mode (see <a class="el" href="group__cxi__mech__pad.html">Padding Modes</a>):<ul>
<li>DES, AES:<ul>
<li>CXI_MECH_PAD_NONE : Don't apply any padding (data length has to be a multiple of algorithms block size)</li>
<li>CXI_MECH_PAD_PKCS5 : Apply padding according to PKCS#5 (default)</li>
<li>CXI_MECH_PAD_RANDOM : Apply random padding</li>
<li>CXI_MECH_PAD_ISO7816 : Apply padding according to ISO 7816</li>
</ul>
</li>
<li>RSA:<ul>
<li>CXI_MECH_PAD_NONE : Don't apply any padding (data length has to be smaller than length of modulus)</li>
<li>CXI_MECH_PAD_PKCS1 : Apply padding according to PKCS#1 v1_5 (block type 2)</li>
</ul>
</li>
</ul>
</li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Byte array containing key blob </dd></dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="group__key__blobs.html">Format of Key Blobs</a> </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname"><a class="el" href="classcxi_1_1_exception.html" title="Constructs an exception object.">cxi::Exception</a></td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="aad519612c629ad949006f832be416ebd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classcxi_1_1_key.html">Key</a> key_import </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classcxi_1_1_property_list.html">PropertyList</a> &amp;&#160;</td>
          <td class="paramname"><em>keyTemplate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classcxi_1_1_byte_array.html">ByteArray</a> &amp;&#160;</td>
          <td class="paramname"><em>keyBlob</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classcxi_1_1_key.html">Key</a> &amp;&#160;</td>
          <td class="paramname"><em>importKey</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>mech</em> = <code>-1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Imports a key blob of type 'Simple Blob' (see <a class="el" href="group__key__blobs.html">Format of Key Blobs</a>).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">flags</td><td>XOR combination of:<ul>
<li>CXI_KEY_FLAG_OVERWRITE : overwrite already existing key</li>
<li>CXI_KEY_FLAG_EXTERNAL : don't store the key in the internal database but return a key backup blob.</li>
<li>CXI_KEY_FLAG_VOLATILE : don't store the key permanently (lost after restart of CryptoServer) </li>
</ul>
</td></tr>
    <tr><td class="paramname">type</td><td>Blob type (see <a class="el" href="group__cxi__blobs.html">Blob Types</a>):<ul>
<li>CXI_KEY_BLOB_SIMPLE<br/>
 Other blob types are reserved for future use </li>
</ul>
</td></tr>
    <tr><td class="paramname">keyTemplate</td><td>Key properties to be set for the new key.<br/>
<ul>
<li>The following properties are mandatory for the key template (see <a class="el" href="group__cxi__props.html">Key Properties</a>):<ul>
<li>CXI_PROP_KEY_NAME : key name (may be omitted in case of external key storage)<br/>
</li>
</ul>
</li>
<li>The following properties have to be absent from the key template:<ul>
<li>CXI_PROP_KEY_BLEN</li>
<li>CXI_PROP_KEY_UNAME</li>
<li>CXI_PROP_KEY_XXX_PUBKEY </li>
</ul>
</li>
</ul>
</td></tr>
    <tr><td class="paramname">keyBlob</td><td>Key blob to be imported </td></tr>
    <tr><td class="paramname">importKey</td><td>Key Encryption Key to be used to encrypt key.<ul>
<li>The key may be imported in plain. The value of importKey has to be set to 'NULL_REF' in this case </li>
</ul>
</td></tr>
    <tr><td class="paramname">mech</td><td>XOR combination of mechanism parameter used to decrypt key (see <a class="el" href="classcxi_1_1_mechanism_parameter.html">cxi::MechanismParameter</a>):<ul>
<li>Chaining mode (see <a class="el" href="group__cxi__mech__chain.html">Chaining Modes</a>):<ul>
<li>DES, AES:<ul>
<li>CXI_MECH_CHAIN_ECB : Use 'Electronic Codebook' mode (no chaining)</li>
<li>CXI_MECH_CHAIN_CBC : Use 'Cipher Block Chaining' mode (default)</li>
</ul>
</li>
</ul>
</li>
<li>Padding mode (see <a class="el" href="group__cxi__mech__pad.html">Padding Modes</a>):<ul>
<li>DES, AES:<ul>
<li>CXI_MECH_PAD_NONE : Don't apply any padding (data length has to be a multiple of algorithms block size)</li>
<li>CXI_MECH_PAD_PKCS5 : Apply padding according to PKCS#5 (default)</li>
<li>CXI_MECH_PAD_RANDOM : Apply random padding</li>
<li>CXI_MECH_PAD_ISO7816 : Apply padding according to ISO 7816</li>
</ul>
</li>
<li>RSA:<ul>
<li>CXI_MECH_PAD_NONE : Don't apply any padding (data length has to be smaller than length of modulus)</li>
<li>CXI_MECH_PAD_PKCS1 : Apply padding according to PKCS#1 v1_5 (block type 2)</li>
</ul>
</li>
</ul>
</li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Key Object (either key handle or - in case of external key storage - key backup blob). </dd></dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="group__key__blobs.html">Format of Key Blobs</a> </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname"><a class="el" href="classcxi_1_1_exception.html" title="Constructs an exception object.">cxi::Exception</a></td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="aec6aec91d75b772ea77cf3744d4c6a67"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classcxi_1_1_property_list.html">PropertyList</a> key_dsa_xgen </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>psize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>qsize</em> = <code>160</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>mech</em> = <code>-1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Creates the domain parameter (P, Q and G), needed to create a DSA key (see <a class="el" href="classcxi_1_1_cxi.html#a063ad47b7b9682361af1c25af09a7ed6">Cxi::key_generate</a>). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">psize</td><td>size in bits of the prime P </td></tr>
    <tr><td class="paramname">qsize</td><td>size in bits of the prime Q </td></tr>
    <tr><td class="paramname">mech</td><td>XOR combination of:<ul>
<li>Random mode (see <a class="el" href="group__cxi__mech__rnd.html">Random Generation Parameter</a>):<ul>
<li>CXI_MECH_RND_REAL : use hardware (real) random number generator (better, slower)</li>
<li>CXI_MECH_RND_PSEUDO : use deterministic (pseudo) random number generator (faster)</li>
</ul>
</li>
<li>Key generation mechanism (see <a class="el" href="group__cxi__mech__keygen.html">Key Generation Parameter</a>):<ul>
<li>CXI_MECH_DPGEN_DP_FIPS186_4 : create DSA domain parameters conform to FIPS 186-4</li>
</ul>
</li>
<li><a class="el" href="classcxi_1_1_hash.html" title="Computes hash values.">Hash</a>:<ul>
<li>CXI_MECH_HASH_ALGO_SHA1 : SHA1</li>
<li>CXI_MECH_HASH_ALGO_RMD160 : RipeMD 160 (not supported in FIPS mode)</li>
<li>CXI_MECH_HASH_ALGO_SHA224 : SHA224</li>
<li>CXI_MECH_HASH_ALGO_SHA256 : SHA256</li>
<li>CXI_MECH_HASH_ALGO_MD5 : MD5 (not supported in FIPS mode)</li>
<li>CXI_MECH_HASH_ALGO_SHA384 : SHA384</li>
<li>CXI_MECH_HASH_ALGO_SHA512 : SHA512</li>
<li>CXI_MECH_HASH_ALGO_SHA3_224 : SHA3-224</li>
<li>CXI_MECH_HASH_ALGO_SHA3_256 : SHA3-256</li>
<li>CXI_MECH_HASH_ALGO_SHA3_384 : SHA3-384</li>
<li>CXI_MECH_HASH_ALGO_SHA3_512 : SHA3-512 </li>
</ul>
</li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname"><a class="el" href="classcxi_1_1_exception.html" title="Constructs an exception object.">cxi::Exception</a></td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ab10cd7e28c064e048ceab7325551490f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classcxi_1_1_property_list.html">PropertyList</a> key_dsa_pqgen </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classcxi_1_1_mechanism_parameter.html">MechanismParameter</a> &amp;&#160;</td>
          <td class="paramname"><em>mechParam</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Creates the domain parameters (P and Q), needed to create a DSA key (see <a class="el" href="classcxi_1_1_cxi.html#a063ad47b7b9682361af1c25af09a7ed6">Cxi::key_generate</a>) as described in FIPS 186-4. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">&amp;mechParam</td><td><ul>
<li>psize size in bits of the prime P</li>
<li>qsize size in bits of the prime Q</li>
<li>rnd Random mode (see <a class="el" href="group__cxi__mech__rnd.html">Random Generation Parameter</a>):<ul>
<li>CXI_MECH_RND_REAL : use hardware (real) random number generator (better, slower)</li>
<li>CXI_MECH_RND_PSEUDO : use deterministic (pseudo) random number generator (faster)</li>
</ul>
</li>
<li>hash_algo<ul>
<li>CXI_MECH_HASH_ALGO_SHA1 : SHA1</li>
<li>CXI_MECH_HASH_ALGO_RMD160 : RipeMD 160 (not supported in FIPS mode)</li>
<li>CXI_MECH_HASH_ALGO_SHA224 : SHA224</li>
<li>CXI_MECH_HASH_ALGO_SHA256 : SHA256</li>
<li>CXI_MECH_HASH_ALGO_MD5 : MD5 (not supported in FIPS mode)</li>
<li>CXI_MECH_HASH_ALGO_SHA384 : SHA384</li>
<li>CXI_MECH_HASH_ALGO_SHA512 : SHA512</li>
<li>CXI_MECH_HASH_ALGO_SHA3_224 : SHA3-224</li>
<li>CXI_MECH_HASH_ALGO_SHA3_256 : SHA3-256</li>
<li>CXI_MECH_HASH_ALGO_SHA3_384 : SHA3-384</li>
<li>CXI_MECH_HASH_ALGO_SHA3_512 : SHA3-512</li>
</ul>
</li>
<li>l_seed length of optional seed value</li>
<li>p_seed optional seed value</li>
<li>index unused </li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>| <a class="el" href="classcxi_1_1_property.html" title="Creates and parses property values of different types.">Property</a> List ("PL") | Mechanism Parameter ("MP") |<ul>
<li>PL: p, q</li>
<li>MP: | l_seed | p_seed | </li>
</ul>
</dd></dl>

</div>
</div>
<a class="anchor" id="aaac8a4fa0048f94620759628359905c0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classcxi_1_1_property_list.html">PropertyList</a> key_dsa_ggen </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classcxi_1_1_property_list.html">PropertyList</a> &amp;&#160;</td>
          <td class="paramname"><em>propList</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classcxi_1_1_mechanism_parameter.html">MechanismParameter</a> &amp;&#160;</td>
          <td class="paramname"><em>mechParam</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Creates the domain parameter G using the domain parameters (P and Q), needed to create a DSA key (see <a class="el" href="classcxi_1_1_cxi.html#a063ad47b7b9682361af1c25af09a7ed6">Cxi::key_generate</a>), as described in FIPS 186-4. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">&amp;propList</td><td><ul>
<li>PL: p, q </li>
</ul>
</td></tr>
    <tr><td class="paramname">&amp;mechParam</td><td><ul>
<li>hash_algo<ul>
<li>CXI_MECH_HASH_ALGO_SHA1 : SHA1</li>
<li>CXI_MECH_HASH_ALGO_RMD160 : RipeMD 160 (not supported in FIPS mode)</li>
<li>CXI_MECH_HASH_ALGO_SHA224 : SHA224</li>
<li>CXI_MECH_HASH_ALGO_SHA256 : SHA256</li>
<li>CXI_MECH_HASH_ALGO_MD5 : MD5 (not supported in FIPS mode)</li>
<li>CXI_MECH_HASH_ALGO_SHA384 : SHA384</li>
<li>CXI_MECH_HASH_ALGO_SHA512 : SHA512</li>
<li>CXI_MECH_HASH_ALGO_SHA3_224 : SHA3-224</li>
<li>CXI_MECH_HASH_ALGO_SHA3_256 : SHA3-256</li>
<li>CXI_MECH_HASH_ALGO_SHA3_384 : SHA3-384</li>
<li>CXI_MECH_HASH_ALGO_SHA3_512 : SHA3-512</li>
</ul>
</li>
<li>l_seed length of optional seed value</li>
<li>p_seed optional seed value</li>
<li>index optional tag to differentiate between possible generation processes. See FIPS 186-4. Must be smaller than 256. </li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>| <a class="el" href="classcxi_1_1_property.html" title="Creates and parses property values of different types.">Property</a> List ("PL") |<ul>
<li>PL: g </li>
</ul>
</dd></dl>

</div>
</div>
<a class="anchor" id="af67dcccc3667f54abb9b31ae6902433e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classcxi_1_1_key.html">Key</a> key_backup </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classcxi_1_1_key.html">Key</a> &amp;&#160;</td>
          <td class="paramname"><em>key</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Exports a key as key backup blob. The private or secret key parts within the blob<br/>
 are encrypted with the CryptoServers Master Backup key (MBK).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">key</td><td>Key to be backed up</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Key blob </dd></dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="group__key__blobs.html">Format of Key Blobs</a> </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname"><a class="el" href="classcxi_1_1_exception.html" title="Constructs an exception object.">cxi::Exception</a></td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a676b3f676b535f6bc81e024c0b4220e2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classcxi_1_1_key.html">Key</a> key_restore </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classcxi_1_1_key.html">Key</a> &amp;&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classcxi_1_1_property_list.html">PropertyList</a> &amp;&#160;</td>
          <td class="paramname"><em>keyTemplate</em> = <code>NULL_REF(<a class="el" href="classcxi_1_1_property_list.html">PropertyList</a>)</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Restores a key from a key backup blob.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">flags</td><td>XOR combination of:<ul>
<li>CXI_KEY_FLAG_OVERWRITE : overwrite already existing key</li>
<li>CXI_KEY_FLAG_VOLATILE : don't store the key permanently (lost after restart of CryptoServer)</li>
</ul>
</td></tr>
    <tr><td class="paramname">key</td><td>Key to be restored </td></tr>
    <tr><td class="paramname">keyTemplate</td><td>Key properties to be set or modified. If one or more of these properties<br/>
 are already present in the backup key blob, they will be overwritten, as long as the property<br/>
 value is not read-only, e.g. it is not possible to change the algorithm or key size property.<br/>
 Optionally, if no additional properties should be set, the reference value of keyTemplate can be set to NULL.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Key handle </dd></dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="group__key__blobs.html">Format of Key Blobs</a> </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname"><a class="el" href="classcxi_1_1_exception.html" title="Constructs an exception object.">cxi::Exception</a></td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a76a9dce5b9867f0f146cba6c7db704c9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classcxi_1_1_key.html">Key</a> key_create </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classcxi_1_1_property_list.html">PropertyList</a> &amp;&#160;</td>
          <td class="paramname"><em>keyTemplate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>mech</em> = <code>-1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="deprecated"><dt><b><a class="el" href="deprecated.html#_deprecated000001">Deprecated:</a></b></dt><dd>replaced by: <a class="el" href="classcxi_1_1_key.html" title="Encapsulates key handles or key blobs of type &#39;Backup Blob&#39;, see Format of Key Blobs.">Key</a> <a class="el" href="classcxi_1_1_cxi.html#a063ad47b7b9682361af1c25af09a7ed6">Cxi::key_generate(int flags, PropertyList &amp;keyTemplate, int mech)</a> </dd></dl>

</div>
</div>
<a class="anchor" id="a6ca2fcd7555e0c4e25ba2b36830cfdda"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classcxi_1_1_key.html">Key</a> key_open </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classcxi_1_1_property_list.html">PropertyList</a> &amp;&#160;</td>
          <td class="paramname"><em>keyTemplate</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="deprecated"><dt><b><a class="el" href="deprecated.html#_deprecated000002">Deprecated:</a></b></dt><dd>replaced by: <a class="el" href="classcxi_1_1_key.html" title="Encapsulates key handles or key blobs of type &#39;Backup Blob&#39;, see Format of Key Blobs.">Key</a> <a class="el" href="classcxi_1_1_cxi.html#a1bc1c645bc41fcdcad1f7ca1ecb5f669">Cxi::key_open(int flags, PropertyList &amp;keyTemplate)</a> </dd></dl>

</div>
</div>
<a class="anchor" id="a7aa786ac35603292ab4aefc9c9dfde5c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classcxi_1_1_byte_array.html">ByteArray</a> crypt </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classcxi_1_1_key.html">Key</a> &amp;&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classcxi_1_1_mechanism_parameter.html">MechanismParameter</a> &amp;&#160;</td>
          <td class="paramname"><em>mechParam</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classcxi_1_1_byte_array.html">ByteArray</a> &amp;&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classcxi_1_1_byte_array.html">ByteArray</a> &amp;&#160;</td>
          <td class="paramname"><em>iv</em> = <code>NULL_REF(<a class="el" href="classcxi_1_1_byte_array.html">ByteArray</a>)</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classcxi_1_1_byte_array.html">ByteArray</a> &amp;&#160;</td>
          <td class="paramname"><em>tag</em> = <code>NULL_REF(<a class="el" href="classcxi_1_1_byte_array.html">ByteArray</a>)</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classcxi_1_1_byte_array.html">ByteArray</a> &amp;&#160;</td>
          <td class="paramname"><em>tag_in</em> = <code>NULL_REF(<a class="el" href="classcxi_1_1_byte_array.html">ByteArray</a>)</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Encrypt or decrypt data.</p>
<p>The following algorithms are supported:</p>
<ul>
<li>DES</li>
<li>AES</li>
<li>RSA</li>
<li>ECC (ECIES)</li>
</ul>
<p>On symmetric algorithms the function may be called multiple times, each time with a different data chunk.<br/>
 The following specifics have to be regarded on chunked operation:</p>
<ul>
<li>The length of intermediate data chunks has to be a multiple of the algoritms block length (DES: 8 bytes, AES: 16 bytes).</li>
<li>If padding is required the padding mode (see <a class="el" href="group__cxi__mech__pad.html">Padding Modes</a>) has to be set only with the last block.</li>
<li>The authenticated encryption modes AES-GCM and AES-CCM do not return plain data immediately when decrypting. Instead, they wait for the final call to verify the authentication tag and then return the plain data all at once.</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">flags</td><td>Command flags:<br/>
<ul>
<li>CXI_FLAG_CRYPT_INIT: initialize operation (currently used for AES-CCM mode only).</li>
<li>CXI_FLAG_CRYPT_FINAL: last data chunk given, finalize operation (currently used for AES-GCM and AES-CCM modes).</li>
</ul>
</td></tr>
    <tr><td class="paramname">key</td><td>Key to be used for encryption or decryption</td></tr>
    <tr><td class="paramname">mechParam</td><td>XOR combination of mechanisms (see <a class="el" href="classcxi_1_1_mechanism_parameter.html">cxi::MechanismParameter</a>):<ul>
<li>Crypt mode (see <a class="el" href="group__cxi__mech__mode.html">Mode Parameter</a>):<ul>
<li>CXI_MECH_MODE_ENCRYPT : Encrypt data</li>
<li>CXI_MECH_MODE_DECRYPT : Decrypt data</li>
</ul>
</li>
<li>Chaining mode (see <a class="el" href="group__cxi__mech__chain.html">Chaining Modes</a>):<ul>
<li>DES, AES:<ul>
<li>CXI_MECH_CHAIN_ECB : Use 'Electronic Codebook' mode (no chaining)</li>
<li>CXI_MECH_CHAIN_CBC : Use 'Cipher Block Chaining' mode</li>
<li>CXI_MECH_CHAIN_GCM : Use 'Galois Counter Mode' mode (AES only)</li>
<li>CXI_MECH_CHAIN_OFB : Use 'Output Feedback Mode' mode (AES only)</li>
<li>CXI_MECH_CHAIN_CCM : Use 'Counter Chaining' mode with CBC-MAC (AES only)</li>
</ul>
</li>
</ul>
</li>
<li>Padding mode (see <a class="el" href="group__cxi__mech__pad.html">Padding Modes</a>):<ul>
<li>DES, AES:<ul>
<li>CXI_MECH_PAD_NONE : Don't apply any padding (data length has to be a multiple of algorithms block size)</li>
<li>CXI_MECH_PAD_PKCS5 : Apply padding according to PKCS#5</li>
<li>CXI_MECH_PAD_RANDOM : Apply random padding</li>
<li>CXI_MECH_PAD_ISO7816 : Apply padding according to ISO 7816</li>
</ul>
</li>
<li>RSA:<ul>
<li>CXI_MECH_PAD_NONE : Don't apply any padding (data length has to be smaller than length of modulus)</li>
<li>CXI_MECH_PAD_PKCS1 : Apply padding according to PKCS#1 v1_5 (block type 2)</li>
<li>CXI_MECH_PAD_OAEP : Apply padding according to PKCS#1-v2.1 EME-OAEP. Additionally the MGF hash algorithm and a label have to be given in this case.</li>
</ul>
</li>
</ul>
</li>
<li>Hash algorithm (see <a class="el" href="group__cxi__mech__hash.html">Hash Algorithms</a>):<ul>
<li>RSA:<ul>
<li>CXI_MECH_HASH_ALGO_XXX : hash algorithm for OAEP</li>
</ul>
</li>
</ul>
</li>
</ul>
</td></tr>
    <tr><td class="paramname">data</td><td>Data to be en- or decrypted.</td></tr>
    <tr><td class="paramname">iv</td><td>Initialization vector used to chain cipher blocks.<ul>
<li>The given value will be overwritten on return of the function.</li>
<li>In the case of AES-GCM and AES-CCM, iv should be an empty <a class="el" href="classcxi_1_1_byte_array.html" title="Encapsulates an array of primitive type char in an object and provides methods to operate on binary d...">ByteArray</a> for the initial call.</li>
<li>If, in AES-GCM mode, an IV has been generated by the CryptoServer, it will be returned in this parameter by the final call.</li>
<li>If no initialization vector is given (NULL_REF) a Null-vector is used (symmetric algorithms only)</li>
<li>The initialization vector has to be absent for asymmetric algorithms</li>
</ul>
</td></tr>
    <tr><td class="paramname">tag</td><td>Authentication Tag (used in AES-GCM and AES-CCM modes)<ul>
<li>The given value will be overwritten on return of the function.</li>
<li>Feed an empty <a class="el" href="classcxi_1_1_byte_array.html" title="Encapsulates an array of primitive type char in an object and provides methods to operate on binary d...">ByteArray</a> on first call of the method.</li>
<li>Feed returned tag on subsequent calls.</li>
</ul>
</td></tr>
    <tr><td class="paramname">tag_in</td><td>Verification Tag (used in AES-GCM and AES-CCM modes when decrypting)<ul>
<li>Only needed for the final call.</li>
<li>Feed the tag parameter returned by the final encryption call.</li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Encrypted or decrypted data. </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname"><a class="el" href="classcxi_1_1_exception.html" title="Constructs an exception object.">cxi::Exception</a></td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Examples:</dt><dd></dd></dl>
<p>Encrypt data in DES CBC mode with PKCS5 padding applied: </p>
<div class="fragment"><div class="line">ByteArray iv = ByteArray(<span class="stringliteral">&quot;12345678&quot;</span>, 8);</div>
<div class="line">ByteArray data = ...;</div>
<div class="line">ByteArray <a class="code" href="classcxi_1_1_cxi.html#a7aa786ac35603292ab4aefc9c9dfde5c">crypt</a>;</div>
<div class="line">MechanismParameter mechParam = MechanismParameter(<a class="code" href="group__cxi__mech__mode.html#ga60376ba8a71aced951fd917fa6eab246" title="Encryption mode.">CXI_MECH_MODE_ENCRYPT</a> | <a class="code" href="group__cxi__mech__chain.html#ga966de78e6158c4e34dc61b4f8269b428" title="Cipher Block Chaining.">CXI_MECH_CHAIN_CBC</a>);</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span> rlen = data.length();</div>
<div class="line"><span class="keywordtype">int</span> clen = 256;</div>
<div class="line"><span class="keywordtype">int</span> ofs = 0;</div>
<div class="line"></div>
<div class="line"><span class="keywordflow">while</span> (rlen &gt; 0)</div>
<div class="line">{</div>
<div class="line">  <span class="keywordflow">if</span> (rlen &lt; clen)</div>
<div class="line">  {</div>
<div class="line">    clen = rlen;</div>
<div class="line">    mechParam = MechanismParameter(<a class="code" href="group__cxi__mech__mode.html#ga60376ba8a71aced951fd917fa6eab246" title="Encryption mode.">CXI_MECH_MODE_ENCRYPT</a> | <a class="code" href="group__cxi__mech__chain.html#ga966de78e6158c4e34dc61b4f8269b428" title="Cipher Block Chaining.">CXI_MECH_CHAIN_CBC</a> | <a class="code" href="group__cxi__mech__pad.html#ga732ec31819853a16ef405d1c21648942" title="Apply padding according to PKCS#5.">CXI_MECH_PAD_PKCS5</a>);</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  chunk = data.sub(ofs, clen);</div>
<div class="line">  crypt += cxi-&gt;crypt(0, desKey, mechParam, chunk, iv);</div>
<div class="line"></div>
<div class="line">  ofs += clen;</div>
<div class="line">  rlen -= clen;</div>
<div class="line">}</div>
</div><!-- fragment --><p>Encrypt and decrypt data in AES GCM mode: </p>
<div class="fragment"><div class="line">ByteArray iv;</div>
<div class="line">ByteArray tag;</div>
<div class="line">ByteArray ad = <span class="stringliteral">&quot;My Little Secret&quot;</span>;</div>
<div class="line">ByteArray data = ...;</div>
<div class="line">ByteArray cipher;</div>
<div class="line">ByteArray plain;</div>
<div class="line">ByteArray veri_tag;</div>
<div class="line">ByteArray internal_iv;</div>
<div class="line">MechanismParameter mechParam;</div>
<div class="line"><span class="keywordtype">int</span> tag_bits = 128;</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span> rlen = data.length();</div>
<div class="line"><span class="keywordtype">int</span> clen = 32;  <span class="comment">// must be a multiple of 16</span></div>
<div class="line"><span class="keywordtype">int</span> ofs = 0;</div>
<div class="line"><span class="keywordtype">int</span> flags = 0;</div>
<div class="line"></div>
<div class="line"><span class="keywordflow">while</span> (rlen &gt; 0)</div>
<div class="line">{</div>
<div class="line">  <span class="keywordflow">if</span> (clen &gt; rlen) clen = rlen;</div>
<div class="line">  rlen -= clen;</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">if</span> (ofs == 0)</div>
<div class="line">  {</div>
<div class="line">    <span class="comment">// first block (may also be final block)</span></div>
<div class="line">    mechParam.setGCM(<a class="code" href="group__cxi__mech__mode.html#ga60376ba8a71aced951fd917fa6eab246" title="Encryption mode.">CXI_MECH_MODE_ENCRYPT</a>,</div>
<div class="line">                     NULL, 0,</div>
<div class="line">                     ad.get(), ad.length(),</div>
<div class="line">                     tag_bits);</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">else</span></div>
<div class="line">  {</div>
<div class="line">    <span class="comment">// subsequent blocks (including final block)</span></div>
<div class="line">    mechParam.setGCM(<a class="code" href="group__cxi__mech__mode.html#ga60376ba8a71aced951fd917fa6eab246" title="Encryption mode.">CXI_MECH_MODE_ENCRYPT</a>,</div>
<div class="line">                     NULL, 0,</div>
<div class="line">                     NULL, 0,</div>
<div class="line">                     tag_bits);</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  flags = (rlen == 0) ? <a class="code" href="group__cxi__flags.html#ga8bd4b91659b38e1046f2aabbd7c25164" title="Finalize En/Decryption Operation.">CXI_FLAG_CRYPT_FINAL</a> : 0;</div>
<div class="line"></div>
<div class="line">  chunk = data.sub(ofs, clen);</div>
<div class="line">  cipher += cxi-&gt;crypt(flags, key, mechParam, chunk, iv, tag);</div>
<div class="line"></div>
<div class="line">  ofs += clen;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line">internal_iv = iv;</div>
<div class="line">veri_tag = tag;</div>
<div class="line"></div>
<div class="line"><span class="comment">// decryption</span></div>
<div class="line">iv.clear();</div>
<div class="line">tag.clear();</div>
<div class="line">ofs = 0;</div>
<div class="line">rlen = cipher.length();</div>
<div class="line">clen = 32;</div>
<div class="line"></div>
<div class="line"><span class="keywordflow">while</span> (rlen &gt; 0)</div>
<div class="line">{</div>
<div class="line">  <span class="keywordflow">if</span> (clen &gt; rlen) clen = rlen;</div>
<div class="line">  rlen -= clen;</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">if</span> (ofs == 0)</div>
<div class="line">  {</div>
<div class="line">    <span class="comment">// first block (may also be final block)</span></div>
<div class="line">    mechParam.setGCM(<a class="code" href="group__cxi__mech__mode.html#ga3a9b24d840bc2b911da5a36ea30e1084" title="Decryption mode.">CXI_MECH_MODE_DECRYPT</a>,</div>
<div class="line">                     internal_iv.get(), internal_iv.length(),</div>
<div class="line">                     ad.get(), ad.length(),</div>
<div class="line">                     tag_bits);</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">else</span></div>
<div class="line">  {</div>
<div class="line">    <span class="comment">// subsequent blocks (including final block)</span></div>
<div class="line">    mechParam.setGCM(<a class="code" href="group__cxi__mech__mode.html#ga3a9b24d840bc2b911da5a36ea30e1084" title="Decryption mode.">CXI_MECH_MODE_DECRYPT</a>,</div>
<div class="line">                     NULL, 0,</div>
<div class="line">                     NULL, 0,</div>
<div class="line">                     tag_bits);</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  chunk = cipher.sub(ofs, clen);</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">if</span> (rlen == 0)</div>
<div class="line">  {</div>
<div class="line">    <span class="comment">// final call, this verifies the tag and returns the plain data</span></div>
<div class="line">    plain = cxi-&gt;crypt(<a class="code" href="group__cxi__flags.html#ga8bd4b91659b38e1046f2aabbd7c25164" title="Finalize En/Decryption Operation.">CXI_FLAG_CRYPT_FINAL</a>, key, mechParam, chunk, iv, tag, veri_tag);</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">else</span></div>
<div class="line">  {</div>
<div class="line">    cxi-&gt;crypt(0, key, mechParam, chunk, iv, tag);</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  ofs += clen;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
</div>
<a class="anchor" id="a008783fee629bbc4ba279540cb2d2a09"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; <a class="el" href="classcxi_1_1_byte_array.html">ByteArray</a> &gt; bulk_crypt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classcxi_1_1_key.html">Key</a> &amp;&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classcxi_1_1_mechanism_parameter.html">MechanismParameter</a> &amp;&#160;</td>
          <td class="paramname"><em>mechParam</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="classcxi_1_1_byte_array.html">ByteArray</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Encrypt or decrypt multiple data items in one operation.<br/>
 The function utilizes a cryptographic accelerator if present on the target hardware and therefore speeds up RSA calculations.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">key</td><td>Key to be used for encryption or decryption </td></tr>
    <tr><td class="paramname">mechParam</td><td>XOR combination of mechanisms (see <a class="el" href="classcxi_1_1_mechanism_parameter.html">cxi::MechanismParameter</a>):<ul>
<li>Crypt mode (see <a class="el" href="group__cxi__mech__mode.html">Mode Parameter</a>):<ul>
<li>CXI_MECH_MODE_ENCRYPT : Encrypt data</li>
<li>CXI_MECH_MODE_DECRYPT : Decrypt data </li>
</ul>
</li>
</ul>
</td></tr>
    <tr><td class="paramname">data</td><td>Array (vector) of data items to be en- or decrypted</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Array (vector) of encrypted or decrypted data items </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname"><a class="el" href="classcxi_1_1_exception.html" title="Constructs an exception object.">cxi::Exception</a></td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a36b96d576073b1fc7d97169f40530fef"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classcxi_1_1_byte_array.html">ByteArray</a> sign </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classcxi_1_1_key.html">Key</a> &amp;&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classcxi_1_1_mechanism_parameter.html">MechanismParameter</a> &amp;&#160;</td>
          <td class="paramname"><em>mechParam</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classcxi_1_1_byte_array.html">ByteArray</a> &amp;&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classcxi_1_1_byte_array.html">ByteArray</a> &amp;&#160;</td>
          <td class="paramname"><em>iv</em> = <code>NULL_REF(<a class="el" href="classcxi_1_1_byte_array.html">ByteArray</a>)</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Digitally signs the given hash value (asymmetric algorithms) or calculates a <em>Message Authentication Code</em> (MAC) or hash based MAC (HMAC) (symmetric algorithms).</p>
<p>The function supports cipher block chaining on MACs and multipart calculation on HMACs and asymmetric algorithms.<br/>
 On MAC calculation the returned MAC can be used as input IV on the next block.<br/>
 On HMAC calculation and asymmetric algorithms the function can be instructed not to finalize the hash but return intermediate digest information that can be used as input ('IV') for the next block.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">flags</td><td>Command flags:<br/>
<ul>
<li>CXI_FLAG_HASH_PART: Don't finalize hash calculation but return intermediate digest information to continue a multipart calculation on next function call.</li>
<li>CXI_FLAG_HASH_DATA: Given data has to be hashed before getting signed (asymmetric algorithms only).</li>
<li>CXI_FLAG_CRYPT_FINAL: Finalize CMAC or GMAC calculation and return the resulting MAC (AES-CMAC/GMAC only).</li>
</ul>
</td></tr>
    <tr><td class="paramname">key</td><td><a class="el" href="classcxi_1_1_key.html" title="Encapsulates key handles or key blobs of type &#39;Backup Blob&#39;, see Format of Key Blobs.">Key</a> to be used to create the signature or calculate the MAC or HMAC.<br/>
 The key usage property has to contain the CXI_KEY_USAGE_SIGN value.</td></tr>
    <tr><td class="paramname">mechParam</td><td>XOR combination of mechanism parameter (see <a class="el" href="classcxi_1_1_mechanism_parameter.html">cxi::MechanismParameter</a>):<ul>
<li>Chaining mode (see <a class="el" href="group__cxi__mech__chain.html">Chaining Modes</a>):<ul>
<li>DES:<ul>
<li>CXI_MECH_CHAIN_CBC : Use 'Cipher Block Chaining' mode.</li>
<li>CXI_MECH_CHAIN_CBC_RETAIL: Calculate a CBC Retail MAC according to ISO 9797 (often used in german payment systems).</li>
<li>CXI_MECH_CHAIN_CFB_RETAIL: Calculate a CFB Retail MAC (often used in german payment systems).</li>
</ul>
</li>
<li>AES:<ul>
<li>CXI_MECH_CHAIN_CBC : Use 'Cipher Block Chaining' mode.</li>
<li>CXI_MECH_CHAIN_CMAC : Calculate a CMAC according to NIST-SP800-38B.</li>
<li>CXI_MECH_CHAIN_GCM: Calculate Galois Counter MAC (GMAC).</li>
</ul>
</li>
</ul>
</li>
<li>Padding mode (see <a class="el" href="group__cxi__mech__pad.html">Padding Modes</a>):<ul>
<li>DES, AES:<ul>
<li>CXI_MECH_PAD_NONE : Don't apply any padding (data length has to be a multiple of algorithms block size).</li>
<li>CXI_MECH_PAD_PKCS5 : Apply padding according to PKCS#5.</li>
<li>CXI_MECH_PAD_RANDOM : Apply random padding.</li>
<li>CXI_MECH_PAD_ISO7816 : Apply padding according to ISO 7816.</li>
<li>CXI_MECH_PAD_ZERO : Pad with zeros up to block length.</li>
</ul>
</li>
<li>RSA:<ul>
<li>CXI_MECH_PAD_NONE : Don't apply any padding (data length has to be smaller than length of modulus).</li>
<li>CXI_MECH_PAD_PKCS1 : Apply padding according to PKCS#1-v1_5 (block type 1).</li>
<li>CXI_MECH_PAD_X9_31 : Apply padding according to ANSI X9.31.</li>
<li>CXI_MECH_PAD_PSS : Apply padding according to PKCS#1-v2.1 (RSASSA-PSS).</li>
</ul>
</li>
</ul>
</li>
<li>Hash algorithm (see <a class="el" href="group__cxi__mech__hash.html">Hash Algorithms</a>)</li>
<li>HMAC mode:<ul>
<li>DES, AES:<ul>
<li>CXI_MECH_MODE_HMAC : Calculate hash based MAC. </li>
</ul>
</li>
</ul>
</li>
</ul>
</td></tr>
    <tr><td class="paramname">data</td><td>Hash value to be signed or data to be MAC'ed. </td></tr>
    <tr><td class="paramname">iv</td><td>Initialization vector used to chain cipher blocks or digest information to continue a multipart hash calculation.<br/>
 If no initialization vector is given (NULL_REF) a vector of zeroized bytes is used.<br/>
 For GMAC on non-final calls, this parameter contains intermediate values. On GMAC's final signing call, if the CryptoServer generated an internal IV, that IV is returned in this parameter.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Signature (asymmetric algorithms), MAC, HMAC, digest information (in case CXI_FLAG_HASH_PART was set in the command flags) or CMAC/GMAC intermediate value (if CXI_FLAG_CRYPT_FINAL was not set). </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname"><a class="el" href="classcxi_1_1_exception.html" title="Constructs an exception object.">cxi::Exception</a></td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Example:</dt><dd>The following example illustrates how to create and verify a ECDSA signature with locally computed hash: <div class="fragment"><div class="line">...</div>
<div class="line"></div>
<div class="line"><span class="comment">// create ECDSA key</span></div>
<div class="line">PropertyList keyTemplate;</div>
<div class="line">keyTemplate.setAlgo(<a class="code" href="group__cxi__algos.html#ga7a1f3fd1c0c177d73f3cb0147e627b2b" title="ECDSA.">CXI_KEY_ALGO_ECDSA</a>);</div>
<div class="line">keyTemplate.set(<a class="code" href="group__cxi__props.html#ga9bcb663978b0a0e25620ff4612e0cf6d" title="Elliptic curve name (string) or domain parameter (OID or ASN.1 definition) [array&lt;byte&gt;].">CXI_PROP_KEY_EC_CURVE</a>, Property(<span class="stringliteral">&quot;NIST-P192&quot;</span>));</div>
<div class="line">keyTemplate.setGroup(<span class="stringliteral">&quot;MyGroup&quot;</span>);</div>
<div class="line">keyTemplate.setName(<span class="stringliteral">&quot;EC_DEMO_KEY&quot;</span>);</div>
<div class="line"></div>
<div class="line">Key ecKey = cxi-&gt;key_generate(<a class="code" href="group__cxi__flags.html#ga4e7e1d2397745c8a7024496ba451a64e" title="Overwrite key if already existing.">CXI_FLAG_KEY_OVERWRITE</a>, keyTemplate, 0);</div>
<div class="line"></div>
<div class="line"><span class="comment">// export public key</span></div>
<div class="line">Blob keyBlob = cxi-&gt;key_export(<a class="code" href="group__cxi__blobs.html#ga6ae65c18f1ab1030642dd72a7ab09c63" title="Simple blob format (Utimaco)">CXI_KEY_BLOB_SIMPLE</a>|<a class="code" href="group__cxi__types.html#gae2b651cc5c029d46fb36708f9c6b01ea" title="Public key object.">CXI_KEY_TYPE_PUBLIC</a>, ecKey, NULL_REF(Key), 0);</div>
<div class="line">keyBlob.getPublic().xtrace(<span class="stringliteral">&quot;Public Key&quot;</span>);</div>
<div class="line"></div>
<div class="line">ByteArray data = <span class="stringliteral">&quot;Hope!Progress!&quot;</span>;</div>
<div class="line"></div>
<div class="line"><span class="comment">// compute hash</span></div>
<div class="line">Hash hash;</div>
<div class="line">hash.init(<a class="code" href="group__cxi__mech__hash.html#gaf3d4be27ef0e545156ec238d9980858b" title="SHA256.">CXI_MECH_HASH_ALGO_SHA256</a>);</div>
<div class="line">hash.update(data);</div>
<div class="line">hash.final();</div>
<div class="line">hash.xtrace(<span class="stringliteral">&quot;hash&quot;</span>);</div>
<div class="line"></div>
<div class="line"><span class="comment">// sign hash</span></div>
<div class="line">MechanismParameter mechParam = MechanismParameter(0);</div>
<div class="line">ByteArray sign = cxi-&gt;sign(0, ecKey, mechParam, hash);</div>
<div class="line">sign.xtrace(<span class="stringliteral">&quot;sign&quot;</span>);</div>
<div class="line"></div>
<div class="line"><span class="comment">// verify signature</span></div>
<div class="line">cxi-&gt;verify(0, ecKey, mechParam, hash, sign);</div>
<div class="line"></div>
<div class="line">...</div>
</div><!-- fragment --></dd></dl>
<dl class="section user"><dt>Example:</dt><dd>The following example illustrates how to create and verify a ECDSA signature over data that is hashed on the CryptoServer: <div class="fragment"><div class="line">...</div>
<div class="line"></div>
<div class="line"><span class="comment">// create ECDSA key</span></div>
<div class="line">PropertyList keyTemplate;</div>
<div class="line">keyTemplate.setAlgo(<a class="code" href="group__cxi__algos.html#ga7a1f3fd1c0c177d73f3cb0147e627b2b" title="ECDSA.">CXI_KEY_ALGO_ECDSA</a>);</div>
<div class="line">keyTemplate.set(<a class="code" href="group__cxi__props.html#ga9bcb663978b0a0e25620ff4612e0cf6d" title="Elliptic curve name (string) or domain parameter (OID or ASN.1 definition) [array&lt;byte&gt;].">CXI_PROP_KEY_EC_CURVE</a>, Property(<span class="stringliteral">&quot;NIST-P192&quot;</span>));</div>
<div class="line">keyTemplate.setGroup(<span class="stringliteral">&quot;MyGroup&quot;</span>);</div>
<div class="line">keyTemplate.setName(<span class="stringliteral">&quot;EC_DEMO_KEY&quot;</span>);</div>
<div class="line"></div>
<div class="line">Key ecKey = cxi-&gt;key_generate(<a class="code" href="group__cxi__flags.html#ga4e7e1d2397745c8a7024496ba451a64e" title="Overwrite key if already existing.">CXI_FLAG_KEY_OVERWRITE</a>, keyTemplate, 0);</div>
<div class="line"></div>
<div class="line">ByteArray data = <span class="stringliteral">&quot;Hope!Progress!&quot;</span>;</div>
<div class="line"></div>
<div class="line"><span class="comment">// create signature</span></div>
<div class="line">MechanismParameter mechParam = MechanismParameter(<a class="code" href="group__cxi__mech__hash.html#gaf3d4be27ef0e545156ec238d9980858b" title="SHA256.">CXI_MECH_HASH_ALGO_SHA256</a>);</div>
<div class="line">ByteArray sign = cxi-&gt;sign(<a class="code" href="group__cxi__flags.html#gad7f77a5ac0b3ff2896d1713fec22814a" title="Given data has to be hashed.">CXI_FLAG_HASH_DATA</a>, ecKey, mechParam, data);</div>
<div class="line">sign.xtrace(<span class="stringliteral">&quot;sign&quot;</span>);</div>
<div class="line"></div>
<div class="line"><span class="comment">// verify signature</span></div>
<div class="line"><span class="keywordtype">bool</span> result = cxi-&gt;verify(<a class="code" href="group__cxi__flags.html#gad7f77a5ac0b3ff2896d1713fec22814a" title="Given data has to be hashed.">CXI_FLAG_HASH_DATA</a>, ecKey, mechParam, data, sign);</div>
<div class="line"></div>
<div class="line"><span class="keywordflow">if</span> (result == <span class="keyword">false</span>)</div>
<div class="line">  printf(<span class="stringliteral">&quot;signature verification failed\n&quot;</span>);</div>
<div class="line"></div>
<div class="line">...</div>
</div><!-- fragment --> </dd></dl>

</div>
</div>
<a class="anchor" id="ac876fa351943b494ebb5af693024ad38"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; <a class="el" href="classcxi_1_1_byte_array.html">ByteArray</a> &gt; bulk_sign </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classcxi_1_1_key.html">Key</a> &amp;&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classcxi_1_1_mechanism_parameter.html">MechanismParameter</a> &amp;&#160;</td>
          <td class="paramname"><em>mechParam</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="classcxi_1_1_byte_array.html">ByteArray</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Digitally signs up to 16 hash values in one operation.<br/>
 The function utilizes a cryptographic accelerator if present on the target hardware and therefore speeds up RSA and ECDSA calculations.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">key</td><td>RSA or ECDSA Key to be used to create the signature </td></tr>
    <tr><td class="paramname">mechParam</td><td>XOR combination of mechanism parameter (see <a class="el" href="group__cxi__mechs.html">Mechanism Parameter</a>):<ul>
<li>Padding mode (see <a class="el" href="group__cxi__mech__pad.html">Padding Modes</a>)</li>
<li>Hash algorithm (see <a class="el" href="group__cxi__mech__hash.html">Hash Algorithms</a>)</li>
<li>Output format (see <a class="el" href="group__cxi__mech__format.html">Format Parameter</a>) (Note that ECDSA bulk signing does not currently support ASN1 output!) </li>
</ul>
</td></tr>
    <tr><td class="paramname">data</td><td>Array (vector) of hash values to be signed</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Array (vector) of signatures </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname"><a class="el" href="classcxi_1_1_exception.html" title="Constructs an exception object.">cxi::Exception</a></td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="adf47e1a7fc3bb211009cdf3be5e7cbeb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool verify </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classcxi_1_1_key.html">Key</a> &amp;&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classcxi_1_1_mechanism_parameter.html">MechanismParameter</a> &amp;&#160;</td>
          <td class="paramname"><em>mechParam</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classcxi_1_1_byte_array.html">ByteArray</a> &amp;&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classcxi_1_1_byte_array.html">ByteArray</a> &amp;&#160;</td>
          <td class="paramname"><em>signature</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classcxi_1_1_byte_array.html">ByteArray</a> &amp;&#160;</td>
          <td class="paramname"><em>iv</em> = <code>NULL_REF(<a class="el" href="classcxi_1_1_byte_array.html">ByteArray</a>)</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Verifies a digital signature, <em>Message Authentication Code</em> (MAC) or hash based MAC (HMAC).</p>
<p>The function supports cipher block chaining on MACs and multipart calculation on HMACs.<br/>
 On MAC verification the returned IV can be used as input IV on the next block.<br/>
 On HMAC calculation the function can be instructed not to finalize the HMAC but return the intermediate HMAC digest information that can be used as input ('IV') for the next block.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">flags</td><td>Command flags:<ul>
<li>CXI_FLAG_HASH_PART: don't finalize HMAC calculation but return intermediate HMAC digest information to continue a multipart calculation on next function call.</li>
<li>CXI_FLAG_HASH_DATA: given data has to be hashed before comparison (asymmetric algorithms only).</li>
<li>CXI_FLAG_CRYPT_FINAL: Finalize CMAC or GMAC calculation and return the resulting MAC (AES-CMAC/GMAC only). </li>
</ul>
</td></tr>
    <tr><td class="paramname">key</td><td>Key to be used to verify the signature, MAC or HMAC.<br/>
 The key usage property has to contain the CXI_KEY_USAGE_VERIFY value. </td></tr>
    <tr><td class="paramname">mechParam</td><td>XOR combination of mechanism parameter (see <a class="el" href="classcxi_1_1_mechanism_parameter.html">cxi::MechanismParameter</a>):<ul>
<li>Chaining mode (see <a class="el" href="group__cxi__mech__chain.html">Chaining Modes</a>):<ul>
<li>DES:<ul>
<li>CXI_MECH_CHAIN_CBC : Use 'Cipher Block Chaining' mode.</li>
<li>CXI_MECH_CHAIN_CBC_RETAIL: Calculate a CBC Retail MAC according to ISO 9797 (often used in german payment systems).</li>
<li>CXI_MECH_CHAIN_CFB_RETAIL: Calculate a CFB Retail MAC (often used in german payment systems).</li>
</ul>
</li>
<li>AES:<ul>
<li>CXI_MECH_CHAIN_CBC : Use 'Cipher Block Chaining' mode.</li>
<li>CXI_MECH_CHAIN_CMAC : Calculate a CMAC according to NIST-SP800-38B.</li>
<li>CXI_MECH_CHAIN_GCM: Calculate Galois Counter MAC (GMAC).</li>
</ul>
</li>
</ul>
</li>
<li>Padding mode (see <a class="el" href="group__cxi__mech__pad.html">Padding Modes</a>):<ul>
<li>DES, AES:<ul>
<li>CXI_MECH_PAD_NONE : Don't apply any padding (data length has to be a multiple of algorithms block size).</li>
<li>CXI_MECH_PAD_PKCS5 : Apply padding according to PKCS#5.</li>
<li>CXI_MECH_PAD_RANDOM : Apply random padding.</li>
<li>CXI_MECH_PAD_ISO7816 : Apply padding according to ISO 7816.</li>
<li>CXI_MECH_PAD_ZERO : Pad with zeros up to block length.</li>
</ul>
</li>
<li>RSA:<ul>
<li>CXI_MECH_PAD_NONE : Don't apply any padding (data length has to be smaller than length of modulus).</li>
<li>CXI_MECH_PAD_PKCS1 : Apply padding according to PKCS#1-v1_5 (block type 1).</li>
<li>CXI_MECH_PAD_X9_31 : Apply padding according to ANSI X9.31.</li>
<li>CXI_MECH_PAD_PSS : Apply padding according to PKCS#1-v2.1 (RSASSA-PSS).</li>
</ul>
</li>
</ul>
</li>
<li>Hash algorithm (see <a class="el" href="group__cxi__mech__hash.html">Hash Algorithms</a>)</li>
<li>HMAC mode:<ul>
<li>DES, AES:<ul>
<li>CXI_MECH_MODE_HMAC : Calculate hash based MAC. </li>
</ul>
</li>
</ul>
</li>
</ul>
</td></tr>
    <tr><td class="paramname">data</td><td>Reference hash to be compared (asym. algorithms) or data to be MAC'ed for comparison. </td></tr>
    <tr><td class="paramname">signature</td><td>Signature, MAC or HMAC to be verified In case of cipher block chaining (symmetric keys), the MAC to be compared has to be given with the last chaining block.<br/>
 In case of a multipart HMAC calculation the HMAC to be compared has to be given with the last part.<br/>
 If no MAC/HMAC is given, the updated MAC/HMAC is returned but no comparison takes place. </td></tr>
    <tr><td class="paramname">iv</td><td>Initialization vector used to chain cipher blocks or HMAC digest information used to calculate a multipart HMAC.<br/>
<ul>
<li>If no initialization vector is given (NULL_REF) a vector of zeroized bytes is used.</li>
<li>The given value will be overwritten on return of the function.</li>
<li>The initialization vector has to be absent for asymmetric algorithms.</li>
<li>For GMAC on non-final calls, this parameter contains intermediate values.</li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if verification succeeded, otherwise false </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname"><a class="el" href="classcxi_1_1_exception.html" title="Constructs an exception object.">cxi::Exception</a></td><td>in case of any other error than verification failure. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="aa633feee24c18e738b0ebe1f75fa60dd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classcxi_1_1_byte_array.html">ByteArray</a> rnd_gen </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>mech</em> = <code>-1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Generates random bytes </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">len</td><td>Number of random bytes to be generated </td></tr>
    <tr><td class="paramname">mech</td><td>Generation mode:<ul>
<li>CXI_MECH_RND_REAL : use hardware (real) random number generator (better, slower)</li>
<li>CXI_MECH_RND_PSEUDO : use deterministic (pseudo) random number generator (faster)</li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>byte Array with random bytes </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname"><a class="el" href="classcxi_1_1_exception.html" title="Constructs an exception object.">cxi::Exception</a></td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a6b70e9293a6ede7a494cacf4d13a0072"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classcxi_1_1_byte_array.html">ByteArray</a> hash_compute </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classcxi_1_1_mechanism_parameter.html">MechanismParameter</a> &amp;&#160;</td>
          <td class="paramname"><em>mechParam</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classcxi_1_1_byte_array.html">ByteArray</a> &amp;&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classcxi_1_1_byte_array.html">ByteArray</a> &amp;&#160;</td>
          <td class="paramname"><em>info</em> = <code>NULL_REF(<a class="el" href="classcxi_1_1_byte_array.html">ByteArray</a>)</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classcxi_1_1_key.html">Key</a> &amp;&#160;</td>
          <td class="paramname"><em>key</em> = <code>NULL_REF(<a class="el" href="classcxi_1_1_key.html">Key</a>)</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function computes a hash or hash based MAC (HMAC) over the given data.</p>
<dl class="section note"><dt>Note</dt><dd>In contrast to the <a class="el" href="classcxi_1_1_hash.html" title="Computes hash values.">Hash</a> class, which calculates the hash locally, the hash computation takes place on the CryptoServer.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">flags</td><td>Command flags:<br/>
<ul>
<li>CXI_FLAG_HASH_PART: Don't finalize hash but return hash digest information to be continued on next call (multipart hash calculation). </li>
</ul>
</td></tr>
    <tr><td class="paramname">mechParam</td><td>XOR combination of hash mode (see <a class="el" href="group__cxi__mech__mode.html">Mode Parameter</a>) and hash algorithm (see <a class="el" href="group__cxi__mech__hash.html">Hash Algorithms</a>). </td></tr>
    <tr><td class="paramname">data</td><td>Plain data to be hashed. </td></tr>
    <tr><td class="paramname">info</td><td>Optional hash digest information to continue a multipart hash calculation or NULL_REF(ByteArray) to start a new hash calculation. </td></tr>
    <tr><td class="paramname">key</td><td>Optional key:<ul>
<li>on Hash calculation: Secret key whose key components should be hashed.</li>
<li>on HMAC calculation: Secret key to be used for HMAC calculation.</li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Computed hash or HMAC value (flags == 0) or hash digest information (flags == CXI_FLAG_HASH_PART).</dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname"><a class="el" href="classcxi_1_1_exception.html" title="Constructs an exception object.">cxi::Exception</a></td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a13632fb9601103b404da667112daf0a6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classcxi_1_1_byte_array.html">ByteArray</a> secret_agree </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classcxi_1_1_key.html">Key</a> &amp;&#160;</td>
          <td class="paramname"><em>privateKey</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classcxi_1_1_key.html">Key</a> &amp;&#160;</td>
          <td class="paramname"><em>publicKey</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classcxi_1_1_mechanism_parameter.html">MechanismParameter</a> &amp;&#160;</td>
          <td class="paramname"><em>mechParam</em> = <code>NULL_REF(<a class="el" href="classcxi_1_1_mechanism_parameter.html">MechanismParameter</a>)</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function calculates a shared secret from two ECDH or ECDSA keys as described in TR-03111.</p>
<p>The algorithm is based on a point multiplication, which takes the private part of the first key and the public part of the second key as input parameter. The returned secret consists either of the complete resulting point (x and y coordinate) or only of its x- coordinate in case CXI_MECH_FORMAT_X was given in the mechanism parameters. The function returns either the plain secret value or encrypts the secret with the CryptoServer's MBK in case CXI_FLAG_ENCRYPT_SECRET was given in the command flags.</p>
<dl class="section note"><dt>Note</dt><dd>The secret value (either plain or encrypted) can be used as input to the ComputeHash function.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">flags</td><td>Command flags:<br/>
<ul>
<li>CXI_FLAG_ENCRYPT_SECRET: return MBK encrypted secret value (default)</li>
<li>0: return unencrypted secret value </li>
</ul>
</td></tr>
    <tr><td class="paramname">privateKey</td><td>Private part of key #1. The key usage property has to contain the CXI_KEY_USAGE_DERIVE value. </td></tr>
    <tr><td class="paramname">publicKey</td><td>Public part of key #2.<ul>
<li>note This value may also be given in the mechanism parameters. </li>
</ul>
</td></tr>
    <tr><td class="paramname">mechParam</td><td>Mechanism Parameters:<ul>
<li>Mechanism:<ul>
<li>CXI_MECH_FORMAT_X: return only x-coordinate of secret point (default).</li>
<li>0: return x and y coordinate of secret point.</li>
</ul>
</li>
<li>Public Key: X9.42 encoded public part of key #2 (optional, if not given in the publicKey parameter) </li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The secret value (either x and y coordinate or x-coordinate only). The secret value is encrypted with the CryptoServer's MBK if CXI_FLAG_ENCRYPT_SECRET was given in the command flags (tag 'SB'). Otherwise the plain secret will be returned (tag 'DA').</dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname"><a class="el" href="classcxi_1_1_exception.html" title="Constructs an exception object.">cxi::Exception</a></td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ac348604a4d6f57b2060bff9370b68c90"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classcxi_1_1_byte_array.html">ByteArray</a> crypt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classcxi_1_1_key.html">Key</a> &amp;&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classcxi_1_1_mechanism_parameter.html">MechanismParameter</a> &amp;&#160;</td>
          <td class="paramname"><em>mechParam</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classcxi_1_1_byte_array.html">ByteArray</a> &amp;&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classcxi_1_1_byte_array.html">ByteArray</a> &amp;&#160;</td>
          <td class="paramname"><em>iv</em> = <code>NULL_REF(<a class="el" href="classcxi_1_1_byte_array.html">ByteArray</a>)</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="deprecated"><dt><b><a class="el" href="deprecated.html#_deprecated000003">Deprecated:</a></b></dt><dd>replaced by: <a class="el" href="classcxi_1_1_byte_array.html" title="Encapsulates an array of primitive type char in an object and provides methods to operate on binary d...">ByteArray</a> crypt(int flags, Key &amp;key, MechanismParameter &amp;mechParam, ByteArray &amp;data, ByteArray &amp;iv, ByteArray &amp;tag, ByteArray &amp;tag_in) </dd></dl>

</div>
</div>
<a class="anchor" id="a2e92997c336ff5c9eb48c468ad709b88"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classcxi_1_1_byte_array.html">ByteArray</a> sign </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classcxi_1_1_key.html">Key</a> &amp;&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classcxi_1_1_mechanism_parameter.html">MechanismParameter</a> &amp;&#160;</td>
          <td class="paramname"><em>mechParam</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classcxi_1_1_byte_array.html">ByteArray</a> &amp;&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classcxi_1_1_byte_array.html">ByteArray</a> &amp;&#160;</td>
          <td class="paramname"><em>iv</em> = <code>NULL_REF(<a class="el" href="classcxi_1_1_byte_array.html">ByteArray</a>)</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="deprecated"><dt><b><a class="el" href="deprecated.html#_deprecated000004">Deprecated:</a></b></dt><dd>replaced by: <a class="el" href="classcxi_1_1_byte_array.html" title="Encapsulates an array of primitive type char in an object and provides methods to operate on binary d...">ByteArray</a> Cxi::sign(int flags, Key &amp;key, MechanismParameter &amp;mechParam, ByteArray &amp;data, ByteArray &amp;iv) </dd></dl>

</div>
</div>
<a class="anchor" id="a7e73d06ec4b8c681b9b12927180d4e63"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void verify </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classcxi_1_1_key.html">Key</a> &amp;&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classcxi_1_1_mechanism_parameter.html">MechanismParameter</a> &amp;&#160;</td>
          <td class="paramname"><em>mechParam</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classcxi_1_1_byte_array.html">ByteArray</a> &amp;&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classcxi_1_1_byte_array.html">ByteArray</a> &amp;&#160;</td>
          <td class="paramname"><em>signature</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classcxi_1_1_byte_array.html">ByteArray</a> &amp;&#160;</td>
          <td class="paramname"><em>iv</em> = <code>NULL_REF(<a class="el" href="classcxi_1_1_byte_array.html">ByteArray</a>)</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="deprecated"><dt><b><a class="el" href="deprecated.html#_deprecated000005">Deprecated:</a></b></dt><dd>replaced by: bool Cxi::verify(int flags, Key &amp;key, MechanismParameter &amp;mechParam, ByteArray &amp;data, ByteArray &amp;signature, ByteArray &amp;iv) </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Mar 21 2017 18:12:34 for CXI by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.2
</small></address>
</body>
</html>
