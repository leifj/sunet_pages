<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>JCE Provider: CryptoServer JCE Provider</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">JCE Provider
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.2 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">CryptoServer JCE Provider </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><table  style="border-style:none;border:0px;margin-left:auto;margin-right:auto;">
<tr style="border-style:none;border:0px;vertical-align:top;">
<td style="border-style:none;border:0px;font-weight:bold;">Copyright: </td><td style="border-style:none;border:0px;">2010 by Utimaco IS GmbH <br/>
 Office Aachen <br/>
 Germanusstrasse 4 <br/>
 D-52080 Aachen  </td></tr>
<tr style="border-style:none;border:0px;">
<td style="border-style:none;border:0px;font-weight:bold;">Phone: </td><td style="border-style:none;border:0px;">+49 241-1696-200  </td></tr>
<tr style="border-style:none;border:0px;">
<td style="border-style:none;border:0px;font-weight:bold;">Telefax: </td><td style="border-style:none;border:0px;">+49 241-1696-222  </td></tr>
<tr style="border-style:none;border:0px;">
<td style="border-style:none;border:0px;font-weight:bold;">Internet: </td><td style="border-style:none;border:0px;"><a href="http://www.utimaco.com">www.utimaco.com</a>  </td></tr>
<tr style="border-style:none;border:0px;">
<td style="border-style:none;border:0px;font-weight:bold;">Mail: </td><td style="border-style:none;border:0px;"><a href="#" onclick="location.href='mai'+'lto:'+'sup'+'po'+'rt-'+'cs'+'@ut'+'im'+'aco'+'.c'+'om'; return false;">support-cs@utimaco.com</a>  </td></tr>
<tr style="border-style:none;border:0px;">
<td style="border-style:none;border:0px;font-weight:bold;">Document-Number:  </td><td style="border-style:none;border:0px;">20100001  </td></tr>
<tr style="border-style:none;border:0px;">
<td style="border-style:none;border:0px;font-weight:bold;">Document-Version:  </td><td style="border-style:none;border:0px;">1.2.0  </td></tr>
<tr style="border-style:none;border:0px;">
<td style="border-style:none;border:0px;font-weight:bold;">Date: </td><td style="border-style:none;border:0px;">13.01.2017  </td></tr>
<tr style="border-style:none;border:0px;">
<td style="border-style:none;border:0px;font-weight:bold;">Author </td><td style="border-style:none;border:0px;">Dipl.-Ing. (FH) Sebastian Pranzkat   </td></tr>
<tr>
<td style="border-style:none;border:0px;vertical-align:top;font-weight:bold;">All rights reserved: </td><td style="border-style:none;border:0px;">No part of this documentation may be <br/>
 reproduced or processed, copied, <br/>
 distributed by a retrieval system <br/>
 in any form (print, photocopies <br/>
 or any other means) without prior <br/>
 written consent of Utimaco IS GmbH. <br/>
 <br/>
 Utimaco IS GmbH reserves the right to <br/>
 modify or supplement the documentation at any <br/>
 time without previous announcement. <br/>
 Utimaco IS GmbH is not liable for misprints <br/>
 and damage resulting from this. <br/>
   </td></tr>
</table>
<h1><a class="anchor" id="intro"></a>
Introduction</h1>
<hr/>
<p>This document describes the Java Cryptographic Engine Provider (JCE) for Utimaco IS hardware security module CryptoServer.</p>
<p>JCE is a cryptographic extension to Oracle's Java framework. It defines a unified interface between an application and a cryptographic device. With this concept a Java application must not know about specific drivers to access the CryptoServer directly.</p>
<p>In order to use the CryptoServer JCE provider, the firmware module <b>CXI</b> must be loaded into the CryptoServer and the CryptoServer JCE provider must be installed on the host system.</p>
<h1><a class="anchor" id="install"></a>
Installation</h1>
<hr/>
<h2><a class="anchor" id="requirements"></a>
Requirements</h2>
<p>The CryptoServer JCE Provider needs the runtime environment of Java Framework 1.6 or higher.</p>
<p>In addition the Java security policy has to be configured to support unlimited algorithm strength. To achieve this, the appropriate jurisdiction policy files have to be installed (see Chapter <a class="el" href="index.html#provInstall">Provider Installation</a>).</p>
<h2><a class="anchor" id="reqFirmMod"></a>
Required firmware modules</h2>
<p>To work with JCE, your CryptoServer requires the CXI firmware module and its dependencies. All necessary firmware modules should already be installed on your CryptoServer. For more information about firmware packages, see <a class="el" href="ref.html#adminGuide">[1]</a>.</p>
<h2><a class="anchor" id="reqClusterOp"></a>
Requirements for cluster operation (failover)</h2>
<p>The Utimaco CryptoServer JCE Provider supports a failover mechanism if two or more CryptoServer have been configured as a cluster (see Chapter <a class="el" href="index.html#configFile">Configuration File</a>). If command execution fails on one device the provider automatically switches to another device, connects and authenticates to it and tries to execute the command on that device. The provider consecutively tries to execute the command on one device at a time and throws an exception if all devices fail.</p>
<p>In order to use the failover feature the following conditions must be fulfilled:</p>
<ul>
<li>the Master Backup Key (MBK) has to be the same on all devices (see <a class="el" href="ref.html#adminGuide">[1]</a>).</li>
<li>the same user with authentication mechanism <em>HMAC-password</em> and identical password has to be created on all devices.</li>
<li>all devices have to be added to the <em>Device</em> parameter of the configuration file (<code>CryptoServerJCE.cfg</code>).</li>
</ul>
<table  border="0" cellpadding="5" bgcolor="#FFEEEE">
<tr>
<td><dl class="section note"><dt>Note</dt><dd><b>The failover mechanism relies on a cluster of CryptoServers that are exactly in the same state. <br/>
 In particular, all CryptoServers have to share the same keys, otherwise cryptographic operations (e.g. signature creation) may fail, because required keys are no longer found after having switched to a new device.</b>  </dd></dl>
</td></tr>
</table>
<h2><a class="anchor" id="provInstall"></a>
Provider Installation</h2>
<p>In order to install the CryptoServer JCE provider statically on the system the following steps have to be performed:</p>
<ol type="1">
<li>Copy the file <code>CryptoServerJCE.jar</code> to the directory <code>&lt;java-home&gt;/lib/ext</code> </li>
<li>Register the CryptoServer JCE provider by adding the following line to the file <code>java.security</code>, located in <code>&lt;java-home&gt;/lib/security</code>: <div class="fragment"><div class="line">security.provider.&lt;n&gt;=CryptoServerJCE.CryptoServerProvider &lt;configuration-file&gt;</div>
</div><!-- fragment --><ul>
<li><code>&lt;n&gt;</code>: denotes the preference order of the provider</li>
<li><code>&lt;configuration-file&gt;</code>: optionally defines the path to a configuration file to be loaded by the provider</li>
</ul>
</li>
<li>Obtain the jurisdiction (unlimited strength) policy files from Oracle for your country and Java version:<ul>
<li><code>US_export_policy.jar</code> </li>
<li><code>local_policy.jar</code> </li>
</ul>
</li>
<li>Copy the jurisdiction policy files into the directory <code>&lt;java-home&gt;/lib/security</code>.</li>
</ol>
<p>Alternatively the CryptoServer JCE Provider can be used dynamically by simply copying the file <code>CryptoServerJCE.jar</code> to the <code>&lt;class-path&gt;</code> directory. In this case the above steps can be skipped.</p>
<h2><a class="anchor" id="configFile"></a>
Configuration File</h2>
<p>The CryptoServer JCE provider can read parameters from a configuration file. This file may contain the following parameter:</p>
<table  class="doxtable">
<tr>
<th>Parameter </th><th>Description </th><th>Default  </th></tr>
<tr>
<td>Device </td><td>Device address(es) to connect a single CryptoServer or a CryptoServer cluster (see below). </td><td>-  </td></tr>
<tr>
<td>Timeout </td><td>Specifies the maximum time in milliseconds to wait before a command is aborted if the device is not responding. </td><td>30000  </td></tr>
<tr>
<td>ConnectionTimeout </td><td>Specifies the maximum time in milliseconds to wait if a connection to the device cannot be established. </td><td>3000  </td></tr>
<tr>
<td>DefaultUser </td><td>Default user name to be used to authenticate to the CryptoServer </td><td>JCE  </td></tr>
<tr>
<td>KeyGroup </td><td>Key Group property to be set on generation and import of a key </td><td>-  </td></tr>
<tr>
<td>KeepSessionAlive </td><td>Keeps a session alive and prevents it from expiring after 15 minutes idle time. </td><td>0  </td></tr>
<tr>
<td>StoreKeysExternal </td><td>Store keys in external keystore </td><td>False  </td></tr>
<tr>
<td>KeyStorePath </td><td>Path to the external keystore </td><td>-  </td></tr>
<tr>
<td>LogFile </td><td>Path to logging file </td><td>-  </td></tr>
<tr>
<td>LogLevel </td><td>loglevel to be logged (0 = NONE; 1 = ERROR; 2 = WARNING; 3 = INFO; 4 = TRACE;) </td><td>2  </td></tr>
<tr>
<td>LogSize </td><td>Maximum size of logfile in kilobytes </td><td>10000  </td></tr>
</table>
<p>There are several possibilities to address the CryptoServer with the Device configuration parameter. Here are some examples:</p>
<table  class="doxtable">
<tr>
<th>Address </th><th>Description  </th></tr>
<tr>
<td><code>/dev/cs2</code>  </td><td>Local CryptoServer in a Linux system.  </td></tr>
<tr>
<td><code>PCI:0</code>  </td><td>Local CryptoServer in a Windows system.  </td></tr>
<tr>
<td><code>TCP:cslan01</code>  </td><td>Hostname of a CryptoServer LAN  </td></tr>
<tr>
<td><code>TCP:194.168.4.107</code>  </td><td>IP-Address of a CryptoServer LAN  </td></tr>
<tr>
<td><code>TCP:288@cslan01</code>  </td><td>Host name and port number of a CryptoServer LAN  </td></tr>
<tr>
<td><code>TCP:288@194.168.4.107</code>  </td><td>IP-Address and port number of a CryptoServer LAN  </td></tr>
</table>
<p>Example of the configuration file <code>CryptoServer.cfg:</code> </p>
<div class="fragment"><div class="line"><span class="preprocessor"># Configuration File for CryptoServer JCE Provider</span></div>
<div class="line"><span class="preprocessor"></span>Device = 192.168.4.1</div>
<div class="line">ConnectionTimeout = 4000</div>
<div class="line">Timeout = 20000</div>
<div class="line"></div>
<div class="line">DefaultUser = paul</div>
<div class="line">KeyGroup = BusUnit01</div>
<div class="line">KeepSessionAlive = 1</div>
<div class="line"></div>
<div class="line">StoreKeysExternal = <span class="keyword">false</span></div>
<div class="line">KeyStorePath = C:/&lt;user directory&gt;/JCE.sdb</div>
<div class="line"></div>
<div class="line">LogFile = C:/&lt;user directory&gt;/CryptoServerJCE.log</div>
<div class="line">LogLevel = 2</div>
<div class="line">LogSize = 10000</div>
</div><!-- fragment --><p>If multiple devices should be addressed the devices have to be separated with a space character. The parameter definition may span across multiple lines, each line has to be terminated by a backslash charter (\).</p>
<p>Example of the configuration-file <code>CryptoServer.cfg</code> in case of a cluster:</p>
<div class="fragment"><div class="line"><span class="preprocessor"># Configuration File for CryptoServer JCE Provider</span></div>
<div class="line"><span class="preprocessor"></span>Device = 192.168.4.1 \</div>
<div class="line">         192.168.4.2 \</div>
<div class="line">         PCI:0</div>
<div class="line">ConnectionTimeout = 3000</div>
<div class="line">Timeout = 20000</div>
<div class="line"></div>
<div class="line">DefaultUser = paul</div>
<div class="line">KeyGroup = BusUnit01</div>
<div class="line">KeepSessionAlive = 1</div>
<div class="line"></div>
<div class="line">StoreKeysExternal = <span class="keyword">false</span></div>
<div class="line">KeyStorePath = C:/&lt;user directory&gt;/JCE.sdb</div>
<div class="line"></div>
<div class="line">LogFile = C:/&lt;user directory&gt;/CryptoServerJCE.log</div>
<div class="line">LogLevel = 2</div>
<div class="line">LogSize = 10000</div>
</div><!-- fragment --><h2><a class="anchor" id="locConfFile"></a>
Location of the Configuration File</h2>
<p>The location of the configuration file is evaluated by the CryptoServer JCE Provider using the following search order:</p>
<ol type="1">
<li>Path and name of the configuration file are given as parameter in the file java.security, i.e.: <div class="fragment"><div class="line">security.provider.7=CryptoServerJCE.CryptoServerProvider d:/config/CryptoServer.cfg</div>
</div><!-- fragment --></li>
<li>Path and name of the configuration file are given within the environment variable <em>CRYPTOSERVER_JCE_CONFIG</em>.</li>
<li>A configuration file named <code>CryptoServer.cfg</code> is placed into the user's home directory.</li>
</ol>
<h1><a class="anchor" id="suppSrv"></a>
Supported Services</h1>
<hr/>
<h2><a class="anchor" id="sig"></a>
Signatures</h2>
<table  class="doxtable">
<tr>
<th>Algorithm </th><th>Padding Modes  </th></tr>
<tr>
<td>SHA1withRSA </td><td>PKCS1, PSS  </td></tr>
<tr>
<td>SHA224withRSA </td><td>PKCS1, PSS  </td></tr>
<tr>
<td>SHA256withRSA </td><td>PKCS1, PSS  </td></tr>
<tr>
<td>SHA384withRSA </td><td>PKCS1, PSS  </td></tr>
<tr>
<td>SHA512withRSA </td><td>PKCS1, PSS  </td></tr>
<tr>
<td>SHA3-224withRSA </td><td>PKCS1, PSS  </td></tr>
<tr>
<td>SHA3-256withRSA </td><td>PKCS1, PSS  </td></tr>
<tr>
<td>SHA3-384withRSA </td><td>PKCS1, PSS  </td></tr>
<tr>
<td>SHA3-512withRSA </td><td>PKCS1, PSS  </td></tr>
<tr>
<td>MD5withRSA </td><td>PKCS1, PSS  </td></tr>
<tr>
<td>SHA1withECDSA </td><td>-  </td></tr>
<tr>
<td>SHA224withECDSA </td><td>-  </td></tr>
<tr>
<td>SHA256withECDSA </td><td>-  </td></tr>
<tr>
<td>SHA384withECDSA </td><td>-  </td></tr>
<tr>
<td>SHA512withECDSA </td><td>-  </td></tr>
<tr>
<td>SHA3-224withECDSA </td><td>-  </td></tr>
<tr>
<td>SHA3-256withECDSA </td><td>-  </td></tr>
<tr>
<td>SHA3-384withECDSA </td><td>-  </td></tr>
<tr>
<td>SHA3-512withECDSA </td><td>-  </td></tr>
<tr>
<td>MD5withECDSA </td><td>-  </td></tr>
<tr>
<td>SHA1withDSA </td><td>-  </td></tr>
</table>
<h2><a class="anchor" id="keyPairGen"></a>
KeyPairGenerator</h2>
<table  class="doxtable">
<tr>
<th>Algorithm  </th></tr>
<tr>
<td>RSA  </td></tr>
<tr>
<td>EC  </td></tr>
<tr>
<td>DSA  </td></tr>
</table>
<h2><a class="anchor" id="keyFact"></a>
KeyFactory</h2>
<table  class="doxtable">
<tr>
<th>Algorithm  </th></tr>
<tr>
<td>RSA  </td></tr>
<tr>
<td>EC  </td></tr>
<tr>
<td>DSA  </td></tr>
</table>
<h2><a class="anchor" id="secretKeyFact"></a>
SecretKeyFactory</h2>
<table  class="doxtable">
<tr>
<th>Algorithm  </th></tr>
<tr>
<td>DES  </td></tr>
<tr>
<td>DESede  </td></tr>
<tr>
<td>AES  </td></tr>
</table>
<h2><a class="anchor" id="keyStore"></a>
KeyStore</h2>
<table  class="doxtable">
<tr>
<th>Algorithm  </th></tr>
<tr>
<td>CryptoServer  </td></tr>
</table>
<h2><a class="anchor" id="secRand"></a>
SecureRandom</h2>
<table  class="doxtable">
<tr>
<th>Algorithm  </th></tr>
<tr>
<td>SHA1PRNG  </td></tr>
<tr>
<td>CryptoServer  </td></tr>
</table>
<h2><a class="anchor" id="keyGen"></a>
KeyGenerator</h2>
<table  class="doxtable">
<tr>
<th>Algorithm  </th></tr>
<tr>
<td>DES  </td></tr>
<tr>
<td>DESede  </td></tr>
<tr>
<td>AES  </td></tr>
</table>
<h2><a class="anchor" id="cipher"></a>
Cipher</h2>
<table  class="doxtable">
<tr>
<th>Algorithm </th><th>Block Modes </th><th>Padding Modes  </th></tr>
<tr>
<td>DES </td><td>ECB, CBC </td><td>NONE, PKCS5, ISO10126  </td></tr>
<tr>
<td>DESede </td><td>ECB, CBC </td><td>NONE, PKCS5, ISO10126  </td></tr>
<tr>
<td>AES </td><td>ECB, CBC, OFB </td><td>NONE, PKCS5, ISO10126  </td></tr>
<tr>
<td>AES </td><td>GCM, CCM </td><td>NONE  </td></tr>
<tr>
<td>RSA </td><td>- </td><td>NONE, PKCS1, OAEP  </td></tr>
</table>
<h2><a class="anchor" id="mac"></a>
MAC</h2>
<table  class="doxtable">
<tr>
<th>Algorithm </th><th>Block Modes </th><th>Padding Modes  </th></tr>
<tr>
<td>DES </td><td>CBC </td><td>NONE  </td></tr>
<tr>
<td>DESwithPKCS5Padding </td><td>CBC </td><td>PKCS5  </td></tr>
<tr>
<td>DESwithISO10126Padding </td><td>CBC </td><td>ISO10126  </td></tr>
<tr>
<td>AES </td><td>CBC </td><td>NONE  </td></tr>
<tr>
<td>AESwithPKCS5Padding </td><td>CBC </td><td>PKCS5  </td></tr>
<tr>
<td>AESwithISO10126Padding </td><td>CBC </td><td>ISO10126  </td></tr>
</table>
<table  class="doxtable">
<tr>
<th>Algorithm </th><th>Modes  </th></tr>
<tr>
<td>DES </td><td>HmacMD5  </td></tr>
<tr>
<td>DES </td><td>HmacSHA1  </td></tr>
<tr>
<td>DES </td><td>HmacSHA224  </td></tr>
<tr>
<td>DES </td><td>HmacSHA256  </td></tr>
<tr>
<td>DES </td><td>HmacSHA384  </td></tr>
<tr>
<td>DES </td><td>HmacSHA512  </td></tr>
<tr>
<td>DES </td><td>HmacSHA3-224  </td></tr>
<tr>
<td>DES </td><td>HmacSHA3-256  </td></tr>
<tr>
<td>DES </td><td>HmacSHA3-384  </td></tr>
<tr>
<td>DES </td><td>HmacSHA3-512  </td></tr>
<tr>
<td>DES </td><td>HmacRMD160  </td></tr>
<tr>
<td>AES </td><td>HmacMD5  </td></tr>
<tr>
<td>AES </td><td>HmacSHA1  </td></tr>
<tr>
<td>AES </td><td>HmacSHA224  </td></tr>
<tr>
<td>AES </td><td>HmacSHA256  </td></tr>
<tr>
<td>AES </td><td>HmacSHA384  </td></tr>
<tr>
<td>AES </td><td>HmacSHA512  </td></tr>
<tr>
<td>AES </td><td>HmacSHA3-224  </td></tr>
<tr>
<td>AES </td><td>HmacSHA3-256  </td></tr>
<tr>
<td>AES </td><td>HmacSHA3-384  </td></tr>
<tr>
<td>AES </td><td>HmacSHA3-512  </td></tr>
<tr>
<td>AES </td><td>HmacRMD160  </td></tr>
</table>
<h2><a class="anchor" id="mesDig"></a>
MessageDigest</h2>
<table  class="doxtable">
<tr>
<th>Modes  </th></tr>
<tr>
<td>MD5  </td></tr>
<tr>
<td>SHA-1  </td></tr>
<tr>
<td>SHA-224  </td></tr>
<tr>
<td>SHA-256  </td></tr>
<tr>
<td>SHA-384  </td></tr>
<tr>
<td>SHA-512  </td></tr>
<tr>
<td>SHA3-224  </td></tr>
<tr>
<td>SHA3-256  </td></tr>
<tr>
<td>SHA3-384  </td></tr>
<tr>
<td>SHA3-512  </td></tr>
<tr>
<td>RMD-160  </td></tr>
</table>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.2
</small></address>
</body>
</html>
