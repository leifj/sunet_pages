<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" data-mc-search-type="Stem" data-mc-help-system-file-name="index.xml" data-mc-path-to-help-system="../../../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-medium="non-print" data-mc-toc-path="Syslog and SNMP Monitoring Guide|[%=System.LinkedTitle%]">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>Certificate Monitoring Daemon</title>
        <link href="../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" />
        <link href="../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" />
        <link href="../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" />
        <link href="../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" />
        <link href="../../Resources/TableStyles/Breadcrumbs.css" rel="stylesheet" />
        <link href="../../Resources/Stylesheets/Gemalto_Template.css" rel="stylesheet" />
        <link href="../../Resources/TableStyles/Page.css" rel="stylesheet" />
        <script src="../../../Resources/Scripts/custom.modernizr.js">
        </script>
        <script src="../../../Resources/Scripts/jquery.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.config.js">
        </script>
        <script src="../../../Resources/Scripts/foundation.min.js">
        </script>
        <script src="../../../Resources/Scripts/plugins.min.js">
        </script>
        <script src="../../../Resources/Scripts/MadCapAll.js">
        </script>
    </head>
    <body>
        <p class="MCWebHelpFramesetLink MCWebHelpFramesetLinkTop"><a href="../../../index.html#monitoring/components/certmonitord.htm">Show Navigation</a>
        </p>
        <!-- Remove this comment to enable syntax highlighting		
        <script type="text/javascript" src="../Stylesheets/SyntaxHilite/Prism/prism.js"></script>
-->
        <table style="width: 100%;border-spacing: 0px 0px;mc-table-style: url('../../Resources/TableStyles/Breadcrumbs.css');border-left-style: none;border-left-width: 1px;border-left-color: #000000;border-right-style: none;border-right-width: 1px;border-right-color: #000000;border-top-style: none;border-top-width: 0px;border-top-color: #000000;border-bottom-style: none;border-bottom-width: 0px;" class="TableStyle-Breadcrumbs" cellspacing="0">
            <col style="width: 41px;" class="TableStyle-Breadcrumbs-Column-Column1" />
            <col class="TableStyle-Breadcrumbs-Column-Column1" />
            <tbody>
                <tr class="TableStyle-Breadcrumbs-Body-Body1">
                    <th class="TableStyle-Breadcrumbs-BodyB-Column1-Body1">
                        <p class="home" style="font-weight: normal;"><a href="../../Home_network.htm">Home</a> &gt;
                        </p>
                    </th>
                    <th class="TableStyle-Breadcrumbs-BodyA-Column1-Body1">
                        <div class="nocontent">
                            <div class="MCBreadcrumbsBox_0 breadcrumbs" data-mc-breadcrumbs-divider=" &gt; " data-mc-breadcrumbs-count="3" data-mc-toc="True"><span class="MCBreadcrumbsPrefix">  <![CDATA[ ]]></span>
                            </div>
                        </div>
                    </th>
                </tr>
            </tbody>
        </table>
        <h2>Certificate Monitoring Daemon</h2>
        <p>The certificate monitoring daemon watches for an impending expiry of the NTLS certificate and sends a trap when the lifetime of the certificate falls within a configurable threshold number of days remaining.</p>
        <table style="mc-table-style: url('../../Resources/TableStyles/Page.css');width: 100%;" class="TableStyle-Page" cellspacing="0">
            <col style="width: 33.3%;" class="TableStyle-Page-Column-Column1" />
            <col style="width: 33.3%;" class="TableStyle-Page-Column-Column1" />
            <col style="width: 33.3%;" class="TableStyle-Page-Column-Column1" />
            <thead>
                <tr class="TableStyle-Page-Head-Header1">
                    <th class="TableStyle-Page-HeadE-Column1-Header1">
                        <p>Facility Keyword</p>
                    </th>
                    <th class="TableStyle-Page-HeadE-Column1-Header1">
                        <p>Software Process</p>
                    </th>
                    <th class="TableStyle-Page-HeadD-Column1-Header1">
                        <p>Log File</p>
                    </th>
                </tr>
            </thead>
            <tbody>
                <tr class="TableStyle-Page-Body-Body1">
                    <td class="TableStyle-Page-BodyB-Column1-Body1">
                        <p><code>local5</code>
                        </p>
                    </td>
                    <td class="TableStyle-Page-BodyB-Column1-Body1">
                        <p>
                            <o>certmonitord</o>[pid]</p>
                    </td>
                    <td class="TableStyle-Page-BodyA-Column1-Body1">
                        <p><code>lunalogs</code>
                        </p>
                    </td>
                </tr>
            </tbody>
        </table>
        <h3>Expected Log Messages</h3>
        <p>The following log messages are normal and expected entries in the log files when NTLS certificate monitoring is enabled.</p>
        <h4>Daemon Started</h4><pre xml:space="preserve">2012 Feb 29 12:05:01 myLuna&#160; local5 info&#160; certmonitord[1234]: info : 0 : NTLS certificate expiry monitor started
2012 Feb 29 12:05:01 myLuna&#160; local5 info&#160; certmonitord[1234]: info : 0 : NTLS certificate expiry monitor is configured to send SNMP trap 5 day(s) before the NTLS certificate expires and on every 12 hour(s)

</pre>
        <p xml:space="preserve">These messages indicate that the certificate monitoring daemon is running. The daemon does not run by default. Rather, an administrator must configure and start it from the Luna administrative shell. The number of days and hours in the message reflects the configuration set via LunaSH.</p>
        <h4>Daemon Stopping</h4><pre xml:space="preserve">2012 Feb 29 12:05:01 myLuna&#160; local5 info&#160; certmonitord[1234]: info : 0 : Shutting down NTLS certificate expiry monitor....
2012 Feb 29 12:05:01 myLuna&#160; local5 info&#160; certmonitord[1234]: info : 0 : NTLS certificate expiry monitor terminated

</pre>
        <p xml:space="preserve">These messages indicate that the certificate monitoring daemon gracefully shut down as a result of a signal (SIGINT, SIGTERM, SIGABRT) outside of a normal system shutdown (e.g., lunash:&gt;<b>ntls certificate monitor disable</b>).</p>
        <h4>Impending Certificate Expiry</h4><pre xml:space="preserve">2012 Feb 29 12:05:01 myLuna&#160; local5 info&#160; certmonitord[1234]: info : 0 : NTLS certificate will be expire on Jul 26 16:32:48 2023 GMT
2012 Feb 29 12:05:01 myLuna&#160; local5 info&#160; certmonitord[1234]: info : 0 : NTLS certificate expiry SNMP trap sent to trap host 192.168.0.115

</pre>
        <p>These messages indicate that the NTLS certificate is set to expire and that the certificate monitoring daemon successfully sent a trap to the configured host.</p>
        <h4>Certificate Missing</h4><pre xml:space="preserve">2012 Feb 29 12:05:01 myLuna&#160; local5 warn&#160; certmonitord[1234]: warning : 0 : NTLS certificate is missing

</pre>
        <p>This message indicates that the daemon failed to find the server.pem file for NTLS in the expected location on the hard drive. However, the daemon remains running in the event that an administrator creates the necessary server certificate in a subsequent operation. On a new <span class="DefaultProduct">SafeNet Luna Network HSM</span> appliance from the factory, this message is normal. An administrator must create the NTLS certificate (lunash:&gt;<b>sysconf regenCert</b>).</p>
        <h4>New NTLS Certificate</h4><pre xml:space="preserve">2012 Feb 29 12:05:01 myLuna&#160; local5 info&#160; certmonitord[1234]: info : 0 : New NTLS certificate detected and the expiry date of this new certificate is Jul 26 16:32:48 2033 GMT

</pre>
        <p>This message indicates that an administrator created a new NTLS certificate that is sufficiently far into the future such that a trap is no longer necessary. The daemon will continue to monitor for the certificate expiry window.</p>
        <h3>Unexpected Log Messages</h3>
        <p>Under normal circumstances, you should not see any of these log messages. If you do, please contact <span class="DefaultCompanyNameLong">Gemalto</span> Technical Support to report the message and seek guidance on what to do next.</p>
        <h4>Failed to Detach</h4><pre xml:space="preserve">2012 Feb 29 12:05:01 myLuna&#160; local5 err&#160; certmonitord[1234]: error : 0 : Failed to detach from console

</pre>
        <p>This message indicates that the startup procedure for the certificate monitoring daemon failed, specifically that the daemon did not launch into a background process.</p>
        <h4>Running in Console Mode</h4><pre xml:space="preserve">2012 Feb 29 12:05:01 myLuna&#160; local5 info&#160; certmonitord[1234]: info : 0 : NTLS certificate expiry monitor running in console mode

</pre>
        <p>This message indicates that the certificate monitoring daemon is running in console mode rather than as a background process.</p>
        <h4>SNMP V3 Not Properly Configured</h4><pre xml:space="preserve">2012 Feb 29 12:05:01 myLuna&#160; local5 info&#160; certmonitord[1234]: info : 0 : SNMP v3 trap is not properly configured

</pre>
        <p>This message indicates that either the engine identifier and/or the host IP address configured and stored in the snmp.conf is/are invalid. Lush command(s) that create these entries include the necessary processing checks to ensure the operation(s) writes valid entries to the configuration file.</p>
        <h4>Failed to Allocate Memory Buffers</h4><pre xml:space="preserve">2012 Feb 29 12:05:01 myLuna&#160; local5 err&#160; certmonitord[1234]: error : 0 : Failed to allocate memory buffers

</pre>
        <p>This message indicates that the daemon was unable to allocate the requisite buffers for file handling and string manipulation.</p>
        <h4>Failed to Send Trap</h4><pre xml:space="preserve">2012 Feb 29 12:05:01 myLuna&#160; local5 err&#160; certmonitord[1234]: error : 0 : Failed to send NTLS certificate expiry SNMP trap to trap host 192.168.0.100

</pre>
        <p>This message indicates that the certificate monitoring daemon was unable to execute a system call with a pre-formed command to send a trap. The daemon relies upon the Linux utility snmptrap() to complete this action. An invalid host IP address for example, would cause the system call to fail (e.g., 192.168.0.1004).</p>
        <h4>certmonitord Crash and Burn</h4><pre xml:space="preserve">2012 Feb 29 12:05:01 myLuna&#160; local5 crit&#160; certmonitord[1234]: info : 0 : certmonitord CRASH AND BURN! Stack dump saved to /var/log/certmonitord_bt_2012-02-29_12:05:01
2012 Feb 29 12:05:01 myLuna&#160; local5 crit&#160; certmonitord[1234]: info : 0 : certmonitord CRASH AND BURN and unable to dump the stack!

</pre>
        <p>These messages indicate a programming error. The first message indicates that the certificate monitoring daemon terminated abnormally (on one of SIGSEGV, SIGILL or SIGBUS signals), generating a stack trace file certmonitord_bt_2012-02-29_12:05:01 in the process. Forwarding this file to <span class="DefaultCompanyNameLong">Gemalto</span> may assist a developer to isolate the reason for the abnormal termination. The second message indicates an abnormal termination but with no resulting stack trace created. </p>
        <p class="footer"><span class="DefaultProduct">SafeNet Luna Network HSM</span> <span class="DefaultRelease">7.2</span> <span class="DefaultProjectTitle">Product Documentation</span> <br /><span class="DefaultPartNumber">007-013576-004</span> <span class="DefaultRevision">Rev. C</span> <span style="color: #5e5e5c;"><![CDATA[  ]]></span> <span class="DefaultDateLong">06 May 2019</span> <span style="color: #5e5e5c;"><![CDATA[  ]]></span> <span class="DefaultCopyright">Copyright 2001-2019</span>&#160;<span class="DefaultCompanyNameLong">Gemalto</span> <span style="color: #5e5e5c;"><![CDATA[  ]]></span>All rights reserved. </p>
    </body>
</html>