<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" data-mc-search-type="Stem" data-mc-help-system-file-name="index.xml" data-mc-path-to-help-system="../../../../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-medium="non-print" data-mc-toc-path="LunaSH Command Reference Guide|LunaSH Commands|audit|audit log">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>audit log verify</title>
        <link href="../../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" />
        <link href="../../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" />
        <link href="../../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" />
        <link href="../../../Resources/TableStyles/Breadcrumbs.css" rel="stylesheet" />
        <link href="../../../Resources/Stylesheets/Gemalto_Template.css" rel="stylesheet" />
        <link href="../../../Resources/TableStyles/Page.css" rel="stylesheet" />
        <script src="../../../../Resources/Scripts/custom.modernizr.js">
        </script>
        <script src="../../../../Resources/Scripts/jquery.min.js">
        </script>
        <script src="../../../../Resources/Scripts/require.min.js">
        </script>
        <script src="../../../../Resources/Scripts/require.config.js">
        </script>
        <script src="../../../../Resources/Scripts/foundation.min.js">
        </script>
        <script src="../../../../Resources/Scripts/plugins.min.js">
        </script>
        <script src="../../../../Resources/Scripts/MadCapAll.js">
        </script>
    </head>
    <body>
        <p class="MCWebHelpFramesetLink MCWebHelpFramesetLinkTop"><a href="../../../../index.html#lunash/commands/audit/audit_log_verify.htm">Show Navigation</a>
        </p>
        <!-- Remove this comment to enable syntax highlighting		
        <script type="text/javascript" src="../Stylesheets/SyntaxHilite/Prism/prism.js"></script>
-->
        <table style="width: 100%;border-spacing: 0px 0px;mc-table-style: url('../../../Resources/TableStyles/Breadcrumbs.css');border-left-style: none;border-left-width: 1px;border-left-color: #000000;border-right-style: none;border-right-width: 1px;border-right-color: #000000;border-top-style: none;border-top-width: 0px;border-top-color: #000000;border-bottom-style: none;border-bottom-width: 0px;" class="TableStyle-Breadcrumbs" cellspacing="0">
            <col style="width: 41px;" class="TableStyle-Breadcrumbs-Column-Column1" />
            <col class="TableStyle-Breadcrumbs-Column-Column1" />
            <tbody>
                <tr class="TableStyle-Breadcrumbs-Body-Body1">
                    <th class="TableStyle-Breadcrumbs-BodyB-Column1-Body1">
                        <p class="home" style="font-weight: normal;"><a href="../../../Home_network.htm">Home</a> &gt;
                        </p>
                    </th>
                    <th class="TableStyle-Breadcrumbs-BodyA-Column1-Body1">
                        <div class="nocontent">
                            <div class="MCBreadcrumbsBox_0 breadcrumbs" data-mc-breadcrumbs-divider=" &gt; " data-mc-breadcrumbs-count="3" data-mc-toc="True"><span class="MCBreadcrumbsPrefix"> </span>
                            </div>
                        </div>
                    </th>
                </tr>
            </tbody>
        </table>
        <h2 class="pageBreak"><a name="aanchor51"></a>
            <MadCap:concept term="HSM login" /><a name="kanchor386"></a><a name="kanchor387"></a>audit log verify</h2>
        <p>Verify the audit log records.</p>
        <h3 class="ntoc">User Privileges</h3>
        <p>Only specialized Audit users can access audit commands.</p>
        <h3 class="ntoc">Syntax</h3>
        <p class="code"><b>audit log verify -file</b> &lt;filename&gt; [<b>-serialtarget</b> &lt;serialnum&gt;]  [<b>-serialsource</b> &lt;serialnum&gt;] [<b>-start</b> &lt;number&gt;] [<b>-end</b> &lt;number&gt;] [<b>-external</b>]</p>
        <table style="caption-side: top;width: 100%;mc-table-style: url('../../../Resources/TableStyles/Page.css');" class="TableStyle-Page" cellspacing="0">
            <col class="TableStyle-Page-Column-Column1" style="width: 200px;" />
            <col class="TableStyle-Page-Column-Column1" style="width: 90px;" />
            <col class="TableStyle-Page-Column-Column1" />
            <thead>
                <tr class="TableStyle-Page-Head-Header1">
                    <th class="TableStyle-Page-HeadE-Column1-Header1">Argument(s)</th>
                    <th class="TableStyle-Page-HeadE-Column1-Header1">Shortcut</th>
                    <th class="TableStyle-Page-HeadD-Column1-Header1">Description</th>
                </tr>
            </thead>
            <tbody>
                <tr class="TableStyle-Page-Body-Body1">
                    <td class="TableStyle-Page-BodyE-Column1-Body1" style="font-weight: bold;">-end <span style="font-weight: normal;">&lt;number&gt;</span></td>
                    <td class="TableStyle-Page-BodyE-Column1-Body1" style="font-weight: bold;">-en</td>
                    <td class="TableStyle-Page-BodyD-Column1-Body1">
                        <p>Specifies the final record of the subset of records to be verified from the file.</p>
                    </td>
                </tr>
                <tr class="TableStyle-Page-Body-Body1">
                    <td class="TableStyle-Page-BodyE-Column1-Body1" style="font-weight: bold;">-external</td>
                    <td class="TableStyle-Page-BodyE-Column1-Body1" style="font-weight: bold;">-ex</td>
                    <td class="TableStyle-Page-BodyD-Column1-Body1">
                        <p>Specifies that the file from which log entries are to be verified is from an external HSM. In this case, the audit secret for that HSM must either be the same secret (white PED Key) as is used on the current HSM, or must have been imported to the current HSM. </p>
                        <p>The current HSM's own audit secret cannot verify log files from other HSMs if those were created using independent secrets. The HSM holds only one audit secret at a time, so the secret for the relevant HSM's logs must be brought into the HSM when needed for log verification, if it is not already present. </p>
                    </td>
                </tr>
                <tr class="TableStyle-Page-Body-Body1">
                    <td class="TableStyle-Page-BodyE-Column1-Body1" style="font-weight: bold;">-file <span style="font-weight: normal;">&lt;filename&gt;</span></td>
                    <td class="TableStyle-Page-BodyE-Column1-Body1" style="font-weight: bold;">-f</td>
                    <td class="TableStyle-Page-BodyD-Column1-Body1">Specifies the name of the log file to verify.</td>
                </tr>
                <tr class="TableStyle-Page-Body-Body1">
                    <td class="TableStyle-Page-BodyE-Column1-Body1" style="font-weight: bold;">-serialsource <span style="font-weight: normal;">&lt;serialnum&gt;</span></td>
                    <td class="TableStyle-Page-BodyE-Column1-Body1" style="font-weight: bold;">-serials</td>
                    <td class="TableStyle-Page-BodyD-Column1-Body1">
                        <p>Specifies the serial number of the HSM that generated the log file that is being verified.</p>
                    </td>
                </tr>
                <tr class="TableStyle-Page-Body-Body1">
                    <td class="TableStyle-Page-BodyE-Column1-Body1" style="font-weight: bold;">-serialtarget <span style="font-weight: normal;">&lt;serialnum&gt;</span></td>
                    <td class="TableStyle-Page-BodyE-Column1-Body1" style="font-weight: bold;">-serialt</td>
                    <td class="TableStyle-Page-BodyD-Column1-Body1">
                        <p>Specifies the serial number of the HSM that is performing the verification.</p>
                    </td>
                </tr>
                <tr class="TableStyle-Page-Body-Body1">
                    <td class="TableStyle-Page-BodyB-Column1-Body1" style="font-weight: bold;">-start <span style="font-weight: normal;">&lt;number&gt;</span></td>
                    <td class="TableStyle-Page-BodyB-Column1-Body1" style="font-weight: bold;">-st</td>
                    <td class="TableStyle-Page-BodyA-Column1-Body1">
                        <p>Specifies the starting record of the subset of records to be verified from the file. &#160;&#160;</p>
                    </td>
                </tr>
            </tbody>
        </table>
        <h3 class="ntoc">Example</h3>
        <h4>Verification of local log file, with local secret</h4><pre xml:space="preserve">lunash:&gt;audit log verify -file hsm_66331_00000002.log</pre><pre xml:space="preserve">&#160;</pre><pre xml:space="preserve">Log file being verified ready_for_archive/hsm_66331_00000002.log.</pre><pre xml:space="preserve">&#160;</pre><pre xml:space="preserve">Verifying log on HSM with serial 66331</pre><pre xml:space="preserve">&#160;</pre><pre xml:space="preserve">Verified messages 270723 to 271699</pre><pre xml:space="preserve">&#160;</pre><pre>Command Result : 0 (Success)</pre>
        <h4>Verification of external log with external secret:</h4>
        <p>In this example, we show the process from both HSMs.</p><pre xml:space="preserve">
[myluna72] lunash:&gt; audit secret export

The encrypted log secret file 153593.lws now available for scp.

Now that you have exported your log secret, if you wish to verify your logs
on another HSM see the 'audit secret import' command. If you wish to verify
your logs on another SafeNet Luna Network HSM see the 'audit log tar' command.

Command Result : 0 (Success)</pre><pre xml:space="preserve">&#160;</pre><pre xml:space="preserve">&#160;</pre><pre xml:space="preserve">&#160;</pre><pre xml:space="preserve">
[myluna72] lunash:&gt;audit log tar


Compressing log files:

153593/
153593/hsm_153593_00000019.log
153593/153593.lws
153593/ready_for_archive/
153593/ready_for_archive/hsm_153593_0000000b.log
153593/ready_for_archive/hsm_153593_00000003.log
153593/ready_for_archive/hsm_153593_00000002.log
153593/ready_for_archive/hsm_153593_00000006.log
153593/ready_for_archive/hsm_153593_00000001.log

The tar file containing logs is now available as file 'audit-153593.tgz'.
If you wish to verify your logs on another SA, scp them to another SA's audit
directory then use the 'audit log untar' command.

Command Result : 0 (Success)
</pre>
        <p>
            <br />Here is where we scp the secret file and the .tgz file to a different SafeNet Luna Network HSM
<br /></p><pre xml:space="preserve">
lunash:&gt; audit secret import -serialtarget 150825 -file 153593.lws -serialsource 153593

Successfully imported the encrypted log secret 153593.lws

Now that you have imported a log secret if you wish to verify
your logs please see the 'audit log verify' command.

Command Result : 0 (Success)</pre><pre xml:space="preserve">&#160;</pre><pre xml:space="preserve">&#160;</pre><pre xml:space="preserve">&#160;</pre><pre xml:space="preserve">
[myluna73] lunash:&gt; audit log untarlogs -file audit-153593.tgz

Extracting logs to audit home:

153593/
153593/hsm_153593_00000019.log
153593/153593.lws
153593/ready_for_archive/
153593/ready_for_archive/hsm_153593_0000000b.log
153593/ready_for_archive/hsm_153593_00000003.log
153593/ready_for_archive/hsm_153593_00000002.log
153593/ready_for_archive/hsm_153593_00000006.log
153593/ready_for_archive/hsm_153593_00000001.log

To verify these logs see the 'audit secret import' command to import the HSM's
log secret.

Command Result : 0 (Success)</pre><pre xml:space="preserve">&#160;</pre><pre xml:space="preserve">&#160;</pre><pre xml:space="preserve">&#160;</pre><pre xml:space="preserve">
[myluna73] lunash:&gt; audit log verify -serialtarget 150825 -file hsm_153593_00000001.log -serialsource 153593


Log file being verified /home/audit/lush_files/153593/ready_for_archive/hsm_153593_00000001.log.

Verifying log from HSM with serial 153593 on HSM with serial 150825
 Make sure that you have already imported the audit log secret.

Verified messages 39638 to 39641

Command Result : 0 (Success)</pre><pre xml:space="preserve">&#160;</pre>
        <p class="notepad_note">On the verifying HSM ([myluna73] in the example),  you just imported a secret (displacing the native secret of the local HSM) and used it to verify logs that were transported from a different HSM ([myluna<strong>72</strong>] in the example). <br /><br />If you now wished to verify the second HSM's ([myluna73]) own log files, you would need to re-import that HSM's secret, having replaced it with the other HSM's ([myluna72]'s0 secret for the example operation. <br /><br />That is, [myluna72]'s log secret that was imported into [myluna73] to allow [myluna73] to verify logs received from [myluna72], is not useful to verify [myluna73]'s own logs. An HSM can have only one log secret at a time, so [myluna73] needs its own secret back if it is to verify its own logs, rather than the logs it received from [myluna72]. </p>
        <p class="footer"><span class="DefaultProduct">SafeNet Luna Network HSM</span> <span class="DefaultRelease">7.2</span> <span class="DefaultProjectTitle">Product Documentation</span> <br /><span class="DefaultPartNumber">007-013576-004</span> <span class="DefaultRevision">Rev. C</span> <span style="color: #5e5e5c;"><![CDATA[  ]]></span> <span class="DefaultDateLong">06 May 2019</span> <span style="color: #5e5e5c;"><![CDATA[  ]]></span> <span class="DefaultCopyright">Copyright 2001-2019</span>&#160;<span class="DefaultCompanyNameLong">Gemalto</span> <span style="color: #5e5e5c;"><![CDATA[  ]]></span>All rights reserved. </p>
    </body>
</html>