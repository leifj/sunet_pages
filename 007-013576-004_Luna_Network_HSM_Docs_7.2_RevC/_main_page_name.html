<!-- HTML header for doxygen 1.8.7-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.12"/>
<title>REST API: Introduction</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="gemalto_logo.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">REST API
   &#160;<span id="projectnumber">7.2</span>
   </div>
   <div id="projectbrief">REST API for SafeNet Network HSMs</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.12 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('_main_page_name.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Introduction </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1>SafeNet Network HSM REST API </h1>
<h2>Introduction </h2>
<p>SafeNet Network HSM offers an exciting new way to administer the appliance. In addition to the long-standing Luna shell, administrators now have the ability to use a representational state transfer application programming interface &mdash; REST-ful API &mdash; to configure and query the appliance. <br />
</p>
<h2>LunaSH Cross Reference </h2>
<p>Most existing SafeNet Network HSM customers are familiar with LunaSH. The first question a SafeNet Network HSM administrator familiar with LunaSH might have is: What is the relationship between the REST API resources and the LunaSH commands of SafeNet Network HSM? The tables at the following links provide a cross reference between existing LunaSH commands and REST API resources. Note that the REST API condenses many of the LunaSH commands together for greater efficiency. For this reason, many cross references are not direct 1:1 mappings. <br />
 <br />
 "client" commands (<a class="el" href="client_lush_x_ref_page_name.html">"client" LunaSH Commands Cross Reference</a>)<br />
 "hsm" commands (<a class="el" href="hsm_lush_x_ref_page_name.html">"hsm" LunaSH Commands Cross Reference</a>)<br />
 "ntls" commands (<a class="el" href="ntls_lush_x_ref_page_name.html">"ntls" LunaSH Commands Cross Reference</a>)<br />
 "partition" commands (<a class="el" href="partition_lush_x_ref_page_name.html">"partition" LunaSH Commands Cross Reference</a>)<br />
 "service" commands (<a class="el" href="service_lush_x_ref_page_name.html">"service" LunaSH Commands Cross Reference</a>)<br />
 "stc" commands (<a class="el" href="stc_lush_x_ref_page_name.html">"stc" LunaSH Commands Cross Reference</a>)<br />
</p>
<h2>What Do I Need to Use the REST API? </h2>
<p>SafeNet Network HSM 6.1 is the first release to support the REST API feature. If you have an appliance at an older release, you need to upgrade your appliance to 6.1 or a subsequent release to get the support necessary for the feature. <br />
<br />
 To make use of the REST API on a SafeNet Network HSM 6.1 or subsequent release appliance, you need to first install the rest-api secure package. The version will change over time but here is an example of the steps to install the REST API.</p><ul>
<li>Obtain the REST API secure package update</li>
<li>Transfer it to the appliance via SCP</li>
<li>Login to the HSM (hsm login)</li>
<li>Apply the package update for the REST API (package update rest-api-1.0.0-45 -auth d69PbsY696LYW5YP)</li>
</ul>
<p><br />
 You may want to test that the REST API is operational. To do so, follow these steps:</p><ul>
<li>Open a LunaSH prompt on your appliance</li>
<li>Type: webserver enable NOTE: You must issue this command whenever you reboot or power cycle the appliance. The web server is disabled by default.</li>
<li>Type: webserver certificate generate â€“keytype rsa</li>
<li>Type: service restart webserver</li>
<li>Copy the following java script to a file and name it <code>login.html</code>. Replace YOURLUNASAIPADDRESS with the IP address of the SafeNet Network HSM appliance you want to administer and YOURLUNASAPASSWORD with the admin account password.</li>
</ul>
<p><br />
 <code> </p><pre class="fragment">&lt;html&gt;
&lt;head&gt;
    &lt;script src="http://code.jquery.com/jquery-1.11.0.min.js"&gt;&lt;/script&gt;
&lt;/head&gt;

&lt;body&gt;
    &lt;input id="login" type="button" value="Login"/&gt;
    &lt;a href="https:/YOURLUNASAIPADDRESS:8080/api/lunasa/hsms"&gt;hsms&lt;/a&gt;

    &lt;script&gt;

        var loginData = {   username:"admin",
                            password:"YOURLUNASAPASSWORD"};

        $("#login").on("click", function(e){
            $.ajax({
                type: 'post',
                url: "https://YOURLUNASAIPADDRESS:8080/auth/login/basic",
                dataType: 'json',
                data: JSON.stringify(loginData),
                success: function(data) {
                    console.log("worked");
                    console.log(data);
                },
                error: function(e,status,error){
                    console.log(e);
                    console.log(status);
                    console.log(error);
                },
                xhrFields: {
                    withCredentials: true
                },
                timeout: 2000
            });

        });
    &lt;/script&gt;

&lt;/body&gt;
&lt;/html&gt;
</pre><p> </code></p><ul>
<li>Start your favorite browser.</li>
<li>Open the <code>login.html</code> Java script.</li>
<li>Click the "login" button in the top-right corner.</li>
<li>Click the "hsms" button in the top-right corner.</li>
<li>Accept the self-signed server certificate of the SafeNet Network HSM if informed that the server is unsafe or the connection is not private.</li>
<li>If successfully connected to the web server on the SafeNet Network HSM, you should see something similar to the following example in the top of your browser:<br />
 <br />
 <code> <pre class="fragment">{"hsms":[{"id":"117290","label":"mysa","url":"/api/lunasa/hsms/117290"}]}
</pre> </code></li>
<li>Form the URL with the serial number of your HSM to query more details of the HSM and hit enter. Using the above example, the URL is:<br />
 <br />
 <code> <pre class="fragment">https://YOURLUNASAIPADDRESS:8080/api/lunasa/hsms/117290
</pre> </code></li>
<li>You should see information similar to the following example in your browser (formatting with returns in this example):<br />
 <br />
 <code> <pre class="fragment">{"storageSpace":{"free":2097152,"used":0,"total":2097152},
"supportInfo":"",
"counter":"/api/lunasa/hsms/117290/counter",
"pkiEnabled":true,
"debugInfo":"",
"fipsModeEnabled":false,
"zeroized":false,
"loggedIn":false,
"authenticationMethod":"PASSWORD",
"model":"K6 Base",
"driverTimeout":0,
"firmwareVersion":"6.22.0",
"label":"Admin",
"licenses":"/api/lunasa/hsms/117290/licenses",
"partitions":"/api/lunasa/hsms/117290/partitions",
"roles":"/api/lunasa/hsms/117290/roles",
"policies":"/api/lunasa/hsms/117290/policies"}
</pre> </code></li>
</ul>
<h2>Organization of Documentation </h2>
<p>The best way to use this documentation is to have the list of pages open on the left and the viewing pane on the right as the following example shows.<br />
 <br />
 </p><div class="image">
<img src="pages.jpg" alt="pages.jpg"/>
<div class="caption">
Best way to view documentation</div></div>
<p><br />
 The pages in the left pane have the following organization.</p><ul>
<li>The first page &mdash; this one &mdash; is an introduction to the REST API.</li>
<li>The next set up pages describe resources specific to the REST API framework. These pages are in alphabetical order.</li>
<li>The large set of pages that follow identify the various resources available in the REST API as plug-ins. These pages are in alphabetical order.</li>
<li>A set of pages thereafter describe each of the REST objects. These pages are in alphabetical order.</li>
<li>The documentation concludes with cross reference tables for the various LunaSH commands that the REST API replaces. <br />
 <br />
 <code> <pre class="fragment"></pre> </code></li>
</ul>
<h2>Notes </h2>
<ul>
<li>resources and objects are case-sensitive: use the contents of this documentation as a reference for the proper case.</li>
<li>the default session timeout is 10 minutes: after this period with no activity, the REST server terminates an authenticated session.</li>
<li>to keep the REST session alive over an extended period (i.e., more than 10 minutes), periodically query a resource such as GET. /api/lunasa/services/webserver ... or to have a record of the keep-alive action: POST /api/lunasa/logs/lunalogs with a suitable log message.</li>
<li>HSM and partition serial numbers are unique; HSM and partition labels do not have to be: keep this point in mind when constructing logic for REST resources.</li>
<li>if you encounter the string "NO ERR WITH THIS ID EXISTS", please contact Gemalto technical support and report how you encountered this string.</li>
<li>LunaSH imposes constraints on names, labels, etc. to prevent characters that could be used to exploit the shell. You should use the same character set with the REST API. See the "Create (Initialize) a Password Authenticated Legacy-style Application Partition" page in the product documentation for more details.</li>
<li>all discoverable resources (resources with a GET) will be referenced by a href in its parent resource, this documentation may not reflect all resources that follow this rule.</li>
</ul>
<p><br />
 </p><h2>Other Topics </h2>
<p><a class="el" href="_authentication_page_name.html">Authentication</a> <br />
 <a class="el" href="_tasks_overview_page_name.html">Tasks</a> <br />
 <a class="el" href="_indirect_login_page_name.html">Indirect Login</a> <br />
 <a class="el" href="_protecting_resources_page_name.html">Protecting Resources</a> <br />
 <a class="el" href="_headers_page_name.html">Headers</a> <br />
 <a class="el" href="_status_codes_page_name.html">Status Codes</a> <br />
 <a class="el" href="_formatting_page_name.html">Formatting</a> <br />
 <a class="el" href="_file_i_o_page_name.html">File I/O</a> <br />
 <a class="el" href="_black_list_page_name.html">Black List</a> <br />
 </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<p class="footer">
<span class="DefaultProduct">REST API for SafeNet Network HSMs</span>
<span class="DefaultRelease">7.2</span>
<span class="DefaultProjectTitle">Reference Guide</span><br />
<span class="DefaultPartNumber">007-013576-005</span>
<span class="DefaultRevision">Rev. A</span>
<span style="color: #5e5e5c;"> <![CDATA[ ]]></span><span style="color: #5e5e5c;"> <![CDATA[ ]]></span>
<span class="DefaultCopyright">Copyright 2015-2018</span>&#160;
<span class="DefaultCompanyNameLong">Gemalto.</span>
<span style="color: #5e5e5c;"> <![CDATA[ ]]></span>All rights reserved. </p>
