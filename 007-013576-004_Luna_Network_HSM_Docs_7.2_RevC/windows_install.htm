<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" data-mc-search-type="Stem" data-mc-help-system-file-name="index.xml" data-mc-path-to-help-system="../../../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-medium="non-print" data-mc-toc-path="Installation Guide|SafeNet Luna HSM Client Software Installation">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>Windows SafeNet Luna HSM Client Installation</title>
        <link href="../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" />
        <link href="../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" />
        <link href="../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" />
        <link href="../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" />
        <link href="../../Resources/TableStyles/Breadcrumbs.css" rel="stylesheet" />
        <link href="../../Resources/Stylesheets/Gemalto_Template.css" rel="stylesheet" />
        <script src="../../../Resources/Scripts/custom.modernizr.js">
        </script>
        <script src="../../../Resources/Scripts/jquery.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.config.js">
        </script>
        <script src="../../../Resources/Scripts/foundation.min.js">
        </script>
        <script src="../../../Resources/Scripts/plugins.min.js">
        </script>
        <script src="../../../Resources/Scripts/MadCapAll.js">
        </script>
    </head>
    <body>
        <p class="MCWebHelpFramesetLink MCWebHelpFramesetLinkTop"><a href="../../../index.html#install/software/windows_install.htm">Show Navigation</a>
        </p>
        <!-- Remove this comment to enable syntax highlighting		
        <script type="text/javascript" src="../Stylesheets/SyntaxHilite/Prism/prism.js"></script>
-->
        <table style="width: 100%;border-spacing: 0px 0px;mc-table-style: url('../../Resources/TableStyles/Breadcrumbs.css');border-left-style: none;border-left-width: 1px;border-left-color: #000000;border-right-style: none;border-right-width: 1px;border-right-color: #000000;border-top-style: none;border-top-width: 0px;border-top-color: #000000;border-bottom-style: none;border-bottom-width: 0px;" class="TableStyle-Breadcrumbs" cellspacing="0">
            <col style="width: 41px;" class="TableStyle-Breadcrumbs-Column-Column1" />
            <col class="TableStyle-Breadcrumbs-Column-Column1" />
            <tbody>
                <tr class="TableStyle-Breadcrumbs-Body-Body1">
                    <th class="TableStyle-Breadcrumbs-BodyB-Column1-Body1">
                        <p class="home" style="font-weight: normal;"><a href="../../Home_network.htm">Home</a> &gt;
                        </p>
                    </th>
                    <th class="TableStyle-Breadcrumbs-BodyA-Column1-Body1">
                        <div class="nocontent">
                            <div class="MCBreadcrumbsBox_0 breadcrumbs" data-mc-breadcrumbs-divider=" &gt; " data-mc-breadcrumbs-count="3" data-mc-toc="True"><span class="MCBreadcrumbsPrefix">  <![CDATA[ ]]></span>
                            </div>
                        </div>
                    </th>
                </tr>
            </tbody>
        </table>
        <h2 class="pageBreak">Windows SafeNet Luna HSM Client Installation</h2>
        <p>This section describes how to install the SafeNet Luna HSM Client software on Windows. It contains the following topics:</p>
        <p class="ul1" data-mc-autonum="&lt;b&gt;&amp;gt;&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>&gt;</b></span></span><a href="#Required" class="MCXref xref">Required Client Software</a>
        </p>
        <p class="ul1" data-mc-autonum="&lt;b&gt;&amp;gt;&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>&gt;</b></span></span><a href="#Prereq" class="MCXref xref">Prerequisites</a>
        </p>
        <p class="ul1" data-mc-autonum="&lt;b&gt;&amp;gt;&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>&gt;</b></span></span><a href="#Installi" class="MCXref xref">Installing the Luna HSM Client Software</a>
        </p>
        <p class="ul1" data-mc-autonum="&lt;b&gt;&amp;gt;&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>&gt;</b></span></span><a href="#Modify_installed_client" class="MCXref xref">Modifying the Installed Luna HSM Client Software</a>
        </p>
        <p class="ul1" data-mc-autonum="&lt;b&gt;&amp;gt;&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>&gt;</b></span></span><a href="#Java" class="MCXref xref">Java</a>
        </p>
        <p class="ul1" data-mc-autonum="&lt;b&gt;&amp;gt;&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>&gt;</b></span></span><a href="#CSP" class="MCXref xref">CSP and KSP</a>
        </p>
        <p class="ul1" data-mc-autonum="&lt;b&gt;&amp;gt;&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>&gt;</b></span></span><a href="#Uninstal" class="MCXref xref">Uninstalling the SafeNet Luna HSM Client Software</a>
        </p>
        <p class="ul1" data-mc-autonum="&lt;b&gt;&amp;gt;&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>&gt;</b></span></span><a href="#After" class="MCXref xref">After Installation</a>
        </p>
        <p class="ul1" data-mc-autonum="&lt;b&gt;&amp;gt;&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>&gt;</b></span></span><a href="#Trouble" class="MCXref xref">Troubleshooting</a>
        </p>
        <p>Applicability to specific versions of Windows is summarized in the Customer Release Notes for this release.</p>
        <p class="note" data-mc-autonum="&lt;span style=&quot;color: #6c286b;&quot; class=&quot;mcFormatColor&quot;&gt; &lt;b&gt;NOTE&lt;/b&gt; &#160;&#160;&lt;/span&gt;"><span class="autonumber"><span><span style="color: #6c286b;" class="mcFormatColor"> <b>NOTE</b> &#160;&#160;</span></span></span>Before 
installing a SafeNet Luna HSM system, confirm that the product you have received is in factory 
condition and has not been tampered with in transit. Refer 
to the Startup Guide included with your product shipment. If 
you have any questions about the condition of the product that you have 
received, contact Technical Support immediately.</p>
        <h3><a name="Required"></a>Required Client Software</h3>
        <p>Each computer that connects to a SafeNet Luna Network HSM as a Client must have the 
cryptoki library, the vtl client shell and other utilities and supporting 
files installed. </p>
        <p>Each computer that contains, or is connected to a SafeNet Luna PCIe HSM or a SafeNet Luna USB HSM must have the cryptoki library and other utilities and supporting files installed. </p>
        <h3><a name="Prereq"></a>Prerequisites</h3>
        <p>The Luna HSM Client installer requires the Microsoft Universal C Runtime (Universal CRT) to run properly. Universal CRT requires your Windows machine to be up to date. Before running the installer, ensure that you have&#160;the Universal C&#160;Runtime in Windows (KB2999226) update and its prerequisites installed on your machine. The following updates must be installed in order: </p>
        <p class="ol1Start" data-mc-autonum="1."><span class="autonumber"><span class="ol1Number">1.</span></span>March 2014 Windows servicing stack update (See <a href="https://support.microsoft.com/en-us/help/2919442/march-2014-servicing-stack-update-for-windows-8.1-and-windows-server-2012-r2" target="_blank">https://support.microsoft.com/en-us/help/2919442</a>)</p>
        <p class="ol1" data-mc-autonum="2."><span class="autonumber"><span class="ol1Number">2.</span></span>April 2014 Windows update (See <a href="https://support.microsoft.com/en-us/help/2919355/windows-rt-8.1,-windows-8.1,-and-windows-server-2012-r2-update-april-2014" target="_blank">https://support.microsoft.com/en-us/help/2919355</a>)</p>
        <p class="ol1" data-mc-autonum="3."><span class="autonumber"><span class="ol1Number">3.</span></span>Universal C Runtime update (See <a href="https://support.microsoft.com/en-us/kb/2999226">https://support.microsoft.com/en-us/kb/2999226</a>)</p>
        <h3><a name="Installi"></a>Installing the Luna HSM Client Software</h3>
        <p>The supported Windows servers are 64-bit. They allow running of 32-bit or 64-bit applications. </p>
        <p>For compatibility of our HSMs with Windows in general, we provide both 32-bit and 64-bit libraries and tools for use with your applications as appropriate. Hardware drivers are 64-bit only.</p>
        <p>For compatibility of our HSMs with Windows CAPI we have SafeNet CSP, and for the newer Windows CNG we have SafeNet KSP. See <a href="#CSP" class="MCXref xref">CSP and KSP</a> for more information.</p>
        <p> Interactive (prompted, this page) and non-interactive (no prompts <a href="scripted_unattended_install.htm" class="MCXref xref">Scripted/Unattended Windows Installation/Uninstallation</a>) installation options are available. </p>
        <h5>To install the Luna HSM client software:</h5>
        <p class="ol1Start" data-mc-autonum="1."><span class="autonumber"><span class="ol1Number">1.</span></span>Log into Windows 
as “Administrator”, or as a user with administrator privileges (see <a href="#Trouble" class="MCXref xref">Troubleshooting</a>).</p>
        <p class="ol1" data-mc-autonum="2."><span class="autonumber"><span class="ol1Number">2.</span></span>Uninstall any previous versions of the Client software before you proceed (see <a href="#Uninstal" class="MCXref xref">Uninstalling the SafeNet Luna HSM Client Software</a>). </p>
        <p class="note" data-mc-autonum="&lt;span style=&quot;color: #6c286b;&quot; class=&quot;mcFormatColor&quot;&gt; &lt;b&gt;NOTE&lt;/b&gt; &#160;&#160;&lt;/span&gt;"><span class="autonumber"><span><span style="color: #6c286b;" class="mcFormatColor"> <b>NOTE</b> &#160;&#160;</span></span></span>If you do not uninstall previous Luna HSM Client versions, you might face installation issues, such as failure to install the new client.</p>
        <p class="ol1" data-mc-autonum="3."><span class="autonumber"><span class="ol1Number">3.</span></span>Download the Luna HSM Client from the <span class="DefaultCompanyNameLong">Gemalto</span> Support Portal at <a href="https://supportportal.gemalto.com/">https://supportportal.gemalto.com</a> and extract the .zip to an appropriate folder.</p>
        <p class="ol1" data-mc-autonum="4."><span class="autonumber"><span class="ol1Number">4.</span></span>In the extracted directory, locate the folder for your Windows architecture and double click <b>LunaHSMClient.exe</b>.</p>
        <p class="listLevel1">
            <img src="../../Resources/Images/install/win_LunaHSMClient_Installer.png" />
        </p>
        <p class="ol1" data-mc-autonum="5."><span class="autonumber"><span class="ol1Number">5.</span></span>The Custom Setup dialog allows you to choose which software components you wish to install. Click  a product to select the components to install, or click Select All to install all available components. </p>
        <p class="listLevel1">The installer includes the SafeNet SNMP Subagent as an option with any of the SafeNet Luna HSMs, except SafeNet Luna Network HSM, which has agent and subagent built in. After installation of the SafeNet SNMP Subagent is complete, you will need to move the SafeNet MIB files to the appropriate directory for your SNMP application, and you will need to start the SafeNet subagent and configure for use with your agent, as described in <a href="../../administration/snmp/snmp.htm" class="MCXref xref">SNMP Monitoring</a> in the <i>Administration Guide</i>.</p>
        <p class="listLevel1">
            <img src="../../Resources/Images/install/win_LunaHSMClient_01_none-selected.PNG" />
        </p>
        <p data-mc-conditions="Default.SA">
            <img src="../../Resources/Images/install/win_LunaHSMClient_01_network-selected.PNG" />
        </p>
        <p class="listLevel1">After you select the components you want to install, click <b>Install</b>.</p>
        <p class="note" data-mc-autonum="&lt;span style=&quot;color: #6c286b;&quot; class=&quot;mcFormatColor&quot;&gt; &lt;b&gt;NOTE&lt;/b&gt; &#160;&#160;&lt;/span&gt;"><span class="autonumber"><span><span style="color: #6c286b;" class="mcFormatColor"> <b>NOTE</b> &#160;&#160;</span></span></span>Agree to the terms of the License Agreement to proceed with installation. To view the agreement text, click the link in the dialog. The installer loads a PDF version if a PDF reader is available; otherwise it launches a text editor and a plain-text version of the agreement. <br /></p>
        <p class="ol1" data-mc-autonum="6."><span class="autonumber"><span class="ol1Number">6.</span></span>If Windows presents a security notice asking if you wish to install the device driver from SafeNet, click <b>Install</b> to accept (SafeNet is a division of Gemalto).</p>
        <p class="listLevel1">
            <img src="../../Resources/Images/install/win_LunaHSMClient_02_like-instal-device.PNG" />
            <br />
        </p>
        <p class="note" data-mc-autonum="&lt;span style=&quot;color: #6c286b;&quot; class=&quot;mcFormatColor&quot;&gt; &lt;b&gt;NOTE&lt;/b&gt; &#160;&#160;&lt;/span&gt;"><span class="autonumber"><span><span style="color: #6c286b;" class="mcFormatColor"> <b>NOTE</b> &#160;&#160;</span></span></span>If you choose not to install the driver(s), your Luna HSM Client cannot function with any locally-connected SafeNet hardware (which includes SafeNet Luna PCIe HSM, SafeNet Luna USB HSM, or SafeNet Luna Backup HSMs). </p>
        <p class="ol1" data-mc-autonum="7."><span class="autonumber"><span class="ol1Number">7.</span></span>When the installation completes, the button options are Uninstall, Modify, or Quit; click <b>Quit</b> to finish. </p>
        <p class="listLevel1" data-mc-conditions="Default.SA">
            <img src="../../Resources/Images/install/win_LunaHSMClient_04_network_uninstall-modify-quit.PNG" />
        </p>
        <p class="listLevel1">If you launch the installer again, you should see the final dialog, above, allowing you to modify the current Luna HSM Client installation if desired, or to uninstall.</p>
        <h3><a name="Modify_installed_client"></a>Modifying the Installed Luna HSM Client Software</h3>
        <p>If you wish to modify the installation (perhaps to add a component or product that you did not previously install), you must re-run the current installer and ensure that the desired options are selected.</p>
        <p class="note" data-mc-autonum="&lt;span style=&quot;color: #6c286b;&quot; class=&quot;mcFormatColor&quot;&gt; &lt;b&gt;NOTE&lt;/b&gt; &#160;&#160;&lt;/span&gt;"><span class="autonumber"><span><span style="color: #6c286b;" class="mcFormatColor"> <b>NOTE</b> &#160;&#160;</span></span></span>This feature has software and/or firmware dependencies. See <a href="../../administration/upgrade/version_dependencies.htm" class="MCXref xref">Version Dependencies by Feature</a> for more information.</p>
        <h5>To modify the installed Luna HSM client software:</h5>
        <p class="ol1Start" data-mc-autonum="1."><span class="autonumber"><span class="ol1Number">1.</span></span>Run the <b>LunaHSMClient.exe</b> program again. Because the software is already installed on your computer, the following dialog is displayed (in this example, devices and features were previously installed, and the task is to uninstall a couple of items):</p>
        <p class="listLevel1" data-mc-conditions="Default.SA">
            <img src="../../Resources/Images/install/win_LunaHSMClient_04_network_uninstall-modify-quit.PNG" />
        </p>
        <p class="ol1" data-mc-autonum="2."><span class="autonumber"><span class="ol1Number">2.</span></span>Select or deselect individual Devices or Features, as desired.</p>
        <p class="listLevel1" data-mc-conditions="Default.SA">
            <img src="../../Resources/Images/install/win_LunaHSMClient_05_network_uninstall-modify-quit_complete.png" />
        </p>
        <p class="ol1" data-mc-autonum="3."><span class="autonumber"><span class="ol1Number">3.</span></span>Click  <b>Modify</b>. The client software is updated (items are added or removed). </p>
        <p class="listLevel1">If you are uninstalling some items, or if you are adding features, the dialog shows a progress bar briefly, and then shows the current status.</p>
        <p class="listLevel1">If you are adding a Luna Device, then you might be prompted with the operating system pop-up to accept/trust the driver. Do so. </p>
        <p class="ol1" data-mc-autonum="4."><span class="autonumber"><span class="ol1Number">4.</span></span>Click <b>Quit</b> when the modification is complete. </p>
        <p class="note" data-mc-autonum="&lt;span style=&quot;color: #6c286b;&quot; class=&quot;mcFormatColor&quot;&gt; &lt;b&gt;NOTE&lt;/b&gt; &#160;&#160;&lt;/span&gt;"><span class="autonumber"><span><span style="color: #6c286b;" class="mcFormatColor"> <b>NOTE</b> &#160;&#160;</span></span></span>You can also use <b>Programs and Features</b> in the Windows Control Panel to launch the Uninstall/Modify dialog for the client software.<br /></p>
        <h3><a name="Java"></a>Java</h3>
        <p>If you want the Luna Java Security Provider (JSP) to be installed, the SafeNet Java files are installed in the <b>C:\Program Files\LunaClient\JSP\lib</b> folder. You install the Java JDK&#160;or run-time environment from the vendor of your choice to use the Luna JSP. Refer to the Customer Release Notes for supported Java versions.</p>
        <p>Copy the SafeNet Java files from their default location under <b>C:\Program Files\SafeNet\LunaClient\JSP\lib</b> to the Java environment directory, for example <b>C:\Program Files\Java\jdk1.8.0_92\bin</b>.</p>
        <p class="note" data-mc-autonum="&lt;span style=&quot;color: #6c286b;&quot; class=&quot;mcFormatColor&quot;&gt; &lt;b&gt;NOTE&lt;/b&gt; &#160;&#160;&lt;/span&gt;"><span class="autonumber"><span><span style="color: #6c286b;" class="mcFormatColor"> <b>NOTE</b> &#160;&#160;</span></span></span>The exact directory might differ depending on where you obtained your Java system, the version, and any choices that you made while installing and configuring it.</p>
        <h4>Using a 32-bit JDK on a 64-bit OS</h4>
        <p>If you install a 32-bit JDK on a 64-bit OS, you must copy the 32-bit <b>LunaAPI.dll</b> file to the 32-bit JDK bin folder. For example,  <b>C:\Program Files (x86)\Java\jdk1.8.0_92\bin</b>.</p>
        <h4>Java Library Path Issue</h4>
        <p><span class="DefaultCompanyName">Gemalto</span> has traditionally recommended that you put <b>LunaAPI.dll</b> in the <b>&lt;java_install_dir&gt;/lib/ext</b> folder.</p>
        <p>Java 7/8/9 for Windows has removed that directory from the Java library path. As a result, when a Java application on Windows uses the SafeNet provider, it cannot find the <b>LunaAPI.dll</b> library, causing the application to fail.</p>
        <p>To address this problem, we suggest that you use one of the following methods to add <b>LunaAPI.dll</b> to the Java search path:</p>
        <p class="ul1" data-mc-autonum="&lt;b&gt;&amp;gt;&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>&gt;</b></span></span>Put <b>LunaAPI.dll</b> in an arbitrary folder and add that folder to the system path. Java will search the system path for <b>LunaAPI.dll</b>.<br /></p>
        <p class="ul1" data-mc-autonum="&lt;b&gt;&amp;gt;&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>&gt;</b></span></span>Put <b>LunaAPI.dll</b> in the <b>&lt;java_install_dir&gt;/bin</b> folder.</p>
        <p>Alternatively, at the command line, specify: <b>"%JAVA_HOME%/jre/bin/java" -Djava.library.path="C:\path\to\lunaapi.dll" -jar jMultitoken.jar</b></p>
        <p>For additional Java-related information,see <a href="../../sdk/java/java.htm" class="MCXref xref">Java Interfaces</a> in the <i>SDK Reference Guide</i>.&#160;</p>
        <h4>JSP Static Registration</h4>
        <p>You would choose static registration of providers if you want all applications to default to the SafeNet provider.</p>
        <p>
            <MadCap:conditionalText data-mc-conditions="Default.SA">Once your client has externally logged in using <b>salogin</b> (see <a href="../../Utilities/salogin/salogin.htm" class="MCXref xref">salogin</a> in the <i>Utilities Reference Guide</i>) or your own HSM-aware utility, any application is able to use the SafeNet product without being designed to login to the HSM Partition.</MadCap:conditionalText>
        </p>
        <p>Edit the java.security file located in the <b>\jre\lib\security</b> directory of your Java SDK/JRE 7/8/9 installation to read as follows:</p><pre><code>security.provider.1=sun.security.provider.Sun</code></pre><pre><code>security.provider.2=com.sun.net.ssl.internal.ssl.Provider</code></pre><pre><code>security.provider.3=com.safenetinc.luna.provider.LunaProvider</code></pre><pre><code>security.provider.4=com.sun.rsajca.Provider</code></pre><pre><code>security.provider.5=com.sun.crypto.provider.SunJCE</code></pre><pre><code>security.provider.6=sun.security.jgss.SunProvider</code></pre><pre>&#160;</pre>
        <p>You can set our provider in first position for  efficiency if SafeNet Luna HSM operations are your primary mode. However, if your application needs to perform operations not supported by the LunaProvider (secure random generation or random publickey verification, for example) then it would receive error messages from the HSM and would need to handle those gracefully before resorting to providers further down the list. We have found that having our provider in third position works well for most applications.</p>
        <p>The modifications in the "java.security" file are global, and they might result in the breaking of another application that uses the default KeyPairGenerator without logging into the SafeNet Luna Network HSM first. This consideration might argue for using dynamic registration, instead.</p>
        <h4>JSP Dynamic Registration</h4>
        <p>For your situation, you may prefer to employ dynamic registration of Providers, in order to avoid possible negative impacts on other applications running on the same machine. As well, the use of dynamic registration allows you to keep installation as straightforward as possible for your customers.</p>
        <h4>Compatibility</h4>
        <p>We formally test SafeNet Luna HSMs and our Java provider with Oracle JDK for all platforms except AIX, and with IBM JDK for the AIX platform. The SafeNet JCE provider is compliant with the JCE specification, and should work with any JVM that implements the Java language specification.</p>
        <p>Occasional problems have been encountered with respect to IBM JSSE.</p>
        <p>GNU JDK shipped with most Linux systems has historically been incomplete and not suitable.</p>
        <h3><a name="CSP"></a>CSP and KSP</h3>
        <p>SafeNet CSP allows you to use the SafeNet Luna HSM with Microsoft CAPI, which is supported on 32-bit and on 64-bit Windows.</p>
        <p>SafeNet KSP allows you to use the SafeNet Luna HSM with Microsoft CNG, which is newer, has additional functions, and supersedes CAPI. </p>
        <p>Both of these require modifications to the Windows Registry.</p>
        <h4>SafeNet CSP</h4>
        <p>For SafeNet CSP, the utility <b>register.exe</b> takes care of the registry.</p>
        <p>Just remember to run the 64-bit version, the 32-bit version, or both, depending on the applications you are running.</p>
        <p class="ul1" data-mc-autonum="&lt;b&gt;&amp;gt;&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>&gt;</b></span></span>Register the csp dll:</p>
        <p class="listLevel1"><b># register.exe /library</b>
        </p>
        <p class="ul1" data-mc-autonum="&lt;b&gt;&amp;gt;&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>&gt;</b></span></span>Register the partition:</p>
        <p class="listLevel1"><b># register &lt;no arguments&gt;</b>
        </p>
        <h4>SafeNet KSP</h4>
        <p>For SafeNet KSP, the utility <b>KspConfig.exe</b> takes care of the registry. Follow instructions for the use of the graphical KspConfig.exe as described in <a href="../../sdk/microsoft/ksp_cng.htm" class="MCXref xref">KSP for CNG</a> in the <i>SDK Reference Guide</i>. Just remember to run the 64-bit version, the 32-bit version, or both, depending on the applications you are running.</p>
        <p>If SafeNet CSP (CAPI) / SafeNet KSP(CNG) is selected at installation time then the <b>SafeNetKSP.dll</b> file is installed in these two locations:</p>
        <p class="ul1" data-mc-autonum="&lt;b&gt;&amp;gt;&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>&gt;</b></span></span><b>C:\Windows\System32</b> (used for 64-bit KSP)</p>
        <p class="ul1" data-mc-autonum="&lt;b&gt;&amp;gt;&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>&gt;</b></span></span><b>C:\Windows\SysWOW64</b> (used for 32-bit KSP)</p>
        <p class="note" data-mc-autonum="&lt;span style=&quot;color: #6c286b;&quot; class=&quot;mcFormatColor&quot;&gt; &lt;b&gt;NOTE&lt;/b&gt; &#160;&#160;&lt;/span&gt;"><span class="autonumber"><span><span style="color: #6c286b;" class="mcFormatColor"> <b>NOTE</b> &#160;&#160;</span></span></span>The <b>cryptoki.ini</b> file, which specifies many configuration settings for your HSM and related software, includes a line that specifies the path to the appropriate libNT for use with your application(s). Verify that the path is correct.</p>
        <h3><a name="USB-powered"></a>USB-powered PED</h3>
        <p>The SafeNet Luna PIN Entry Device (PED) v2.8 contains new hardware that enables the PED to be USB-powered; there is no longer a requirement for an external DC power Adapter. PED v2.8 is functionally equivalent to your existing (previous-generation) PEDs and is compatible with HSM versions, 5.x, 6.x, and 7.x.</p>
        <p> PED v2.8 ships  with firmware 2.8.0. Note that you cannot upgrade existing PEDs to the 2.8.0 version; existing PEDs continue to need a separate DC power adapter for remote PED and upgrade use. The model number on the manufacturer's label identifies the refreshed PED: PED-06-0001. An installed driver is required; see step 1, below. </p>
        <h5>To use the new USB-powered PED</h5>
        <p class="ol1Start" data-mc-autonum="1."><span class="autonumber"><span class="ol1Number">1.</span></span>Ensure the SafeNet Luna HSM Client software is installed on the Windows computer that will act as the PED Server to your SafeNet Luna HSM. Installing the  Remote PED component of the SafeNet Luna client installs the required driver. </p>
        <p class="note" data-mc-autonum="&lt;span style=&quot;color: #6c286b;&quot; class=&quot;mcFormatColor&quot;&gt; &lt;b&gt;NOTE&lt;/b&gt; &#160;&#160;&lt;/span&gt;"><span class="autonumber"><span><span style="color: #6c286b;" class="mcFormatColor"> <b>NOTE</b> &#160;&#160;</span></span></span>A USB connection, without the driver software, only illuminates the PED screen, with no menu. An installed and running PED driver, on the connected computer, is required for the PED&#160;to fully boot and to display its menu.</p>
        <p class="ol1" data-mc-autonum="2."><span class="autonumber"><span class="ol1Number">2.</span></span>Connect the PED to the computer where you installed the Remote PED component of the SafeNet Luna client, using the USB micro connector on the PED and a USB socket on your computer.</p>
        <p class="ol1" data-mc-autonum="3."><span class="autonumber"><span class="ol1Number">3.</span></span>After you connect the PED to  the host computer, it will take 30 to 60 seconds for initial boot-up, during which time a series of messages are displayed, as listed below:</p>
        <p class="listLevel1" style="font-weight: bold;" data-mc-conditions="">BOOT V.1.1.0-1</p>
        <p class="listLevel1" style="font-weight: bold;" data-mc-conditions="">CORE V.3.0.0-1</p>
        <p class="listLevel1" style="font-weight: bold;" data-mc-conditions="">Loading PED...</p>
        <p class="listLevel1" style="font-weight: bold;" data-mc-conditions="">Entering...</p>
        <p class="ol1" data-mc-autonum="4."><span class="autonumber"><span class="ol1Number">4.</span></span>After the boot process is complete, the PED displays  <b>Local PED mode</b> and the <b>Awaiting command...</b> prompt. Your new PED is now ready for use. </p>
        <p class="ol1" data-mc-autonum="5."><span class="autonumber"><span class="ol1Number">5.</span></span>To enter Remote PED mode, if needed, exit Local PED mode with the "&lt; " key, and from the <b>Select Mode</b> menu, select option <b>7 &#160;Remote PED</b>.</p>
        <h3><a name="Uninstal"></a>Uninstalling the SafeNet Luna HSM Client Software</h3>
        <p>You need to uninstall SafeNet Luna HSM Client before installing a new version. If you wish to modify the installation (perhaps to add a component or product that you did not previously install), you must uninstall the current installation and re-install with the desired options. If you have a SafeNet Luna Backup HSM connected to the client workstation, either disconnect it or stop the PEDclient service (<a href="../../administration/PED_Auth/ped_utils/pedclient_mode_stop.htm" class="MCXref xref">pedclient mode stop</a>) before you proceed. </p>
        <h5>To uninstall the Luna HSM client software:</h5>
        <p class="ol1Start" data-mc-autonum="1."><span class="autonumber"><span class="ol1Number">1.</span></span>Run the <b>LunaHSMClient.exe</b> program again. Because the software is already installed on your computer, the following dialog is displayed, showing which components are currently installed (for this example, all Devices and all Features were previously installed):</p>
        <p class="listLevel1">
            <img src="../../Resources/Images/install/win_LunaHSMClient_04_all_uninstall-modify-quit.PNG" />
        </p>
        <p class="ol1" data-mc-autonum="2."><span class="autonumber"><span class="ol1Number">2.</span></span>Click  <b>Uninstall</b>. The client software is uninstalled. </p>
        <p class="listLevel1">
            <img src="../../Resources/Images/install/win_LunaHSMClient_07_uninstall-complete.PNG" />
        </p>
        <p class="ol1" data-mc-autonum="3."><span class="autonumber"><span class="ol1Number">3.</span></span>When the uninstallation is complete, click <b>OK</b> to dismiss the operating system's confirmation dialog.</p>
        <p class="note" data-mc-autonum="&lt;span style=&quot;color: #6c286b;&quot; class=&quot;mcFormatColor&quot;&gt; &lt;b&gt;NOTE&lt;/b&gt; &#160;&#160;&lt;/span&gt;"><span class="autonumber"><span><span style="color: #6c286b;" class="mcFormatColor"> <b>NOTE</b> &#160;&#160;</span></span></span>You can also use <b>Programs and Features</b> in the Windows Control Panel to uninstall the client software.</p>
        <h4>Uninstall if not present </h4>
        <p>If the Luna HSM Client software has been uninstalled, and you launch the installer in uninstall mode, from the command line, the installer starts, looks for the installed software, fails to find it, and presents a Windows dialog to that effect. </p>
        <p>
            <img src="../../Resources/Images/install/win_LunaHSMClient_08_uninstall-no-action.PNG" />
        </p>
        <p>If the Luna HSM Client software has been uninstalled, nothing related to the client appears in Windows Control Panel, so nothing exists to launch from that avenue.</p>
        <h3><a name="After"></a>After Installation</h3>
        <p class="NumberedList">When you have installed the software, 
 the next task is to configure the SafeNet Luna HSM, as described in the <i>Configuration Guide</i>. </p>
        <p class="NumberedList">Open a new command-line/console window to allow the library path to be found before you run LunaCM or other utilities that require the library. </p>
        <h3><a name="Trouble"></a>Troubleshooting</h3>
        <p>If you are not the Administrator of the computer on which Luna HSM Client is being installed, or if the bundle of permissions in your user profile does not allow you to launch the installer with "Run as Administrator", then some services might not install properly. One option is to have the Administrator perform the installation for you.</p>
        <p>Another approach might be possible. If you have sufficient elevated permissions, you might be able to right-click and open a Command Prompt window as Administrator. </p>
        <p>
            <img src="../../Resources/Images/install/run_command-prompt_as_administrator.png" />
        </p>
        <p>If that option is available, then you can use the command line to move to the location of the <b>LunaHSMClient.exe</b> file and launch it there, which permits the needed services to load for PEDclient. See <a href="scripted_unattended_install.htm" class="MCXref xref">Scripted/Unattended Windows Installation/Uninstallation</a> for instructions on how to install the client software from the command line.</p>
        <p class="footer"><span class="DefaultProduct">SafeNet Luna Network HSM</span> <span class="DefaultRelease">7.2</span> <span class="DefaultProjectTitle">Product Documentation</span> <br /><span class="DefaultPartNumber">007-013576-004</span> <span class="DefaultRevision">Rev. C</span> <span style="color: #5e5e5c;"><![CDATA[  ]]></span> <span class="DefaultDateLong">06 May 2019</span> <span style="color: #5e5e5c;"><![CDATA[  ]]></span> <span class="DefaultCopyright">Copyright 2001-2019</span>&#160;<span class="DefaultCompanyNameLong">Gemalto</span> <span style="color: #5e5e5c;"><![CDATA[  ]]></span>All rights reserved. </p>
    </body>
</html>