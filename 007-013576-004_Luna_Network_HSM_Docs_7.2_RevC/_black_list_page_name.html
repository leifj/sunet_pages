<!-- HTML header for doxygen 1.8.7-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.12"/>
<title>REST API: Black List</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="gemalto_logo.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">REST API
   &#160;<span id="projectnumber">7.2</span>
   </div>
   <div id="projectbrief">REST API for SafeNet Network HSMs</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.12 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('_black_list_page_name.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Black List </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1>Black List Overview </h1>
<p>The webserver includes a black list which is a system that will stop malicious users from making requests to the REST API. The system analyses a users request and detects malicious patterns. Once black listed a users IP will be blocked at the TCP socket level and will not be allowed a connection. All black list activity is logged in the lunalogs log file.</p>
<h1>Black Listable Offences (Number of Infractions) </h1>
<ul>
<li>Bad Login Credentials (2)</li>
<li>Request Timeout (5)</li>
<li>Certificate Renegotiation (1)</li>
<li>Bad Request Payload (1)</li>
</ul>
<h1>Advanced Black List Usage </h1>
<p>The black list can be configured in two ways, by using a severity percentage, or by modifying the attributes directly.</p>
<h2>Severity </h2>
<p>Severity is the simplest way to configure the black list, it describes how severe the black list is in percentage. Severity can be set to any value between 0 and 100. Setting the severity to 0 turns the black list off and 100 is the most severe. It is recommended to use 50% as it is the most lenient while still being effective at stopping malicious users, note that this is the default value.</p>
<h2>Attributes </h2>
<p>The black list is controlled by three attributes; "maxInfractionCount", "timeoutStart" and "timeoutMultiplier".</p>
<p>The maximum infraction count is the number of infractions that must be committed before a user is blacklisted. This is represented as an internal counter per user, when an infraction is committed the counter is incremented by the number of infractions committed. When the maximum number is reached the user is effectively blacklisted.</p>
<p>The timeout start is the amount of seconds before the infraction count is updated. Each user contains an update timer, the timer starts at this value but increments with each infraction (see timeout multiplier). When the timer is up the infraction counter for the current user is decreased, when it returns to zero the timer is reset to this value.</p>
<p>The timeout multiplier is the amount the timer increases with each infraction.</p>
<h2>Example </h2>
<p>Lets consider the following case, the web server's black list is configured with the following:</p>
<ul>
<li>maxInfractionCount = 5</li>
<li>timeoutStart = 1</li>
<li>timeoutMultiplier = 2</li>
</ul>
<p>Now say a user attempts to login but the credentials were incorrect. Login with bad credentials counts as 2 infractions therefore the infraction count is reduced by that amount bringing it down to 3 from 5. Additionally the timeout is incremented by the multiplier, this makes the timeout now 4 (timeout x multiplier ^ infractions). The user now needs to wait 4 seconds for its infraction count to increase to 4 from 3, however the timeout remains at 4 seconds until the next infraction is commited. If the user waits an additional 4 seconds the infraction count will be back to its default which causes the timeout to be reset to its "timeoutStart" value.</p>
<p>If we consider the case where a user might be more malicious where the amount of requests coming in will be much more aggressive. The user attempts to make 10 bad requests, 5 of those requests come through however the user is immediatly black listed. The timeout is now set to 32 seconds. The user waits 32 second and the infraction count is set to 1, the user then performs another bad request and is now black listed for 64 seconds. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<p class="footer">
<span class="DefaultProduct">REST API for SafeNet Network HSMs</span>
<span class="DefaultRelease">7.2</span>
<span class="DefaultProjectTitle">Reference Guide</span><br />
<span class="DefaultPartNumber">007-013576-005</span>
<span class="DefaultRevision">Rev. A</span>
<span style="color: #5e5e5c;"> <![CDATA[ ]]></span><span style="color: #5e5e5c;"> <![CDATA[ ]]></span>
<span class="DefaultCopyright">Copyright 2015-2018</span>&#160;
<span class="DefaultCompanyNameLong">Gemalto.</span>
<span style="color: #5e5e5c;"> <![CDATA[ ]]></span>All rights reserved. </p>
