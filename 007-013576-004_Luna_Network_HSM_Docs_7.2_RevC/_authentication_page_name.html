<!-- HTML header for doxygen 1.8.7-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.12"/>
<title>REST API: Authentication</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="gemalto_logo.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">REST API
   &#160;<span id="projectnumber">7.2</span>
   </div>
   <div id="projectbrief">REST API for SafeNet Network HSMs</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.12 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('_authentication_page_name.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Authentication </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1>Authenticating to a SafeNet Network HSM Appliance </h1>
<h1>1. Sessions </h1>
<p>REST API sessions store valuable information, they are required in order to use the service. There are two types of sessions that are available for use, user sessions and private sessions.</p>
<h2>1.1 User Session </h2>
<p>User sessions are the default session, when using basic authorization a user session will be used. User sessions are automatic and do not require a session header. User sessions are shared with all clients of the same user therefore they have limited access to resources.</p>
<h2>1.2 Private Session </h2>
<p>Private sessions need to be created using a resource (see <a class="el" href="auth_session_post_page_name.html">/auth/session</a>), this session is private and can only be used by the user that created it.</p>
<h1>2. Authentication </h1>
<p>In order to use the REST API service, you must authenticate to the web server on the SafeNet Network HSM appliance.</p>
<h2>2.1 Authorization Header </h2>
<p>The authorization header must be included in order to authenticate with the REST API. The REST API currently supports Basic Authorization and JWT access tokens.</p>
<p>2.1.1 <em>Basic Authorization</em></p>
<p>In order to use basic authorization the keyword "Basic" must be included in the "Authorization" header followed by a Base64 blob that contains your colon separated username and password. Basic authorization will use user sessions. The credentials for the admin and monitor users are the same as Luna Shell.</p>
<p>Example:</p>
<p>Authorization: Basic Base64(Username:Password)</p>
<p>Authorization: Basic QWxhZGRpbjpPcGVuU2VzYW1l</p>
<p>2.1.2 <em>JWT Access Tokens</em></p>
<p>In order to use JWT access tokens the keyword "Bearer" must be included in the "Authorization" header followed by a JWT in its compact serialization. JWT tokens need to be created using a resource (see <a class="el" href="auth_jwt_post_page_name.html">POST /auth/jwt</a>). They will eventually expire, though if necessary can be explicitly revoked (see <a class="el" href="auth_jwt_delete_page_name.html">DELETE /auth/jwt</a>). JWT access tokens will use user sessions.</p>
<p>Example:</p>
<p>Authorization: Bearer token</p>
<p>Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpbmZvIjoiV2VsbCBhcmVuJ3QgeW91IGEgY2xldmVyIG9uZSBmb3IgcmVhZGluZyB0aGlzISJ9.HYMl0hEoRrwqLSeSKENIlFidvbxlUxk4T7xLScD-K2o</p>
<h2>2.2 Certificate-Based Authentication </h2>
<p>The certificate-based authentication uses the following steps:</p>
<ul>
<li>Uploading the user certificate</li>
</ul>
<p>Step 1: Login to server using username and password</p>
<p>Step 2: Upload public key by posting to '/users/{user you wish to use}/certificates' with the certificate.</p>
<p>Replace everything within {} with the username to use in the login process</p>
<ul>
<li>Performing the login handshake</li>
</ul>
<p>Step 1: Create a challenge by invoking POST to '/auth/login/challenge' with your username and the client public key. The server responds with a cryptographic challenge and nonce parameters.</p>
<p>Step 2: Decode the obtained challenge and nonce using base64.</p>
<p>Step 3: Decrypt the decoded challenge using the client private key in order to continue with the login process.</p>
<p>Step 4: To get the answer of the challenge, XOR the decoded and decrypted challenge with the decoded nonce. The result is the un-encrypted challenge answer.</p>
<p>Step 5: Encrypt the answer with the server public key to obtain the final challenge response as expected by the server.</p>
<p>Step 6: In order to transmit it over REST, encode the encrypted answer using base64.</p>
<p>Step 7: Answer the challenge by invoking POST to '/auth/login/basic' with your encrypted challenge response.</p>
<p>The server responds with 204 return code if successful and 401 in case of authentication failure. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<p class="footer">
<span class="DefaultProduct">REST API for SafeNet Network HSMs</span>
<span class="DefaultRelease">7.2</span>
<span class="DefaultProjectTitle">Reference Guide</span><br />
<span class="DefaultPartNumber">007-013576-005</span>
<span class="DefaultRevision">Rev. A</span>
<span style="color: #5e5e5c;"> <![CDATA[ ]]></span><span style="color: #5e5e5c;"> <![CDATA[ ]]></span>
<span class="DefaultCopyright">Copyright 2015-2018</span>&#160;
<span class="DefaultCompanyNameLong">Gemalto.</span>
<span style="color: #5e5e5c;"> <![CDATA[ ]]></span>All rights reserved. </p>
