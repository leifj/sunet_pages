<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" data-mc-search-type="Stem" data-mc-help-system-file-name="index.xml" data-mc-path-to-help-system="../../../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-medium="non-print" data-mc-toc-path="HSM Administration Guide|[%=System.LinkedTitle%]">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>Comparison of Destruction/Denial Actions</title>
        <link href="../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" />
        <link href="../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" />
        <link href="../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" />
        <link href="../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" />
        <link href="../../Resources/TableStyles/Breadcrumbs.css" rel="stylesheet" />
        <link href="../../Resources/Stylesheets/Gemalto_Template.css" rel="stylesheet" />
        <link href="../../Resources/TableStyles/Page.css" rel="stylesheet" />
        <script src="../../../Resources/Scripts/custom.modernizr.js">
        </script>
        <script src="../../../Resources/Scripts/jquery.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.config.js">
        </script>
        <script src="../../../Resources/Scripts/foundation.min.js">
        </script>
        <script src="../../../Resources/Scripts/plugins.min.js">
        </script>
        <script src="../../../Resources/Scripts/MadCapAll.js">
        </script>
    </head>
    <body>
        <p class="MCWebHelpFramesetLink MCWebHelpFramesetLinkTop"><a href="../../../index.html#administration/decommission/destroy_scenarios.htm">Show Navigation</a>
        </p>
        <!-- Remove this comment to enable syntax highlighting		
        <script type="text/javascript" src="../Stylesheets/SyntaxHilite/Prism/prism.js"></script>
-->
        <table style="width: 100%;border-spacing: 0px 0px;mc-table-style: url('../../Resources/TableStyles/Breadcrumbs.css');border-left-style: none;border-left-width: 1px;border-left-color: #000000;border-right-style: none;border-right-width: 1px;border-right-color: #000000;border-top-style: none;border-top-width: 0px;border-top-color: #000000;border-bottom-style: none;border-bottom-width: 0px;" class="TableStyle-Breadcrumbs" cellspacing="0">
            <col style="width: 41px;" class="TableStyle-Breadcrumbs-Column-Column1" />
            <col class="TableStyle-Breadcrumbs-Column-Column1" />
            <tbody>
                <tr class="TableStyle-Breadcrumbs-Body-Body1">
                    <th class="TableStyle-Breadcrumbs-BodyB-Column1-Body1">
                        <p class="home" style="font-weight: normal;"><a href="../../Home_network.htm">Home</a> &gt;
                        </p>
                    </th>
                    <th class="TableStyle-Breadcrumbs-BodyA-Column1-Body1">
                        <div class="nocontent">
                            <div class="MCBreadcrumbsBox_0 breadcrumbs" data-mc-breadcrumbs-divider=" &gt; " data-mc-breadcrumbs-count="3" data-mc-toc="True"><span class="MCBreadcrumbsPrefix">  <![CDATA[ ]]></span>
                            </div>
                        </div>
                    </th>
                </tr>
            </tbody>
        </table>
        <h2>Comparison of Destruction/Denial Actions</h2>
        <p>Various operations on the <span class="DefaultProduct">SafeNet Luna Network HSM</span> are intended to make HSM contents unavailable to potential intruders. The effect of those actions are summarized and contrasted in the following table, along with notes on how to recognize and how to recover from each scenario.</p>
        <p><b>Scenario 1:</b> MTK is destroyed, HSM is unavailable, but use/access can be recovered after reboot <span style="font-weight: normal;">(See Note 1)</span></p>
        <p><b>Scenario 2:</b> KEK is destroyed (Real-Time Clock and NVRAM), HSM&#160;contents cannot be recovered without restore from backup <span style="font-weight: normal;">See Note 2)</span></p>
        <p data-mc-conditions="Default.SA"><b>Scenario 3:</b> Appliance admin password reset</p>
        <table style="mc-table-style: url('../../Resources/TableStyles/Page.css');border-top-style: solid;border-top-width: 1px;border-top-color: #000000;border-bottom-style: solid;border-bottom-width: 1px;border-bottom-color: #000000;margin-left: 0;margin-right: auto;caption-side: top;width: 100%;" class="TableStyle-Page" cellspacing="0">
            <col class="TableStyle-Page-Column-Column1" />
            <col class="TableStyle-Page-Column-Column1" style="width: 57px;" />
            <col class="TableStyle-Page-Column-Column1" style="width: 57px;" />
            <col class="TableStyle-Page-Column-Column1" style="width: 57px;" data-mc-conditions="Default.SA" />
            <col class="TableStyle-Page-Column-Column1" />
            <col class="TableStyle-Page-Column-Column1" />
            <thead>
                <tr class="TableStyle-Page-Head-Header1">
                    <th class="TableStyle-Page-HeadE-Column1-Header1">Event</th>
                    <th class="TableStyle-Page-HeadE-Column1-Header1">
                        <p>Scen. 1</p>
                    </th>
                    <th class="TableStyle-Page-HeadE-Column1-Header1">Scen. 2</th>
                    <th class="TableStyle-Page-HeadE-Column1-Header1">Scen. 3</th>
                    <th class="TableStyle-Page-HeadE-Column1-Header1">How to discover <br /><span style="font-weight: normal;">(See Note 3)</span></th>
                    <th class="TableStyle-Page-HeadD-Column1-Header1">How to recover</th>
                </tr>
            </thead>
            <tbody>
                <tr class="TableStyle-Page-Body-Body1">
                    <td class="TableStyle-Page-BodyE-Column1-Body1">
                        <p class="ul1" data-mc-autonum="&lt;b&gt;&amp;gt;&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>&gt;</b></span></span>Three bad SO login attempts </p>
                        <p class="ul1" data-mc-autonum="&lt;b&gt;&amp;gt;&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>&gt;</b></span></span>
                            <MadCap:conditionalText data-mc-conditions="Default.SA">lunash:&gt; <b>hsm zeroize</b></MadCap:conditionalText>
                        </p>
                        <p class="ul1" data-mc-autonum="&lt;b&gt;&amp;gt;&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>&gt;</b></span></span>
                            <MadCap:conditionalText data-mc-conditions="Default.SA">lunash:&gt; hsm <b>factoryreset</b></MadCap:conditionalText>
                        </p>
                        <p class="ul1" data-mc-autonum="&lt;b&gt;&amp;gt;&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>&gt;</b></span></span>Any change to a destructive policy </p>
                        <p class="ul1" data-mc-autonum="&lt;b&gt;&amp;gt;&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>&gt;</b></span></span>Firmware rollback (See Note 4)<br /></p>
                    </td>
                    <td class="TableStyle-Page-BodyE-Column1-Body1">NO</td>
                    <td class="TableStyle-Page-BodyE-Column1-Body1">YES</td>
                    <td class="TableStyle-Page-BodyE-Column1-Body1">NO</td>
                    <td class="TableStyle-Page-BodyE-Column1-Body1">
                        <p class="ul1" data-mc-autonum="&lt;b&gt;&amp;gt;&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>&gt;</b></span></span>Log entry</p>
                        <p class="ul1" data-mc-autonum="&lt;b&gt;&amp;gt;&lt;/b&gt;" data-mc-conditions="Default.SA"><span class="autonumber"><span class="ul1Bullet"><b>&gt;</b></span></span>"HSM IS ZEROIZED" in HSM Details (from <b>hsm show</b> command)</p>
                    </td>
                    <td class="TableStyle-Page-BodyD-Column1-Body1">Restore HSM objects from Backup</td>
                </tr>
                <tr class="TableStyle-Page-Body-Body1" data-mc-conditions="Default.SA">
                    <td class="TableStyle-Page-BodyE-Column1-Body1">
                        <p>Log in to <span class="DefaultProduct">SafeNet Luna Network HSM</span> "recover" account (local serial connection)</p>
                    </td>
                    <td class="TableStyle-Page-BodyE-Column1-Body1">NO</td>
                    <td class="TableStyle-Page-BodyE-Column1-Body1">NO</td>
                    <td class="TableStyle-Page-BodyE-Column1-Body1">YES</td>
                    <td class="TableStyle-Page-BodyE-Column1-Body1">Log entry shows login by "recover"</td>
                    <td class="TableStyle-Page-BodyD-Column1-Body1">Log into appliance as admin, using the reset password "PASSWORD" and change to a secure password</td>
                </tr>
                <tr class="TableStyle-Page-Body-Body1">
                    <td class="TableStyle-Page-BodyE-Column1-Body1">
                        <p> Hardware tamper </p>
                        <p class="ul1" data-mc-autonum="&lt;b&gt;&amp;gt;&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>&gt;</b></span></span>Undervoltage or overvoltage during operation</p>
                        <p class="ul1" data-mc-autonum="&lt;b&gt;&amp;gt;&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>&gt;</b></span></span>Under-temperature or over-temperature during operation</p>
                        <p class="ul1" data-mc-autonum="&lt;b&gt;&amp;gt;&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>&gt;</b></span></span>Chassis interference (such as cover, fans, etc.) <br /></p>
                        <p>Software (command-initiated) tamper</p>
                        <p class="ul1" data-mc-autonum="&lt;b&gt;&amp;gt;&lt;/b&gt;" data-mc-conditions="Default.SA"><span class="autonumber"><span class="ul1Bullet"><b>&gt;</b></span></span>lunash:&gt; <b>hsm stm transport</b><br /></p>
                    </td>
                    <td class="TableStyle-Page-BodyE-Column1-Body1">YES</td>
                    <td class="TableStyle-Page-BodyE-Column1-Body1">NO</td>
                    <td class="TableStyle-Page-BodyE-Column1-Body1">NO</td>
                    <td class="TableStyle-Page-BodyE-Column1-Body1">
                        <p>Parse logs for text like "tamper", "TVK was corrupted", or "Generating new TVK", indicating that a tamper event was logged. Example: </p><pre xml:space="preserve"><code>RTC: external tamper </code><code>latched/</code></pre><pre xml:space="preserve"><code>MTK: </code><code>security </code><code>function </code><code>was </code></pre><pre xml:space="preserve"><code>zeroized </code><code>on previous tamper </code></pre><pre xml:space="preserve"><code>event and has </code><code>not </code><code>been </code></pre><pre xml:space="preserve"><code>restored yet</code>  </pre><pre xml:space="preserve">   </pre>
                        <p>Also, keywords in logs like: "HSM internal error", "device error"
</p>
                        <p data-mc-conditions="Default.SA"><span class="DefaultProduct">SafeNet Luna Network HSM</span> appliance front panel flashes error 30.</p>
                    </td>
                    <td class="TableStyle-Page-BodyD-Column1-Body1">Reboot <br />[See Note 1]</td>
                </tr>
                <tr class="TableStyle-Page-Body-Body1">
                    <td class="TableStyle-Page-BodyE-Column1-Body1">
                        <p>Decommission</p>
                        <p class="ul1" data-mc-autonum="&lt;b&gt;&amp;gt;&lt;/b&gt;" data-mc-conditions="Default.SA"><span class="autonumber"><span class="ul1Bullet"><b>&gt;</b></span></span>Pressing the Decommission button on the back of the appliance</p>
                    </td>
                    <td class="TableStyle-Page-BodyE-Column1-Body1">NO</td>
                    <td class="TableStyle-Page-BodyE-Column1-Body1">YES</td>
                    <td class="TableStyle-Page-BodyE-Column1-Body1">NO</td>
                    <td class="TableStyle-Page-BodyE-Column1-Body1">
                        <p>Look for log entry like:</p>
                        <p>RTC: tamper 2 signal/Zeroizing HSM after decommission...LOG(INFO): POWER-UP LOG DUMP END
</p>
                    </td>
                    <td class="TableStyle-Page-BodyD-Column1-Body1">Restore HSM objects from Backup</td>
                </tr>
                <tr class="TableStyle-Page-Body-Body1">
                    <td class="TableStyle-Page-BodyA-Column1-Body1" colspan="6">
                        <p colspan="5"><b>Note 1:</b> MTK is an independent layer of encryption on HSM contents, to manage tamper and Secure Transport Mode. A destroyed MTK is recovered on next reboot. If MTK&#160;cannot be recovered, only restoring from backup onto a new or re-manufactured HSM can retrieve your keys and HSM data.</p>
                        <p colspan="5"><b>Note 2:</b> KEK is an HSM-wide encryption layer that encrypts all HSM objects, excluding only MTK, RPK, a wrapping key, and a couple of keys used for legacy support. A destroyed KEK cannot be recovered. If the KEK is destroyed, only restoring from backup can retrieve your keys and HSM data.</p>
                        <p colspan="5"><b>Note 3:</b> To check the health of a remote HSM, script a frequent login to the HSM host and execution of a subset of HSM commands. If a command fails, check the logs for an indication of the cause.</p>
                        <p colspan="5"><b>Note 4:</b> These actions all create a situation where <b>hsm init</b> is required, or strongly recommended before the HSM is used again. <br /></p>
                    </td>
                </tr>
            </tbody>
        </table>
        <p>In addition, another event/action that has a destructive component is HSM initialization. See <a href="../../configuration/hsm_init/hsm_initialization.htm" class="MCXref xref">HSM&#160;Initialization</a>.</p>
        <p class="footer"><span class="DefaultProduct">SafeNet Luna Network HSM</span> <span class="DefaultRelease">7.2</span> <span class="DefaultProjectTitle">Product Documentation</span> <br /><span class="DefaultPartNumber">007-013576-004</span> <span class="DefaultRevision">Rev. C</span> <span style="color: #5e5e5c;"><![CDATA[  ]]></span> <span class="DefaultDateLong">06 May 2019</span> <span style="color: #5e5e5c;"><![CDATA[  ]]></span> <span class="DefaultCopyright">Copyright 2001-2019</span>&#160;<span class="DefaultCompanyNameLong">Gemalto</span> <span style="color: #5e5e5c;"><![CDATA[  ]]></span>All rights reserved. </p>
    </body>
</html>