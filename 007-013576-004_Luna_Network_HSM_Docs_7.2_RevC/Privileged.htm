<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" data-mc-search-type="Stem" data-mc-help-system-file-name="index.xml" data-mc-path-to-help-system="../../../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-medium="non-print" data-mc-toc-path="Syslog and SNMP Monitoring Guide|[%=System.LinkedTitle%]">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>Privileged Services</title>
        <link href="../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" />
        <link href="../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" />
        <link href="../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" />
        <link href="../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" />
        <link href="../../Resources/TableStyles/Breadcrumbs.css" rel="stylesheet" />
        <link href="../../Resources/Stylesheets/Gemalto_Template.css" rel="stylesheet" />
        <link href="../../Resources/TableStyles/Page.css" rel="stylesheet" />
        <script src="../../../Resources/Scripts/custom.modernizr.js">
        </script>
        <script src="../../../Resources/Scripts/jquery.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.config.js">
        </script>
        <script src="../../../Resources/Scripts/foundation.min.js">
        </script>
        <script src="../../../Resources/Scripts/plugins.min.js">
        </script>
        <script src="../../../Resources/Scripts/MadCapAll.js">
        </script>
    </head>
    <body>
        <p class="MCWebHelpFramesetLink MCWebHelpFramesetLinkTop"><a href="../../../index.html#monitoring/open_source/Privileged.htm">Show Navigation</a>
        </p>
        <!-- Remove this comment to enable syntax highlighting		
        <script type="text/javascript" src="../Stylesheets/SyntaxHilite/Prism/prism.js"></script>
-->
        <table style="width: 100%;border-spacing: 0px 0px;mc-table-style: url('../../Resources/TableStyles/Breadcrumbs.css');border-left-style: none;border-left-width: 1px;border-left-color: #000000;border-right-style: none;border-right-width: 1px;border-right-color: #000000;border-top-style: none;border-top-width: 0px;border-top-color: #000000;border-bottom-style: none;border-bottom-width: 0px;" class="TableStyle-Breadcrumbs" cellspacing="0">
            <col style="width: 41px;" class="TableStyle-Breadcrumbs-Column-Column1" />
            <col class="TableStyle-Breadcrumbs-Column-Column1" />
            <tbody>
                <tr class="TableStyle-Breadcrumbs-Body-Body1">
                    <th class="TableStyle-Breadcrumbs-BodyB-Column1-Body1">
                        <p class="home" style="font-weight: normal;"><a href="../../Home_network.htm">Home</a> &gt;
                        </p>
                    </th>
                    <th class="TableStyle-Breadcrumbs-BodyA-Column1-Body1">
                        <div class="nocontent">
                            <div class="MCBreadcrumbsBox_0 breadcrumbs" data-mc-breadcrumbs-divider=" &gt; " data-mc-breadcrumbs-count="3" data-mc-toc="True"><span class="MCBreadcrumbsPrefix">  <![CDATA[ ]]></span>
                            </div>
                        </div>
                    </th>
                </tr>
            </tbody>
        </table>
        <h2>Privileged Services</h2>
        <table style="mc-table-style: url('../../Resources/TableStyles/Page.css');width: 100%;" class="TableStyle-Page" cellspacing="0">
            <col style="width: 33.3%;" class="TableStyle-Page-Column-Column1" />
            <col style="width: 33.3%;" class="TableStyle-Page-Column-Column1" />
            <col style="width: 33.3%;" class="TableStyle-Page-Column-Column1" />
            <thead>
                <tr class="TableStyle-Page-Head-Header1">
                    <th class="TableStyle-Page-HeadE-Column1-Header1">
                        <p>Facility Keyword</p>
                    </th>
                    <th class="TableStyle-Page-HeadE-Column1-Header1">
                        <p>Software Process</p>
                    </th>
                    <th class="TableStyle-Page-HeadD-Column1-Header1">
                        <p>Log File</p>
                    </th>
                </tr>
            </thead>
            <tbody>
                <tr class="TableStyle-Page-Body-Body1">
                    <td class="TableStyle-Page-BodyB-Column1-Body1">
                        <p><code>Authpriv</code>
                        </p>
                    </td>
                    <td class="TableStyle-Page-BodyB-Column1-Body1">
                        <p>See list that follows</p>
                    </td>
                    <td class="TableStyle-Page-BodyA-Column1-Body1">
                        <p><code>secure</code>
                        </p>
                    </td>
                </tr>
            </tbody>
        </table>
        <p>The following privileged services log messages to the secure log file with a software process identifier if shown.</p>
        <p class="ul1" data-mc-autonum="&lt;b&gt;&amp;gt;&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>&gt;</b></span></span>useradd[pid]</p>
        <p class="ul1" data-mc-autonum="&lt;b&gt;&amp;gt;&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>&gt;</b></span></span>chage[pid]</p>
        <p class="ul1" data-mc-autonum="&lt;b&gt;&amp;gt;&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>&gt;</b></span></span>passwd</p>
        <p class="ul1" data-mc-autonum="&lt;b&gt;&amp;gt;&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>&gt;</b></span></span>usermod[pid]</p>
        <p class="ul1" data-mc-autonum="&lt;b&gt;&amp;gt;&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>&gt;</b></span></span>login</p>
        <p class="ul1" data-mc-autonum="&lt;b&gt;&amp;gt;&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>&gt;</b></span></span>groupadd[pid]</p>
        <h3>Expected Log Messages</h3>
        <h4>useradd</h4><pre xml:space="preserve">2012 Feb 29 12:05:01 myLuna&#160; authpriv info&#160; useradd[1234]: new user: name=recover, UID=0, GID=0, home=/home/recover, shell=/usr/lunasa/bin/recover
2012 Feb 29 12:05:01 myLuna&#160; authpriv info&#160; useradd[1234]: new user: name=&lt;admin | monitor | operator&gt;, UID=0, GID=0, home=/home/admin, shell=/usr/lunasa/lush/lush
2012 Feb 29 12:05:01 myLuna&#160; authpriv info&#160; useradd[1234]: new user: name=mysql, UID=500, GID=500, home=/usr/local/mysql, shell=/sbin/nologin

</pre>
        <p>These messages indicate that the Linux utility <b>useradd(1)</b> successfully created accounts for the identified user (e.g., recover, admin, monitor, operatory or mysql).</p>
        <h4>chage</h4><pre xml:space="preserve">2012 Feb 29 12:05:01 myLuna&#160; authpriv info&#160; chage[1234]: changed password expiry for &lt;username&gt;

</pre>
        <p>This message indicates that the Linux utility <b>chage(1)</b> successfully changed the number of days between password changes and the date of the last password change for &lt;username&gt;. &lt;username&gt; is one of “admin”, “operator”, “monitor” or a user created by an administrator.</p>
        <h4>passwd</h4><pre xml:space="preserve">2012 Feb 29 12:05:01 myLuna&#160; authpriv notice&#160; passwd: pam_unix(passwd:chauthtok): password changed for admin

</pre>
        <p>This message indicates that the Linux utility <b>passwd(1)</b> successfully updated the admin user’s authentication token.</p>
        <h4>usermod</h4><pre xml:space="preserve">2012 Feb 29 12:05:01 myLuna&#160; authpriv info&#160; authpriv info&#160; usermod[1234]: change user '&lt;username&gt;' password

</pre>
        <p>This message indicates that the Linux utility <b>usermod(1)</b> successfully updated the login information for &lt;username&gt;. &lt;username&gt; is one of “admin”, “operator”, “monitor” or “audit.”</p>
        <h4>login</h4><pre xml:space="preserve">2012 Feb 29 12:05:01 myLuna&#160; authpriv&#160; authpriv info&#160; login: pam_unix(login:session): session opened for user &lt; admin | recover&gt;  by LOGIN(uid=0)
2012 Feb 29 12:05:01 myLuna&#160; authpriv authpriv info&#160; login: pam_unix(login:session): session closed for user &lt;admin | recover&gt;
2012 Feb 29 12:05:01 myLuna&#160; authpriv authpriv info&#160; login: DIALUP AT ttyS0 BY &lt;admin | recover&gt;

</pre>
        <p>The first two messages indicate that the Linux utility <b>login(1)</b> successfully established a new session with the <span class="DefaultProduct">SafeNet Luna Network HSM</span> appliance or terminated a session. The third message indicates that the session is via the serial port on the front console of the appliance.</p>
        <h4>groupadd</h4><pre xml:space="preserve">2012 Feb 29 12:05:01 myLuna&#160; authpriv authpriv info&#160; groupadd[2558]: new group: name=&lt;uucp | mysql&gt;, GID=&lt;14 | 500&gt;

</pre>
        <p>This message indicates that the Linux utility <b>groupadd(1)</b> successfully created a new group definition with the GID shown. The &lt;gid&gt; for uucp is 14; for mysql, 500.</p>
        <h3>Unexpected Log Messages</h3>
        <p>Under normal circumstances, you should not see any of these log messages. If you do, please contact <span class="DefaultCompanyNameLong">Gemalto</span> Technical Support to report the message and seek guidance on what to do next.</p>
        <h4>login</h4><pre xml:space="preserve">2012 Feb 29 12:05:01 myLuna&#160; authpriv authpriv alert&#160; login: pam_unix(login:auth): check pass; user unknown
2012 Feb 29 12:05:01 myLuna&#160; authpriv authpriv notice&#160; login: pam_unix(login:auth): authentication failure; logname=LOGIN uid=0 euid=0 tty=ttyS0 ruser=&lt;user name&gt; rhost=192.168.0.100
2012 Feb 29 12:05:01 myLuna&#160; authpriv authpriv crit&#160; login: pam_succeed_if(login:auth): error retrieving information about user &lt;user name&gt;
2012 Feb 29 12:05:01 myLuna&#160; authpriv authpriv notice&#160; login: FAILED LOGIN 1 FROM (null) FOR &lt;user name&gt;, User not known to the underlying authentication module
2012 Feb 29 12:05:01 myLuna&#160; authpriv authpriv alert&#160; login: PAM service(login) ignoring max retries; 4 &gt; 3
2012 Feb 29 12:05:01 myLuna&#160; authpriv authpriv err&#160; login: Authentication failure

</pre>
        <p>These messages indicate failure on the part of an administrator to login to the <span class="DefaultProduct">SafeNet Luna Network HSM</span> appliance. The first four messages indicate that the login attempt was with a username unknown to the appliance. The fifth message indicates that the threshold number of failed login attempts has been reached or exceeded. The last message is the Luna IS-specific message in place of the second message above.</p>
        <p class="footer"><span class="DefaultProduct">SafeNet Luna Network HSM</span> <span class="DefaultRelease">7.2</span> <span class="DefaultProjectTitle">Product Documentation</span> <br /><span class="DefaultPartNumber">007-013576-004</span> <span class="DefaultRevision">Rev. C</span> <span style="color: #5e5e5c;"><![CDATA[  ]]></span> <span class="DefaultDateLong">06 May 2019</span> <span style="color: #5e5e5c;"><![CDATA[  ]]></span> <span class="DefaultCopyright">Copyright 2001-2019</span>&#160;<span class="DefaultCompanyNameLong">Gemalto</span> <span style="color: #5e5e5c;"><![CDATA[  ]]></span>All rights reserved. </p>
    </body>
</html>