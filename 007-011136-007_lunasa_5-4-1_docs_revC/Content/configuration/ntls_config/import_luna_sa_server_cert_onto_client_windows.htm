<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" class="" data-mc-search-type="Stem" data-mc-help-system-file-name="index.xml" data-mc-path-to-help-system="../../../" data-mc-conditions="Primary.Default" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-medium="non-print" data-mc-toc-path="Configuration Guide|[Step 6] Set up a Network Trust Link|Windows NTL Setup">
    <head>
        <meta charset="utf-8" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>Import Luna Server Cert onto Client (Windows)</title>
        <link href="../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" />
        <link href="../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" />
        <link href="../../Resources/TableStyles/Breadcrumbs.css" rel="stylesheet" />
        <link href="../../Resources/Stylesheets/SafeNet_Template.css" rel="stylesheet" />
        <script src="../../../Resources/Scripts/jquery.min.js">
        </script>
        <script src="../../../Resources/Scripts/plugins.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.config.js">
        </script>
        <script src="../../../Resources/Scripts/MadCapAll.js">
        </script>
    </head>
    <body>
        <p class="MCWebHelpFramesetLink MCWebHelpFramesetLinkTop"><a href="../../../index.html#configuration/ntls_config/import_luna_sa_server_cert_onto_client_windows.htm">Open topic with navigation</a>
        </p>
        <table style="width: 100%;border-spacing: 0px 0px;mc-table-style: url('../../Resources/TableStyles/Breadcrumbs.css');border-left-style: none;border-left-width: 1px;border-left-color: #000000;border-right-style: none;border-right-width: 1px;border-right-color: #000000;border-top-style: none;border-top-width: 0px;border-top-color: #000000;border-bottom-style: solid;border-bottom-width: 2px;border-bottom-color: #e6e6e6;" class="TableStyle-Breadcrumbs" cellspacing="0">
            <col style="width: 41px;" class="TableStyle-Breadcrumbs-Column-Column1" />
            <col class="TableStyle-Breadcrumbs-Column-Column1" />
            <tbody>
                <tr class="TableStyle-Breadcrumbs-Body-Body1">
                    <th class="TableStyle-Breadcrumbs-BodyB-Column1-Body1">
                        <p class="home" style="font-weight: normal;"><a href="../../Home_sa.htm">Home</a> &gt;
                        </p>
                    </th>
                    <th class="TableStyle-Breadcrumbs-BodyA-Column1-Body1">
                        <div class="MCBreadcrumbsBox_0"><span class="MCBreadcrumbsPrefix"> </span><span class="MCBreadcrumbsSelf">Configuration Guide</span><span class="MCBreadcrumbsDivider"> &gt; </span><a class="MCBreadcrumbsLink" href="prepare_the_client_for_network_trust_link.htm">[Step 6] Set up a Network Trust Link</a><span class="MCBreadcrumbsDivider"> &gt; </span><a class="MCBreadcrumbsLink" href="ntls_prep_windows.htm">Windows NTL Setup</a><span class="MCBreadcrumbsDivider"> &gt; </span><span class="MCBreadcrumbs">Import Luna Server Cert onto Client (Windows)</span>
                        </div>
                    </th>
                </tr>
            </tbody>
        </table>
        <h3><a name="kanchor48"></a><a name="kanchor49"></a>Import HSM Appliance Server Certificate onto Client (Windows)</h3>
        <p class="ol1Start" data-mc-autonum="1."><span class="autonumber"><span class="ol1Number">1.</span></span>Open a command 
 prompt window on the Client, and change directory to <span style="font-family: 'Courier New', monospace;">c:\Program 
 Files\Safenet\LunaClient\</span>. &#160;</p>
        <p class="ol1" data-mc-autonum="2."><span class="autonumber"><span class="ol1Number">2.</span></span>Securely transfer 
 the <span style="font-family: 'Courier New', monospace;">server.pem</span> 
 file from the Luna SA, using the supplied pscp  utility. <span style="font-family: 'Courier New', monospace;"><br />c:\Program Files\SafeNet\LunaClient\ &gt; pscp admin@myLuna:server.pem 
 . &#160;<br />admin@myLuna's password: &#160;&#160;<br />server.pem &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;100% 
 &#160;&#160;<br />|*******************************************************| 
 &#160;&#160;928 
 &#160;<br />00:00</span> <br />Note the dot (.) at the end of the command, denoting “place the resulting 
 file in the current directory”.</p>
        <p class="ol1" data-mc-autonum="3."><span class="autonumber"><span class="ol1Number">3.</span></span><a name="kanchor50"></a>Verify that the 
 Server Certificate has arrived on the Client: <span style="font-family: 'Courier New', monospace;"><br />c:\Program Files\SafeNet\LunaClient\ &gt; dir &#160;<br />server.pem</span> <![CDATA[ ]]></p>
        <p class="ol1" data-mc-autonum="4."><span class="autonumber"><span class="ol1Number">4.</span></span>
            <p>Move the Server Certificate to the cert/server directory: <br /><span style="font-family: 'Courier New', monospace;">move server.pem c:\Program Files\SafeNet\LunaClient\cert\server</span></p>
        </p>
        <p>&#160;</p>
        <p>You might need to surround the entire filespec (path and filename) within quotation marks if Windows stumbles at the space between Program and Files.</p>
        <p>If the operations fail - and you have verified that the commands are typed correctly - then you might lack file permissions in the affected directories. If you lack administrator privileges on your computer, contact your IT department. If you do have the required privileges, then you might need to adjust the permissions for the affected directories (which by default are installed in the protected Windows directory "Program Files"). </p>
        <p>To adjust the permissions for the directory c:\Program Files\SafeNet\LunaClient\, right-click that directory. In the resulting context menu, select Properties, and in the ensuing dialog select the "Security" tab. Choose the appropriate user or group and adjust as needed. Then repeat the commands in the steps above, which should now work as expected.</p>
        <p>
            <img src="../../Resources/Images/give_yourself_directory_permissions.png" alt="Give yourself the needed permissions on the certificate directories so you can complete the certificate exhange and registration with the Luna appliance." title="This is just an example to allow you to copy a file into the directory and register. Yours will differ. If you have a problem, contact your company's Help Desk." />
        </p>
        <p>&#160;</p>
        <p>The appearance might vary slightly for different Windows versions. If the permissions change does not propagate to sub-directories, then you might need to repeat the process for the "cert" sub-directory and for the "client" and "server" sub-directories.</p>
        <p>&#160;</p>
        <h5>Example </h5>
        <p>Securely transfer the server.pem file from the Luna SA, using the 
 supplied pscp utility. <span style="font-family: 'Courier New', monospace;"><br />c:\Program Files\SafeNet\LunaClient\ &gt; pscp admin@192.168.0.123:server.pem 
 . <br />admin@192.168.0.123's password: &#160;&#160;<br />server.pem &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;100% 
 &#160;&#160;<br />|*******************************************************| 
 &#160;&#160;928 
 &#160;<br />00:00</span> <![CDATA[ ]]></p>
        <p class="notepad_note">Any time the IP or hostname 
 of the HSM appliance has changed (such as moving from a pre-production 
 environment), the client(s) that have previously connected via SSH will 
 detect a mismatch in the HSM appliance's server certification information 
 and warn you of potential security breach. &#160;In 
 this case you will need to remove that server's certificate information 
 from the client’s known host file found in: <span style="font-family: 'Courier New', monospace;"><br />/&lt;user home dir&gt;/.ssh/known_hosts2</span> <br /><br />If this is happening in a production environment, 
 this could potentially be a security breach needing investigation.&#160;<br /><br />Similarly, when you first open a scp or 
 ssh link, you must accept the certificate.<br />You can check the fingerprint of the certificate with: <span style="font-family: 'Courier New', monospace;"><br />lunash:&gt; sysconf fingerprint -ssh</span> <![CDATA[ ]]></p>
        <p>Next, see&#160;<a href="register_the_hsm_server_cert_with_the_client_windows.htm" class="MCXref xref "><span style="color: #6c286b;" class="mcFormatColor">"Register the HSM Server Certificate with the Client (Windows)"</span></a>. &#160;&#160;</p>
        <p class="footer"><span class="DefaultProduct">Luna SA</span> <span class="DefaultRelease">5.4.1</span> <span class="DefaultProjectTitle">Product Documentation</span> <br /><span class="DefaultPartNumber">007-011136-007</span> <span class="DefaultRevision">Rev C</span> <span style="color: #5e5e5c;"> <![CDATA[ ]]></span> <span class="DefaultDateShort">July 2014</span> <span style="color: #5e5e5c;"> <![CDATA[ ]]></span> <span class="DefaultCopyright">Copyright 2014</span>&#160;<span class="DefaultCompanyNameLong">SafeNet, Inc.</span> <span style="color: #5e5e5c;"> <![CDATA[ ]]></span>All rights reserved. </p>
        <p class="MCWebHelpFramesetLink MCWebHelpFramesetLinkBottom"><a href="../../../index.html#configuration/ntls_config/import_luna_sa_server_cert_onto_client_windows.htm">Open topic with navigation</a>
        </p>
    </body>
</html>