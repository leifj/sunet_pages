<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" data-mc-search-type="Stem" data-mc-help-system-file-name="index.xml" data-mc-path-to-help-system="../../../" data-mc-conditions="Primary.LunaIS,Primary.Default" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-medium="non-print" data-mc-toc-path="Installation Guide| Luna Client Software Installation">
    <head>
        <meta charset="utf-8" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>Windows  Luna Client Installation</title>
        <link href="../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" />
        <link href="../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" />
        <link href="../../Resources/TableStyles/Breadcrumbs.css" rel="stylesheet" />
        <link href="../../Resources/Stylesheets/SafeNet_Template.css" rel="stylesheet" />
        <script src="../../../Resources/Scripts/jquery.min.js">
        </script>
        <script src="../../../Resources/Scripts/plugins.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.config.js">
        </script>
        <script src="../../../Resources/Scripts/MadCapAll.js">
        </script>
    </head>
    <body>
        <p class="MCWebHelpFramesetLink MCWebHelpFramesetLinkTop"><a href="../../../index.html#install/software/windows_install.htm">Open topic with navigation</a>
        </p>
        <table style="width: 100%;border-spacing: 0px 0px;mc-table-style: url('../../Resources/TableStyles/Breadcrumbs.css');border-left-style: none;border-left-width: 1px;border-left-color: #000000;border-right-style: none;border-right-width: 1px;border-right-color: #000000;border-top-style: none;border-top-width: 0px;border-top-color: #000000;border-bottom-style: solid;border-bottom-width: 2px;border-bottom-color: #e6e6e6;" class="TableStyle-Breadcrumbs" cellspacing="0">
            <col style="width: 41px;" class="TableStyle-Breadcrumbs-Column-Column1" />
            <col class="TableStyle-Breadcrumbs-Column-Column1" />
            <tbody>
                <tr class="TableStyle-Breadcrumbs-Body-Body1">
                    <th class="TableStyle-Breadcrumbs-BodyB-Column1-Body1">
                        <p class="home" style="font-weight: normal;"><a href="../../Home_sa.htm">Home</a> &gt;
                        </p>
                    </th>
                    <th class="TableStyle-Breadcrumbs-BodyA-Column1-Body1">
                        <div class="MCBreadcrumbsBox_0"><span class="MCBreadcrumbsPrefix">  <![CDATA[ ]]></span><span class="MCBreadcrumbsSelf">Installation Guide</span><span class="MCBreadcrumbsDivider"> &gt; </span><a class="MCBreadcrumbsLink" href="software.htm"> Luna Client Software Installation</a><span class="MCBreadcrumbsDivider"> &gt; </span><span class="MCBreadcrumbs">Windows  Luna Client Installation</span>
                        </div>
                    </th>
                </tr>
            </tbody>
        </table>
        <h2 class="pageBreak">Windows  Luna Client Installation</h2>
        <p>Applicability to specific versions of Windows is summarized in the Customer Release Notes for this release.</p>
        <p class="note" data-mc-autonum="&lt;b&gt;Note:&lt;/b&gt; &#160;"><span class="autonumber"><span><b>Note:</b> &#160;</span></span>Before 
 installing a Luna® 
 system, you should confirm that the product you have received is in factory 
 condition and has not been tampered with in transit. &#160;Refer 
 to the Startup Guide included with your product shipment. &#160;If 
 you have any questions about the condition of the product that you have 
 received, please contact SafeNet Support (800)545 6608 or support@safenet-inc.com 
 immediately.</p>
        <h3>Required Client Software</h3>
        <p>Each computer that connects to the Luna SA as a Client must have the 
 cryptoki library, the vtl client shell and other utilities and supporting 
 files installed. </p>
        <p>Each computer that contains, or is connected to a Luna&#160;PCI-E or a Luna&#160;G5 HSM must have the cryptoki library and other utilities and supporting files installed. &#160;</p>
        <p class="note" data-mc-autonum="&lt;b&gt;Note:&lt;/b&gt; &#160;"><span class="autonumber"><span><b>Note:</b> &#160;</span></span><strong>.NET framework</strong> - before installing Luna Client on  Windows 2012 platform, install Microsoft .NET framework version 3.5,first. You can have other versions of .NET on your system (there is no conflict), but 3.5 is needed for Luna Client to launch HTL on Windows 2012.<br />For additional information see <a href="windows-2012_install_supplement.htm" class="MCXref xref "><span style="color: #6c286b;" class="mcFormatColor">"Windows 2012 Luna Client Supplemental Configuration"</span></a>. &#160;On Windows Server 2008, Luna Client installs and HTL works without additional Windows components.</p>
        <h3>Installing the Luna Client Software</h3>
        <p>The supported Windows servers are 64-bit. They allow running of 32-bit or 64-bit applications. </p>
        <p>For compatibility of our HSMs with Windows in general, we provide both 32-bit and 64-bit libraries for use with your applications as appropriate, but our supplied tools (lunacm, cmu, multitoken, etc.) are 64-bit versions only. This is because 64-bit tools are all that is needed on a 64-bit OS, but we mention it in case you were looking for 32-bit equivalents - there aren't any because none are needed.</p>
        <p>For compatibility of our HSMs with Windows CAPI we have Luna CSP, and for the newer Windows CNG we have Luna KSP. If you are using either, then a section near the end of this chapter has additional specific instructions. </p>
        <p> Interactive (prompted) and non-interactive (no prompts) installation options are available. </p>
        <h5>To install the Luna client software</h5>
        <p class="ol1" data-mc-autonum="1."><span class="autonumber"><span class="ol1Number">1.</span></span>Log into Windows 
 as “Administrator”, or as a user with administrator privileges (see Troubleshooting tips, below).</p>
        <p class="ol1" data-mc-autonum="2."><span class="autonumber"><span class="ol1Number">2.</span></span>Insert the Luna 
 Client Software DVD into your optical drive. </p>
        <p class="ol1" data-mc-autonum="3."><span class="autonumber"><span class="ol1Number">3.</span></span>Click <b>Start &gt; Run</b> and then type: </p>
        <p class="listLevel1"><b>d:\windows\64\Luna Client.msi</b>
        </p>
        <p class="listLevel1">where “d” is your CDROM drive </p>
        <p class="listLevel1">or &#160;use 
 Explorer to navigate the CD directories and double click the appropriate <b>Luna Client.msi</b>. </p>
        <p class="note" data-mc-autonum="&lt;b&gt;Note:&lt;/b&gt; &#160;"><span class="autonumber"><span><b>Note:</b> &#160;</span></span>The  installer is 64-bit only. If you have 32-bit applications, proceed with the 64-bit installation, then see <a href="#Using" class="MCXref xref "><span style="color: #6c286b;" class="mcFormatColor">"Using 32-bit Applications With the Luna Client      "</span></a>.</p>
        <p class="ol1" data-mc-autonum="4."><span class="autonumber"><span class="ol1Number">4.</span></span>At the Welcome screen, click <b>Next</b>. </p>
        <p class="listLevel1">
            <img src="../../Resources/Images/install/_01_lunaclient_install_welcome.png" /> </p>
        <p class="ol1" data-mc-autonum="5."><span class="autonumber"><span class="ol1Number">5.</span></span>Accept the software license agreement.</p>
        <p class="listLevel1">
            <img src="../../Resources/Images/install/_02_lunaclient_install_license.png" /> </p>
        <p class="ol1" data-mc-autonum="6."><span class="autonumber"><span class="ol1Number">6.</span></span>In the <b>Choose 
 Destination Location</b> dialog,  accept the default that is offered, or make 
 a change if you prefer.</p>
        <p class="listLevel1">
            <img src="../../Resources/Images/install/_03_lunaclient_accept_destination.png" /> </p>
        <p class="ol1" data-mc-autonum="7."><span class="autonumber"><span class="ol1Number">7.</span></span>Click to select any of the Luna Product software options that you wish to install. Any that are marked with a red "X" are currently de-selected and will not be installed when you proceed. You must accept at least the major feature for your HSM. You can select all, if you wish - there is   no conflict.  </p>
        <p class="listLevel1">The installer includes the Luna SNMP Subagent as an option with any of the Luna HSMs, except Luna&#160;SA (which has  agent and subagent built in). For any of Luna&#160;PCI-E, Luna&#160;G5, or Luna&#160;Backup HSMs, include the subagent with any of the products, if desired - it doesn't matter which; it's the same subagent, and it goes to the same location on your hard disk. </p>
        <p class="listLevel1">After installation is complete, you will need to move the SafeNet MIB files to the appropriate directory for your SNMP application, and you will need to start the SafeNet subagent and configure for use with your agent, as described in the <i>Administration Guide</i>.</p>
        <p class="listLevel1">
            <img src="../../Resources/Images/install/_04_lunaclient_install_choose_components_3.png" />
            <br />
        </p>
        <p class="ol1" data-mc-autonum="8."><span class="autonumber"><span class="ol1Number">8.</span></span>On the <b>Ready to Install</b>&#160;page click <b>Install</b>.</p>
        <p class="listLevel1">  If you wish to modify any of your previous selections, you can still click <b>Back</b> to see previous pages. Once you click <b>Install</b>, you are committed to the installation.</p>
        <p class="listLevel1">
            <img src="../../Resources/Images/install/_05_lunaclient_install_ready_to_install.png" />
            <br />
        </p>
        <p class="ol1" data-mc-autonum="9."><span class="autonumber"><span class="ol1Number">9.</span></span>If Windows presents a security notice asking if you wish to install the device driver from SafeNet, click <b>Install</b> to accept.</p>
        <p class="listLevel1">
            <img src="../../Resources/Images/install/_07_lunaclient_install_driver_security_query.png" />
            <br />
        </p>
        <p class="ol1" data-mc-autonum="10."><span class="autonumber"><span class="ol1Number">10.</span></span>If you choose not to install the driver, your Luna Client cannot function with any locally connected Luna hardware (which includes Luna&#160;PCI-E, Luna&#160;G5, or Luna&#160;[Remote]&#160;Backup HSMs). </p>
        <p class="ol1" data-mc-autonum="11."><span class="autonumber"><span class="ol1Number">11.</span></span>When the installation completes, click <b>Finish</b>. <br /><br /><img src="../../Resources/Images/install/_08_lunaclient_install_completed.png" /><br /><br /><br /></p>
        <p class="caution_note">As a general rule, do not modify the Chrystoki.conf/crystoki.ini 
 file, unless directed to do so by SafeNet Customer Support. <br />If you do modify the file, never insert TAB characters - use individual 
 space characters. <br />Avoid modifying the PED timeout settings. These are now hardcoded in the appliance, 
 but the numbers in the Chrystoki.conf file must match.</p>
        <h3>Using msiexec for scripted or unattended installation of the Luna Client </h3>
        <p>You can  use the <b>msiexec</b> command to install the Luna client from the command line, or from a script. The <b>msiexec</b> command includes various command line switches (see the Microsoft documentation for details) that allow you to install the Luna client with varying levels of user interaction, including a quiet mode (<b>/qn</b>) that requires no user interaction. </p>
        <p>However, since the Luna client includes a device driver, the following confirmation dialog is displayed when you install the Luna client using the <b>msiexec</b> command , regardless of the command line switches you use:</p>
        <p>
            <img src="../../Resources/Images/driver_install_confirm.png" />
        </p>
        <p>If you check the <b>Always trust software from "SafeNet, Inc."</b> checkbox, this dialog will not be displayed on subsequent installs, allowing for a truly "silent" install that requires no user interaction. That option was introduced with Windows 2008. </p>
        <p>For more detailed information, see <a href="scripted_unattended_install.htm" class="MCXref xref "><span style="color: #6c286b;" class="mcFormatColor">"Scripted / Unattended Installation on Windows"</span></a>.</p>
        <h3>Java&#160;</h3>
        <p>During the installation, if you allow our Java Security Provider to be installed, the Luna Java files are installed below <b>C:\Program Files\Luna Client\JSP\lib</b>. In order to use our JSP, you must have separately installed Java (JDK&#160;or run-time environment from the vendor of your choice) onto your system. </p>
        <p>Copy the Luna Java files from their default location under <b>C:\Program Files\SafeNet\Luna Client\JSP\lib</b> to the Java environment directory, for example <b>C:\Program Files\Java\jre6\lib\ext</b>.</p>
        <p class="note" data-mc-autonum="&lt;b&gt;Note:&lt;/b&gt; &#160;"><span class="autonumber"><span><b>Note:</b> &#160;</span></span>The exact directory might differ depending on where you obtained your Java system, the version, and any choices that you made while installing and configuring it.</p>
        <h4>Java 7 Library Path Issue</h4>
        <p>SafeNet has traditionally recommended that you put <b>LunaAPI.dll</b> in the &lt;java install dir&gt;<b>/lib/ext</b> folder.</p>
        <p>However, Java 7 for Windows has removed this directory from the Java library path. As a result, when a Java 7 application on Windows uses the Luna provider, it cannot find the <b>LunaAPI.dll</b> library, causing the application to fail.</p>
        <p>To address this problem, we suggest that you use one of the following methods to add <b>LunaAPI.dll</b> to the Java 7 search path:</p>
        <p class="ul1" data-mc-autonum="&lt;b&gt;•&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>•</b></span></span>Put <b>LunaAPI.dll</b> in an arbitrary folder and add that folder to the system path. Java 7 will search the system path for <b>LunaAPI.dll</b>. &#160;&#160;&#160;<br /></p>
        <p class="ul1" data-mc-autonum="&lt;b&gt;•&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>•</b></span></span>Put LunaAPI.dll in the Windows system folder. This folder varies by operating system and DLL type, as follows: &#160;</p>
        <p class="ul2" data-mc-autonum="&lt;b&gt;–&lt;/b&gt;"><span class="autonumber"><span class="ul2Bullet"><b>–</b></span></span>&#160;- 32-bit Windows, 32-bit LunaAPI.dll: C:\Windows\System32</p>
        <p class="ul2" data-mc-autonum="&lt;b&gt;–&lt;/b&gt;"><span class="autonumber"><span class="ul2Bullet"><b>–</b></span></span> &#160;&#160;- 64-bit Windows, 64-bit LunaAPI.dll: C:\Windows\System32</p>
        <p class="ul2" data-mc-autonum="&lt;b&gt;–&lt;/b&gt;"><span class="autonumber"><span class="ul2Bullet"><b>–</b></span></span> &#160;&#160;- 64-bit Windows, 32-bit LunaAPI.dll: C:\Windows\SysWOW64 &#160;&#160;</p>
        <p>For additional Java-related information,see <a href="../../sdk/java/java.htm" class="MCXref xref "><span style="color: #6c286b;" class="mcFormatColor">"Java Interfaces"</span></a> in the <i>SDK Reference Guide</i>.&#160;</p>
        <h4>JSP Static Registration</h4>
        <p>You would choose static registration of providers if you want all applications to default to our (SafeNet) provider.</p>
        <p>Once your client has externally logged in using <span class="code">salogin</span> (see   ) in the Reference section of this document) or your own HSM-aware utility, any application would be able to use Luna product without being designed to login to the HSM Partition.</p>
        <p>Edit the java.security file located in the \jre\lib\security directory of your Java SDK/JRE 1.6.x or 1.7.x installation to read as follows:</p>
        <p class="code">security.provider.1=sun.security.provider.Sun</p>
        <p class="code">security.provider.2=com.sun.net.ssl.internal.ssl.Provider</p>
        <p class="code"><span style="color: #f59149;">security.provider.3=com.safenetinc.luna.provider.LunaProvider</span>
        </p>
        <p class="code">security.provider.4=com.sun.rsajca.Provider</p>
        <p class="code">security.provider.5=com.sun.crypto.provider.SunJCE</p>
        <p class="code">security.provider.6=sun.security.jgss.SunProvider</p>
        <p>You can set our provider in first position for  efficiency if Luna HSM operations are your primary mode. However, if your application needs to perform operations not supported by the LunaProvider (secure random generation or random publickey verification, for example) then it would receive error messages from the HSM and would need to handle those gracefully before resorting to providers further down the list. We have found that having our provider in third position works well for most applications.</p>
        <p>The modifications in the "java.security" file are global, and they might result in the breaking of another application that uses the default KeyPairGenerator without logging into the Luna SA first. This consideration might argue for using dynamic registration, instead.</p>
        <h4>JSP Dynamic Registration</h4>
        <p>For your situation, you may prefer to employ dynamic registration of Providers, in order to avoid possible negative impacts on other applications running on the same machine. As well, the use of dynamic registration allows you to keep installation as straightforward as possible for your customers.</p>
        <h4>Compatibility</h4>
        <p>We formally test Luna HSMs and our Java provider with SUN JDK for all platforms except AIX, and with IBM JDK for the AIX platform. We have not had problems with OpenJDK, although it has not been part of our formal test suite. The Luna JCE provider is compliant with the JCE specification, and should work with any JVM that implements the Java language specification.</p>
        <p>Occasional problems have been encountered with respect to IBM JSSE.</p>
        <p>GNU JDK shipped with most Linux systems has historically been incomplete and not suitable.</p>
        <p>&#160;</p>
        <h3>CSP and KSP</h3>
        <p>Luna CSP allows you to use the Luna HSM with Microsoft CAPI, which is supported on 32-bit and on 64-bit Windows.</p>
        <p>Luna KSP allows you to use the Luna HSM with Microsoft CNG, which is newer, has additional functions, and supersedes CAPI. </p>
        <p>Both of these require modifications to the Windows Registry.</p>
        <h4>Luna CSP</h4>
        <p>For Luna CSP, the utility <b>register.exe</b> takes care of the registry.</p>
        <p>Just remember to run the 64-bit version, the 32-bit version, or both, depending on the applications you are running.</p>
        <p class="ul1" data-mc-autonum="&lt;b&gt;•&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>•</b></span></span>Register the csp dll: &#160;&#160;<br /># register.exe /library &#160;&#160;</p>
        <p class="ul1" data-mc-autonum="&lt;b&gt;•&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>•</b></span></span>Register the partition: &#160;&#160;<br /># register &lt;no arguments&gt;</p>
        <h4>Luna KSP</h4>
        <p>For Luna KSP, the utility <b>KspConfig.exe</b> takes care of the registry. Follow instructions for the use of the graphical KspConfig.exe as described in <a href="../../sdk/microsoft/ksp_cng.htm" class="MCXref xref "><span style="color: #6c286b;" class="mcFormatColor">"KSP for CNG"</span></a> in the <i>SDK Reference Guide</i>. Just remember to run the 64-bit version, the 32-bit version, or both, depending on the applications you are running.</p>
        <p class="note" data-mc-autonum="&lt;b&gt;Note:&lt;/b&gt; &#160;"><span class="autonumber"><span><b>Note:</b> &#160;</span></span>The <b>cryptoki.ini</b> file, which specifies many configuration settings for your HSM and related software, includes a line that specifies the path to the appropriate libNT for use with your application(s). Verify that the path is correct </p>
        <p class="note" data-mc-autonum="&lt;b&gt;Note:&lt;/b&gt; &#160;"><span class="autonumber"><span><b>Note:</b> &#160;</span></span>If Luna CSP (CAPI) / Luna KSP(CNG) is selected at installation time then the <b>SafeNetKSP.dll</b> file is installed in these two locations: &#160;<br />&#160;- <b>C:\Windows\System32</b> (used for 64-bit KSP) &#160;&#160;&#160;&#160;<br /> - <b>C:\Windows\SysWOW64</b> (used for 32-bit KSP)</p>
        <h3><a name="Using"></a>Using 32-bit Applications With the Luna Client      </h3>
        <p>Luna Client 32-bit libraries (<b>cryptoki.dll</b>, <b>cklog.dll</b>, etc.) and versions of CSP and KSP libraries and tools are installed in the <b>C:\Program Files\SafeNet\Luna Client\win32</b> directory. <br /></p>
        <p>The <b>win32</b> directory content is as follows:</p>
        <p class="ul1" data-mc-autonum="&lt;b&gt;•&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>•</b></span></span>cklog201.dll</p>
        <p class="ul1" data-mc-autonum="&lt;b&gt;•&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>•</b></span></span>cklog201.dll.sig</p>
        <p class="ul1" data-mc-autonum="&lt;b&gt;•&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>•</b></span></span>cryptoki.dll</p>
        <p class="ul1" data-mc-autonum="&lt;b&gt;•&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>•</b></span></span>cryptoki.dll.sig</p>
        <p class="ul1" data-mc-autonum="&lt;b&gt;•&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>•</b></span></span>shim.dll</p>
        <p class="ul1" data-mc-autonum="&lt;b&gt;•&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>•</b></span></span>shim.dll.sig</p>
        <p class="ul1" data-mc-autonum="&lt;b&gt;•&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>•</b></span></span><b>jsp</b> directory which contains:</p>
        <p class="ul2" data-mc-autonum="&lt;b&gt;–&lt;/b&gt;"><span class="autonumber"><span class="ul2Bullet"><b>–</b></span></span>LunaAPI.dll</p>
        <p>If the Luna CSP (CAPI) / Luna KSP(CNG) feature is installed, the following are also installed under <b>win32</b>:</p>
        <p class="ul1" data-mc-autonum="&lt;b&gt;•&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>•</b></span></span>csp directory which contains:</p>
        <p class="ul2" data-mc-autonum="&lt;b&gt;–&lt;/b&gt;"><span class="autonumber"><span class="ul2Bullet"><b>–</b></span></span>keymap</p>
        <p class="ul2" data-mc-autonum="&lt;b&gt;–&lt;/b&gt;"><span class="autonumber"><span class="ul2Bullet"><b>–</b></span></span> LunaCSP.dll</p>
        <p class="ul2" data-mc-autonum="&lt;b&gt;–&lt;/b&gt;"><span class="autonumber"><span class="ul2Bullet"><b>–</b></span></span>LunaCSP.sig</p>
        <p class="ul2" data-mc-autonum="&lt;b&gt;–&lt;/b&gt;"><span class="autonumber"><span class="ul2Bullet"><b>–</b></span></span>ms2Luna</p>
        <p class="ul2" data-mc-autonum="&lt;b&gt;–&lt;/b&gt;"><span class="autonumber"><span class="ul2Bullet"><b>–</b></span></span>register</p>
        <p class="ul1" data-mc-autonum="&lt;b&gt;•&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>•</b></span></span>KSP directory that contains:</p>
        <p class="ul2" data-mc-autonum="&lt;b&gt;–&lt;/b&gt;"><span class="autonumber"><span class="ul2Bullet"><b>–</b></span></span>kspcmd</p>
        <p class="ul2" data-mc-autonum="&lt;b&gt;–&lt;/b&gt;"><span class="autonumber"><span class="ul2Bullet"><b>–</b></span></span>KspConfig</p>
        <p class="ul2" data-mc-autonum="&lt;b&gt;–&lt;/b&gt;"><span class="autonumber"><span class="ul2Bullet"><b>–</b></span></span>ksputil</p>
        <p class="ul2" data-mc-autonum="&lt;b&gt;–&lt;/b&gt;"><span class="autonumber"><span class="ul2Bullet"><b>–</b></span></span>ms2Luna</p>
        <p>In order to properly use the 32-bit library and tools on 64-bit systems there are two basic approaches: &#160;&#160;</p>
        <h4>Direct loading of library &#160;&#160;</h4>
        <p>Set your application to load the 32-bit library installed under the win32 directory, and run your application. For an example on how to load the cryptoki library dynamically, please refer to the Luna SDK. </p>
        <p>This should work for any application that directly points to the needed library, and represents the majority of customer applications.</p>
        <h4>Loading the library via the configuration file &#160;&#160;&#160;</h4>
        <p>If you require your 32-bit Windows application to run on 64-bit Windows and your application uses the crystoki.ini to find the location of the cryptoki library (such as applications that use ckbridge - no longer distributed - or that use CSP), we recommend creating a new copy of the crystoki.ini file under the win32 directory to point to the 32-bit cryptoki library as described below: 

</p>
        <p class="ul1" data-mc-autonum="&lt;b&gt;•&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>•</b></span></span>Install Luna Client and configure the HSM or SA client as you would normally do. &#160;&#160;</p>
        <p class="ul1" data-mc-autonum="&lt;b&gt;•&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>•</b></span></span>
Create a copy of the crystoki.ini file and store it in the win32 directory.
 &#160;&#160;</p>
        <p class="ul1" data-mc-autonum="&lt;b&gt;•&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>•</b></span></span>Modify the LibNT entry in the file (the copy in the win32 directory) to point to the cryptoki.dll library located in the win32 directory
<br />LibNT=C:\Program Files\SafeNet\Luna Client\win32\cryptoki.dll
 &#160;&#160;</p>
        <p class="ul1" data-mc-autonum="&lt;b&gt;•&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>•</b></span></span>Open a new DOS prompt (to be used to run your application). &#160;&#160;</p>
        <p class="ul1" data-mc-autonum="&lt;b&gt;•&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>•</b></span></span>Set the ChrystokiConfigurationPath environment variable to point to the win32 directory
set <br />ChrystokiConfigurationPath= C:\Program Files\SafeNet\Luna Client\win32\
 &#160;&#160;</p>
        <p class="ul1" data-mc-autonum="&lt;b&gt;•&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>•</b></span></span>Run your application.</p>
        <p>&#160;</p>
        <h3>Uninstalling, Modifying, or Repairing the Luna Client Software</h3>
        <p>At any time, you might need to uninstall Luna Client, or to modify the installation (perhaps to add a component or product that you did not previously install), or to repair the installed software. </p>
        <h5>To uninstall, modify, or repair the Luna client software</h5>
        <p class="ol1Start" data-mc-autonum="1."><span class="autonumber"><span class="ol1Number">1.</span></span>Run the <b>Luna Client.msi</b> program again. Because the software is already installed on your computer, after you click through the Welcome page, this dialog is displayed:</p>
        <p class="listLevel1">
            <img src="../../Resources/Images/luna_client_software_uninstall_repair_modify.png" />
        </p>
        <p class="ol1" data-mc-autonum="2."><span class="autonumber"><span class="ol1Number">2.</span></span>Choose the desired option, click <b>Next</b>, and follow the prompts. It is possible that you might see a message like this:</p>
        <p class="listLevel1">
            <img src="../../Resources/Images/uninstall_message_possible.png" />
        </p>
        <p class="listLevel1">Ignore that message if you see it while uninstalling Luna Client. You do not need to restart your computer, and you will not be prompted to do so. </p>
        <h3>After Installation</h3>
        <p class="NumberedList">When you have installed the software onto a Client, 
 the next task is to configure the   Luna HSM, as described in the <i>Configuration Guide</i>. </p>
        <p class="NumberedList">Open a new command-line/console window to allow the library path to be found before you run lunacm or other utilities that require the library. </p>
        <h3> Troubleshooting</h3>
        <p>If you are not the Administrator of the computer on which LunaClient is being installed, or if the bundle of permissions in your user profile does not allow you to launch the installer with "Run as Administrator", then some services might not install properly. One option is to have the Administrator perform the installation for you.</p>
        <p>
            <img src="../../Resources/Images/install/_0-0_can_run_msi_elevated_not_Admin.png" />
        </p>
        <p>Another approach might be possible. If you have sufficient elevated permissions, you might be able to right-click and open a Command Prompt window as Administrator. </p>
        <p>&#160;</p>
        <p>
            <img src="../../Resources/Images/install/run_command-prompt_as_administrator.png" />
        </p>
        <p>&#160;</p>
        <p>If that option is available, then you can use the command line to move to the location of the LunaClient.msi file and launch it there, which permits the needed services to load for HTL, PedClient, and other Luna features. </p>
        <p>
            <img src="../../Resources/Images/install/_00_launch_msi_as_administrator.png" />
        </p>
        <p>&#160;</p>
        <p>&#160;</p>
        <p>&#160;</p>
        <p class="footer"><span class="DefaultProduct">Luna SA</span> <span class="DefaultRelease">5.4.1</span> <span class="DefaultProjectTitle">Product Documentation</span> <br /><span class="DefaultPartNumber">007-011136-007</span> <span class="DefaultRevision">Rev C</span> <span style="color: #5e5e5c;"> </span> <span class="DefaultDateShort">July 2014</span> <span style="color: #5e5e5c;"> </span> <span class="DefaultCopyright">Copyright 2014</span>&#160;<span class="DefaultCompanyNameLong">SafeNet, Inc.</span> <span style="color: #5e5e5c;"> </span>All rights reserved. </p>
        <p class="MCWebHelpFramesetLink MCWebHelpFramesetLinkBottom"><a href="../../../index.html#install/software/windows_install.htm">Open topic with navigation</a>
        </p>
    </body>
</html>