<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" data-mc-search-type="Stem" data-mc-help-system-file-name="index.xml" data-mc-path-to-help-system="../../../" data-mc-conditions="Primary.Default" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-medium="non-print" data-mc-toc-path="HSM Administration Guide|Removing/Destroying Content for Safe Disposal">
    <head>
        <meta charset="utf-8" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>Comparison of Destruction/Denial Actions</title>
        <link href="../../Resources/TableStyles/Page.css" rel="stylesheet" />
        <link href="../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" />
        <link href="../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" />
        <link href="../../Resources/TableStyles/Breadcrumbs.css" rel="stylesheet" />
        <link href="../../Resources/Stylesheets/SafeNet_Template.css" rel="stylesheet" />
        <script src="../../../Resources/Scripts/jquery.min.js">
        </script>
        <script src="../../../Resources/Scripts/plugins.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.config.js">
        </script>
        <script src="../../../Resources/Scripts/MadCapAll.js">
        </script>
    </head>
    <body>
        <p class="MCWebHelpFramesetLink MCWebHelpFramesetLinkTop"><a href="../../../index.html#administration/decommission/destroy_scenarios.htm">Open topic with navigation</a>
        </p>
        <table style="width: 100%;border-spacing: 0px 0px;mc-table-style: url('../../Resources/TableStyles/Breadcrumbs.css');border-left-style: none;border-left-width: 1px;border-left-color: #000000;border-right-style: none;border-right-width: 1px;border-right-color: #000000;border-top-style: none;border-top-width: 0px;border-top-color: #000000;border-bottom-style: solid;border-bottom-width: 2px;border-bottom-color: #e6e6e6;" class="TableStyle-Breadcrumbs" cellspacing="0">
            <col style="width: 41px;" class="TableStyle-Breadcrumbs-Column-Column1" />
            <col class="TableStyle-Breadcrumbs-Column-Column1" />
            <tbody>
                <tr class="TableStyle-Breadcrumbs-Body-Body1">
                    <th class="TableStyle-Breadcrumbs-BodyB-Column1-Body1">
                        <p class="home" style="font-weight: normal;"><a href="../../Home_sa.htm">Home</a> &gt;
                        </p>
                    </th>
                    <th class="TableStyle-Breadcrumbs-BodyA-Column1-Body1">
                        <div class="MCBreadcrumbsBox_0"><span class="MCBreadcrumbsPrefix">  <![CDATA[ ]]></span><span class="MCBreadcrumbsSelf">HSM Administration Guide</span><span class="MCBreadcrumbsDivider"> &gt; </span><a class="MCBreadcrumbsLink" href="declassify_decommission.htm">Removing/Destroying Content for Safe Disposal</a><span class="MCBreadcrumbsDivider"> &gt; </span><span class="MCBreadcrumbs">Comparison of Destruction/Denial Actions</span>
                        </div>
                    </th>
                </tr>
            </tbody>
        </table>
        <h2>Comparison of Destruction/Denial Actions</h2>
        <p>Various operations on the Luna SA appliance and its contained HSM are intended to make HSM contents unavailable to potential intruders. The effect of those actions are summarized and contrasted in the following table, along with notes on how to recognize and how to recover from each scenario.</p>
        <table style="mc-table-style: url('../../Resources/TableStyles/Page.css');border-top-style: solid;border-top-width: 1px;border-top-color: #000000;border-bottom-style: solid;border-bottom-width: 1px;border-bottom-color: #000000;margin-left: 0;margin-right: auto;caption-side: top;width: 100%;" class="TableStyle-Page" cellspacing="0">
            <col class="Column-Column1" style="width: 162px;" />
            <col class="Column-Column1" style="width: 141px;" />
            <col class="Column-Column1" style="width: 140px;" />
            <col class="Column-Column1" style="width: 115px;" />
            <col class="Column-Column1" style="width: 169px;" />
            <col class="Column-Column1" />
            <thead>
                <tr class="Head-Header1">
                    <th class="HeadE-Column1-Header1">Event</th>
                    <th class="HeadE-Column1-Header1">
                        <p>MTK is destroyed <br />HSM is unavailable, <br />but use/access <br />can be recovered <br />after reboot <br /><span style="font-weight: normal;">(See Note 1)</span> <![CDATA[ ]]></p>
                    </th>
                    <th class="HeadE-Column1-Header1">
                        <p>KEK is destroyed <br />(Real-Time Clock <br />and NVRAM)</p>
                        <p>HSM&#160;contents <br />cannot be recovered<br />without backup  <br /><span style="font-weight: normal;">(See Note 2)</span> <![CDATA[ ]]></p>
                    </th>
                    <th class="HeadE-Column1-Header1">Reset appliance <br />admin password&#160;&#160;</th>
                    <th class="HeadE-Column1-Header1">How to discover <br /><span style="font-weight: normal;">(See Note 3)</span> <![CDATA[ ]]></th>
                    <th class="HeadD-Column1-Header1">How to recover</th>
                </tr>
            </thead>
            <tbody>
                <tr class="Body-Body1">
                    <td class="BodyE-Column1-Body1">
                        <p>- three bad SO login attempts <br />&#160;or</p>
                        <p>&#160;- lunash:&gt; hsm factoryReset<br /> or <br /> - any change to a destructive policy <br /> or <br /> - firmware rollback<br />(See Note 4) &#160;<br /></p>
                    </td>
                    <td class="BodyE-Column1-Body1">NO</td>
                    <td class="BodyE-Column1-Body1">YES</td>
                    <td class="BodyE-Column1-Body1">NO</td>
                    <td class="BodyE-Column1-Body1">
                        <p>hsm.log entry</p>
                        <p>or<br />"Zeroized: &#160;&#160;Yes" in HSM Information (from hsm show command)</p>
                    </td>
                    <td class="BodyD-Column1-Body1">Restore HSM objects from Backup &#160;</td>
                </tr>
                <tr class="Body-Body1">
                    <td class="BodyE-Column1-Body1">
                        <p>&#160;login to Luna&#160;SA "recover" account <br />&#160;(local serial connection)</p>
                    </td>
                    <td class="BodyE-Column1-Body1">NO</td>
                    <td class="BodyE-Column1-Body1">NO</td>
                    <td class="BodyE-Column1-Body1">YES</td>
                    <td class="BodyE-Column1-Body1">Syslog entry shows login by "recover"</td>
                    <td class="BodyD-Column1-Body1">Log into appliance as admin, using the reset password "PASSWORD" and change to a secure password</td>
                </tr>
                <tr class="Body-Body1">
                    <td class="BodyE-Column1-Body1">
                        <p> hardware tamper <br />- under-voltage/overvoltage<br /> &#160;or<br /> &#160;- under-temperature/over-temperature &#160;<br />&#160;&#160;&#160;&#160;during operation<br /> &#160;or <br /> &#160;- chassis interference such as cover, fans, etc.) <br /><br />OR <br /><br />software (command-initiated) tamper<br /> <br />&#160; lunash:&gt; hsm srk transportMode enter<br /> or <br /> lunacm:&gt; srk transport <br /><br /><br /></p>
                    </td>
                    <td class="BodyE-Column1-Body1">YES</td>
                    <td class="BodyE-Column1-Body1">NO</td>
                    <td class="BodyE-Column1-Body1">NO</td>
                    <td class="BodyE-Column1-Body1">
                        <p>Best practice - have external MTK split on SRK (purple PED Key), which forces administrative intervention to recover from tamper.<br />Otherwise, parse hsm.log for text like "tamper", "TVK was corrupted", or "Generating new TVK", indicating that a tamper event was logged. Example: <br /><code>RTC: external tamper latched/MTK: security function was zeroized on previous tamper event and has not been restored yet</code> <br />... also, keywords in hsm.log like:<br />"HSM internal error", "device error"
</p>
                        <p>Luna SA appliance front panel flashes error 30.</p>
                    </td>
                    <td class="BodyD-Column1-Body1">Reboot <br />[See Note 1]</td>
                </tr>
                <tr class="Body-Body1">
                    <td class="BodyE-Column1-Body1">
                        <p>decommission &#160;&#160;</p>
                        <p>(shorting-circuiting the tamper2 header pins on Luna PCI-E, or pressing the Decommission button on the back of the Luna SA appliance, which shorts tamper2)<br /></p>
                    </td>
                    <td class="BodyE-Column1-Body1">NO</td>
                    <td class="BodyE-Column1-Body1">YES</td>
                    <td class="BodyE-Column1-Body1">NO</td>
                    <td class="BodyE-Column1-Body1">Look for log entry like:<br />RTC: tamper 2 signal/Zeroizing HSM after decommission...LOG(INFO): POWER-UP LOG DUMP END
</td>
                    <td class="BodyD-Column1-Body1">Restore HSM objects from Backup &#160;</td>
                </tr>
                <tr class="Body-Body1">
                    <td class="BodyB-Column1-Body1" colspan="5">
                        <br /><b>Note 1a:</b> MTK is an independent layer of encryption on HSM contents, to manage tamper and Secure Transport Mode. A destroyed MTK is recovered on next reboot if no external split (SRK) of the recovery vector exists (that is, if both portions of the recovery key are available inside the HSM.<br />A destroyed MTK can be recovered if one of the recovery components has been moved outside the HSM onto a secure recovery key (SRK), and that SRK can be presented via Luna PED at the next HSM reboot.<br />If MTK&#160;cannot be recovered, only restoring from backup onto a new or re-manufactured HSM can retrieve your keys and HSM data. &#160;&#160;<br /><br /><b>Note 1b:</b> If an external SRV exists, and you wish to stop using it (having no need for Secure Transport Mode, and no need for enforced administrative response in case of a tamper event), you must bring the external SRV back into the HSM with srk disable command; you may not simply destroy or overwrite the purple PED Key without first ensuring that the HSM is in possession of all the MTK recovery components. <br /><br /><b>Note 2:</b> KEK is an HSM-wide encryption layer that encrypts all HSM objects, excluding only MTK, RPK, a wrapping key, and a couple of keys used for legacy support. A destroyed KEK cannot be recovered. If the KEK is destroyed, only restoring from backup can retrieve your keys and HSM data. <br /><br /><b>Note 3:</b> To check the health of a remote HSM, script a frequent login to the HSM host and execution of a subset of HSM commands. If a command fails, check the logs for an indication of the cause. &#160;<br /><br /><b>Note 4:</b> These actions all create a situation where "hsm init" is required, or strongly recommended before the HSM is used again. <br /><br /></td>
                    <td class="BodyA-Column1-Body1">&#160;</td>
                </tr>
            </tbody>
        </table>
        <p>&#160;</p>
        <p>In addition, another event/action that has a destructive component is HSM initialization, which can be of either the "soft" or "hard" variety. </p>
        <p class="ul1" data-mc-autonum="&lt;b&gt;•&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>•</b></span></span>HSM init is soft if you have not performed an <span class="code">hsm factoryReset</span> before <span class="code">hsm init</span>. </p>
        <p class="ul1" data-mc-autonum="&lt;b&gt;•&lt;/b&gt;"><span class="autonumber"><span class="ul1Bullet"><b>•</b></span></span>HSM init is hard if it is performed following <span class="code">hsm factoryReset</span>. </p>
        <p>Either way, HSM and partition objects are gone, so only a restore from backup can bring them back. Effects of soft versus hard initializations are summarized below  :</p>
        <table class="TableStyle-Page" style="caption-side: top;width: 100%;mc-table-style: url('../../Resources/TableStyles/Page.css');" cellspacing="0">
            <col class="Column-Column1">
            </col>
            <col class="Column-Column1">
            </col>
            <col class="Column-Column1">
            </col>
            <thead>
                <tr class="Head-Header1">
                    <th class="HeadE-Column1-Header1">Condition/Effect</th>
                    <th class="HeadE-Column1-Header1">
                        <p>Soft init</p>
                    </th>
                    <th class="HeadD-Column1-Header1">
                        <p>Hard init&#160;</p>
                    </th>
                </tr>
            </thead>
            <tbody>
                <tr class="Body-Body1">
                    <td class="BodyE-Column1-Body1">&#160;SO authentication required?&#160;</td>
                    <td class="BodyE-Column1-Body1">&#160;Yes</td>
                    <td class="BodyD-Column1-Body1">&#160;No</td>
                </tr>
                <tr class="Body-Body1">
                    <td class="BodyE-Column1-Body1">&#160;Can set new HSM label&#160;</td>
                    <td class="BodyE-Column1-Body1">&#160;Yes</td>
                    <td class="BodyD-Column1-Body1">&#160;Yes</td>
                </tr>
                <tr class="Body-Body1">
                    <td class="BodyE-Column1-Body1">&#160;Creates new SO identity&#160;</td>
                    <td class="BodyE-Column1-Body1">&#160;No</td>
                    <td class="BodyD-Column1-Body1">&#160;Yes</td>
                </tr>
                <tr class="Body-Body1">
                    <td class="BodyE-Column1-Body1">&#160;Creates new Domain&#160;</td>
                    <td class="BodyE-Column1-Body1">&#160;No</td>
                    <td class="BodyD-Column1-Body1">&#160;Yes</td>
                </tr>
                <tr class="Body-Body1">
                    <td class="BodyE-Column1-Body1">&#160;Destroys partitions&#160;</td>
                    <td class="BodyE-Column1-Body1">&#160;Yes</td>
                    <td class="BodyD-Column1-Body1">&#160;No (none exist to destroy)&#160;*</td>
                </tr>
                <tr class="Body-Body1">
                    <td class="BodyB-Column1-Body1">&#160;Destroys SO objects&#160;</td>
                    <td class="BodyB-Column1-Body1">&#160;Yes</td>
                    <td class="BodyA-Column1-Body1">&#160;No (none exist to destroy)&#160;* </td>
                </tr>
            </tbody>
        </table>
        <p>* hsm factoryReset was performed, and destroyed partitions and objects, before the hard init... otherwise, it could not be a hard init.</p>
        <p class="footer"><span class="DefaultProduct">Luna SA</span> <span class="DefaultRelease">5.4.1</span> <span class="DefaultProjectTitle">Product Documentation</span> <br /><span class="DefaultPartNumber">007-011136-007</span> <span class="DefaultRevision">Rev C</span> <span style="color: #5e5e5c;"> </span> <span class="DefaultDateShort">July 2014</span> <span style="color: #5e5e5c;"> </span> <span class="DefaultCopyright">Copyright 2014</span>&#160;<span class="DefaultCompanyNameLong">SafeNet, Inc.</span> <span style="color: #5e5e5c;"> </span>All rights reserved. </p>
        <p class="MCWebHelpFramesetLink MCWebHelpFramesetLinkBottom"><a href="../../../index.html#administration/decommission/destroy_scenarios.htm">Open topic with navigation</a>
        </p>
    </body>
</html>